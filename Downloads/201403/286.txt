From users-return-135924-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Tue Mar 25 02:14:35 2014
Return-Path: <users-return-135924-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B9B5710487
	for <apmail-maven-users-archive@www.apache.org>; Tue, 25 Mar 2014 02:14:35 +0000 (UTC)
Received: (qmail 9412 invoked by uid 500); 25 Mar 2014 02:14:30 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 9323 invoked by uid 500); 25 Mar 2014 02:14:30 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 9310 invoked by uid 99); 25 Mar 2014 02:14:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Mar 2014 02:14:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [194.158.98.15] (HELO mail-2y.bbox.fr) (194.158.98.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Mar 2014 02:14:22 +0000
Received: from herve-desktop.localnet (static-176-182-124-247.ncc.abo.bbox.fr [176.182.124.247])
	by mail-2y.bbox.fr (Postfix) with ESMTP id 44F5938
	for <users@maven.apache.org>; Tue, 25 Mar 2014 03:14:01 +0100 (CET)
From: =?ISO-8859-1?Q?Herv=E9?= BOUTEMY <herve.boutemy@free.fr>
To: Maven Users List <users@maven.apache.org>
Subject: Re: maven-dependency-tree reactor resolution
Date: Tue, 25 Mar 2014 03:14:01 +0100
Message-ID: <2427223.9d1ACrsZBS@herve-desktop>
User-Agent: KMail/4.11.5 (Linux/3.11.0-18-generic; KDE/4.11.5; x86_64; ; )
In-Reply-To: <CAEBcyzqf0cyJJA6Mb-0SsdmUEXP=8hBgHO7UE_eiKq0VtZ1pXw@mail.gmail.com>
References: <CAEBcyzqJae+F0zRek1ug9xkyQEOu0k+OcYwTK2UPRbSWyv6hhw@mail.gmail.com> <2028163.7tSRtl3ju6@herve-desktop> <CAEBcyzqf0cyJJA6Mb-0SsdmUEXP=8hBgHO7UE_eiKq0VtZ1pXw@mail.gmail.com>
MIME-Version: 1.0
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset="iso-8859-1"
X-Virus-Checked: Checked by ClamAV on apache.org

you hit the problem I faced when doing magic for multi-Maven versions=20=

compatibility: I didn't figure out how to have tests inside the compone=
nt=20
itself
or it would need ITs (through m-invoker-p), but requires to write a plu=
gin=20
that uses the API then a pom that uses the plugin: too much

the way I did it is to use either ITs in maven-dependency-plugin to tes=
t=20
modifications in maven-dependency-tree

in fact, now that latest maven-dependency-plugin release uses latest ma=
ven-
dependency-tree API, it could probably be used inside an IT in maven-
dependency-tree: that would ease a lot maven-dependency-tree modificati=
ons (it=20
was really a headache last time, checking for every Maven version...)

tell me if you need more help

Regards,

Herv=E9

Le mardi 25 mars 2014 09:53:24 William Ferguson a =E9crit :
> Herve,
>=20
> I'm looking at trying to add this functionality to maven-dependency-t=
ree
> but I want to start with a unit test showing the failure. But there d=
oesn't
> seem to be any unit tests for the DependencyGraphBuilder (for any
> environment).
>=20
> What's the best way to create a unit test that sets up the environmen=
t so
> that I can explicitly test the Maven3DependencyGraphBuilder and
> Maven31DependencyGraphBuilder?
>=20
> William
>=20
> On Thu, Mar 20, 2014 at 5:36 PM, Herv=E9 BOUTEMY <herve.boutemy@free.=
fr>wrote:
> > I don't really know: that's a precise feature that I didn't sudy
> > dependency-tree is used in Maven plugins in contexts where componen=
ts are
> > already installed: so there is not much difference between reactor
> > resolution
> > and local repository resolution
> >=20
> > you're probably right: if reactor resolution is not done, it should=
 be
> > added,
> > since that can be something generally expected from the component
> >=20
> > Regards,
> >=20
> > Herv=E9
> >=20
> > Le jeudi 20 mars 2014 17:30:38 William Ferguson a =E9crit :
> > > Herve,
> > >=20
> > > I didn't think I was asking for any extra flexibility out of
> > > dependency-tree that it didn't already give. Are you saying that =
it
> >=20
> > doesn't
> >=20
> > > support resolution of projects in the current reactor?
> > >=20
> > > William
> > >=20
> > > On Thu, Mar 20, 2014 at 5:16 PM, Herv=E9 BOUTEMY <herve.boutemy@f=
ree.fr
> > >
> > >wrote:
> > > > maven-dependency-tree offers a really simple API: that's its
> > > > objective.
> > > > The drawback is that it is not very flexible
> > > > The value is that it hides Maven 2, Maven 3.0.x and Maven 3.1.x=
+
> > > > implementations, which are completely different (initial Maven =
2 is
> >=20
> > made
> >=20
> > > > of
> > > > listeners, Maven 3 uses Aether and Maven provider, with package=

> > > > changes
> > > > from
> > > > Maven 3.0 and 3.1)
> > > >=20
> > > > If you need more features, I think you'd better use Aether with=
 Maven
> > > > Provider: you can look both at maven-dependency-tree source to =
start
> >=20
> > and
> >=20
> > > > Aether examples to better understand Aether API, which is a lot=
 more
> > > > flexible<-
> > > >=20
> > > > >rich<->complex
> > > >=20
> > > > Notice that your initial code will use latest Aether, then your=
 plugin
> > > > will
> > > > require Maven 3.1.x minimum. If you want compatibility with Mav=
en
> > > > 3.0.x
> > > > and
> > > > 3.1.x+, you'll have to add some reflection magic which might ad=
d
> > > > complexity (it
> > > > was not so easy to do it in maven-dependency-tree)
> > > > If you want Maven 2 compatibility, I would personnally not real=
ly
> >=20
> > think it
> >=20
> > > > is
> > > > reasonably feasible
> > > >=20
> > > > Regards,
> > > >=20
> > > > Herv=E9
> > > >=20
> > > > Le jeudi 20 mars 2014 09:55:31 William Ferguson a =E9crit :
> > > > > Hi,
> > > > >=20
> > > > > I have a plugin that uses the maven-dependency-tree component=
 to
> >=20
> > resolve
> >=20
> > > > > project dependencies in a LifeCycleParticipant. (We need earl=
y
> >=20
> > access to
> >=20
> > > > > deps because we need to modify the compile classpath).
> > > > >=20
> > > > > But I'm finding that with a clean repository, in a multi-modu=
le
> >=20
> > project
> >=20
> > > > > with modules X and Y-depends-on-X that the DependencyGraphBui=
lder is
> > > > > throwing a DependencyGraphBuilderException when trying to res=
olve
> > > > > Y-depends-on-X. It says that it cannot find X.
> > > > >=20
> > > > > So it appears that the maven-dependency-tree is only using
> >=20
> > information
> >=20
> > > > from
> > > >=20
> > > > > the repository and not the reactor.
> > > > >=20
> > > > > Is that expected?
> > > > > Is there anyway that I can get MDT to resolve from the reacto=
r?
> > > > > Is there another approach that I should be taking to ensure t=
hat
> > > >=20
> > > > resolution
> > > >=20
> > > > > looks in the reactor?
> > > > >=20
> > > > > NB I need to support both maven 3.0 and 3.1 which is why we a=
re
> > > > > using
> > > > > MDT
> > > > > to provide a level of abstraction above the 2 differing Aethe=
r
> > > > > implementations.
> > > > >=20
> > > > > William
> > > >=20
> > > > ---------------------------------------------------------------=
------
> > > > To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> > > > For additional commands, e-mail: users-help@maven.apache.org
> >=20
> > -------------------------------------------------------------------=
--
> > To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> > For additional commands, e-mail: users-help@maven.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


