From users-return-135918-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Mon Mar 24 19:26:08 2014
Return-Path: <users-return-135918-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8435510031
	for <apmail-maven-users-archive@www.apache.org>; Mon, 24 Mar 2014 19:26:08 +0000 (UTC)
Received: (qmail 58320 invoked by uid 500); 24 Mar 2014 19:26:03 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 58223 invoked by uid 500); 24 Mar 2014 19:26:02 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 58210 invoked by uid 99); 24 Mar 2014 19:26:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Mar 2014 19:26:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of khmarbaise@gmx.de designates 212.227.15.19 as permitted sender)
Received: from [212.227.15.19] (HELO mout.gmx.net) (212.227.15.19)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Mar 2014 19:25:55 +0000
Received: from Karl-Heinzs-MacBook-Pro.local ([109.84.249.131]) by
 mail.gmx.com (mrgmx101) with ESMTPSA (Nemesis) id 0MBrCt-1WLK4A2uHv-00AnUU
 for <users@maven.apache.org>; Mon, 24 Mar 2014 20:25:34 +0100
Message-ID: <533086AA.2070605@gmx.de>
Date: Mon, 24 Mar 2014 20:25:30 +0100
From: Karl Heinz Marbaise <khmarbaise@gmx.de>
Reply-To: info@soebes.de
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:24.0) Gecko/20100101 Thunderbird/24.3.0
MIME-Version: 1.0
To: Maven Users List <users@maven.apache.org>
Subject: Re: properties that are not being resolved
References: <CAMLk=nP5TeMTAp5yNP8PGZSYSc-LAqLn3UTu3Npz+18L03aN1A@mail.gmail.com>	<CANWgJS75c4JPWRStq9p+J21xVyWxgZq1q9fcqdkxLgv+UnwaVg@mail.gmail.com>	<CAMLk=nP2-5=Na+nHweV9wjPDS-NUFOij=vKMtgrc9fHzxGPqPQ@mail.gmail.com> <CADN69ykDKMAMSMXUPvC6yXeEZwoqu+2cQYcMEO0tw7-KUsg6CA@mail.gmail.com>
In-Reply-To: <CADN69ykDKMAMSMXUPvC6yXeEZwoqu+2cQYcMEO0tw7-KUsg6CA@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-Provags-ID:  V03:K0:ZqU6kHqBjhydnLGV7Iz38JpYwzmhruJiPWr9gWp1MQcHNdzgs/2
 8AVHfoYeJTqKWwo2AT28XngUOf3hH053ytPEUevgXLlbZjKo7H7ghggbeUuabOB3/6tSXN9
 bR+OI41pNVSRGYeK4iUi90gG26nVoFVS3vYkIf5VE3DMq4SJj4rvDzx0uBnZAI718swcsda
 FtxtKhCRvAvXqKNVkCJ8g==
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,


 > Hi Henrik,
>
> FYI, my projects use buildnumber-maven-plugin with git and it works great.
> Probably the docs are just out of date.

That looks like. I have created the following JIRA ticket for this.

https://jira.codehaus.org/browse/MBUILDNUM-119

If you have supplementals/infos etc. don't hesitate to add those 
information to the ticket...may be a good idea how to write the information.

Kind regards
Karl-Heinz Marbaise
>
> Regards,
> Curtis
> On Mar 24, 2014 3:05 AM, "Henrik Østerlund Gram" <henrik.gram@gmail.com>
> wrote:
>
>> The one at
>> http://mojo.codehaus.org/buildnumber-maven-plugin/create-mojo.html ?  It
>> states in the first couple of lines that it only works with subversion and
>> I'm using git.
>>
>> Aside from that, I can't really see why it would make a difference; how
>> many ways are there to set properties?  I did establish that the properties
>> are indeed set as I can print them via the ant-run plugin and via the a
>> modified ear-plugin.
>>
>>
>>
>> On Mon, Mar 24, 2014 at 8:28 AM, Baptiste Mathus <bmathus@batmat.net>
>> wrote:
>>
>>> Hi,
>>> Out of curiosity, why don't you use the seemingly equivalent mojo
>>> buildnumber maven plugin? May not be your issue, but may be the plugin
>>> you're using doesn't create properties in the right way (no offense, just
>>> trying to guess)?
>>> My 2 cents
>>> Le 23 mars 2014 22:37, "Henrik Østerlund Gram" <henrik.gram@gmail.com> a
>>> écrit :
>>>
>>>> I stumbled over some rather strange behaviour regarding properties.  It
>>>> seems properties generated by one plugin are not always resolved for
>>> other
>>>> plugins and I can't figure out why.
>>>>
>>>> I use a plugin to make info about the git branch available in the
>>>> properties so it can be passed to other plugins.  The particular plugin
>>>> does not seem important, but I've included it here for sake of
>>>> completeness:
>>>>
>>>> <plugin>
>>>> <groupId>com.code54.mojo</groupId>
>>>> <artifactId>buildversion-plugin</artifactId>
>>>>   <version>1.0.3</version>
>>>> <configuration>
>>>> <tstamp_format>yyyy.MM.dd HH:mm</tstamp_format>
>>>>   </configuration>
>>>> <executions>
>>>> <execution>
>>>>   <goals>
>>>> <goal>set-properties</goal>
>>>> </goals>
>>>>   </execution>
>>>> </executions>
>>>> </plugin>
>>>>
>>>> But when I referenced the properties set by the plugin in an env entry
>>> for
>>>> the maven ear plugin, the properties were not resolved at all:
>>>>
>>>> <envEntries>
>>>> <env-entry>
>>>> <description>Middleware build information</description>
>>>>   <env-entry-name>java:app/env/sw-version</env-entry-name>
>>>> <env-entry-type>java.lang.String</env-entry-type>
>>>>   <env-entry-value>${build-commit} @ ${build-tstamp} built on
>>>> ${maven.build.timestamp}</env-entry-value>
>>>> </env-entry>
>>>> </envEntries>
>>>>
>>>> Just to be sure, I used the latest maven and tried both version 2.9 of
>>> the
>>>> plugin and the latest from the repo with the same result.
>>>>
>>>> The only way I managed to fix this was to patch the maven-ear-plugin
>>>> itself, adding the following code in
>>> GenerateApplicationXmlMojo.execute():
>>>>
>>>> // Fix env variable substitutions
>>>> Properties props = project.getProperties();
>>>> PlexusConfiguration[] entries = envEntries.getChildren();
>>>> if (entries != null) {
>>>>      for (PlexusConfiguration entry : entries) {
>>>>          if ("env-entry".equals(entry.getName())) {
>>>>              PlexusConfiguration[] envEntryChildren =
>> entry.getChildren();
>>>>              if (envEntryChildren != null) {
>>>>                  for (PlexusConfiguration envEntryChild :
>>> envEntryChildren)
>>>> {
>>>>
>>>> envEntryChild.setValue(StrSubstitutor.replace(envEntryChild.getValue(),
>>>> props));
>>>>                  }
>>>>              }
>>>>          }
>>>>      }
>>>> }
>>>>
>>>> Then it worked just fine, but I don't understand why this is necessary.
>>>   I
>>>> thought whatever called the plugin was supposed to have done the
>> variable
>>>> substitution already.  So clearly the properties were present at the
>> time
>>>> of executing the plugin, but they werent being automaticly substituted.
>>>>
>>>> To add to the confusion, using ${project.version} in the
>> env-entry-value
>>>> was resolved just fine, but just not the properties coming from another
>>>> plugin despite the plugins being run in the correct order.
>>>>
>>>> To further add to the confusion, I then used maven ant-run plugin,
>>> echoing
>>>> the values of properties which worked just fine (!)
>>>>
>>>> While I solved the problem for me by making a locally patched version
>> of
>>>> the ear plugin, it's not really a solution I favour, so I hope someone
>>> can
>>>> provide a better and more permanent fix.
>>>>
>>>> Regards,
>>>> Henrik Gram
>>>>
>>>
>>

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


