From users-return-135820-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Thu Mar 13 20:49:43 2014
Return-Path: <users-return-135820-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3AF5A10547
	for <apmail-maven-users-archive@www.apache.org>; Thu, 13 Mar 2014 20:49:43 +0000 (UTC)
Received: (qmail 45829 invoked by uid 500); 13 Mar 2014 20:49:38 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 45675 invoked by uid 500); 13 Mar 2014 20:49:37 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 45223 invoked by uid 99); 13 Mar 2014 20:49:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Mar 2014 20:49:36 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mfriedenhagen@gmail.com designates 209.85.214.173 as permitted sender)
Received: from [209.85.214.173] (HELO mail-ob0-f173.google.com) (209.85.214.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Mar 2014 20:49:32 +0000
Received: by mail-ob0-f173.google.com with SMTP id gq1so1632742obb.4
        for <users@maven.apache.org>; Thu, 13 Mar 2014 13:49:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=WTh8EpC9tdzRVowzGXuNlVgnT6kulsb5PAOrzlmNtS8=;
        b=Jbfe+NCZBE6bB4VfP45WGDT3VRAj7hdOdz+u2MoM2jbBGO4MYdY//okFcn+1SDhOEl
         AAfw7EqgA7pgLq30sKzzsKUkWFxUOFCe8eyrZQFMe390lsFKVzlruYTdq2z4Yq3JWjpz
         sjP54VQ2dr4o3jRXAPEiwTaL/gLr+cQDBxGjDpfsCAL3pPH/57y13Tq1lzeWvIQYGmsf
         zTaW4zZPLWmHRSPKgYWq6LPFmJhp+MIrhAIa6GgN/CbQy7vv0LyfEuwM+lGVrq8WYOUs
         lBhu6TSiocnlqLQGnFVEA6q+C2paySGQMOGeqFvrOaWObHr/hoCLaTWdaN/JVi/H4s6G
         SScg==
X-Received: by 10.182.204.41 with SMTP id kv9mr1964218obc.78.1394743751666;
 Thu, 13 Mar 2014 13:49:11 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.182.193.9 with HTTP; Thu, 13 Mar 2014 13:48:30 -0700 (PDT)
In-Reply-To: <CAPCUOdEXyhzv3a+hNKQKkUezr91HrP_CAcSBS8pzDKSCbNh9vQ@mail.gmail.com>
References: <CADwPi+HM=Ls83GpRhAVnzMXNoku9cwUEdiSSidARo31KRgje0w@mail.gmail.com>
 <CA+nPnMy64XQoyn8eNNvp1GSq5WbyD2cO3m+wik=EVsbNBbTrnA@mail.gmail.com> <CAPCUOdEXyhzv3a+hNKQKkUezr91HrP_CAcSBS8pzDKSCbNh9vQ@mail.gmail.com>
From: Mirko Friedenhagen <mfriedenhagen@gmail.com>
Date: Thu, 13 Mar 2014 21:48:30 +0100
Message-ID: <CAK8jvqyeSa3rd2ZOQ_m4yHC05Qo9wQrnV=TSXp=oMpcejmBTAA@mail.gmail.com>
Subject: Re: [Failsafe] How to properly conduct integration tests on
 executable jar files
To: Maven Users List <users@maven.apache.org>
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Well with Netbeans you just add the following:

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>${surefire.version}</version>
                <configuration>
                    <systemPropertyVariables>

<shadedJarPath>${project.build.directory}/${project.artifactId}-${project.version}-shaded.jar</shadedJarPath>
                    </systemPropertyVariables>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-failsafe-plugin</artifactId>
                <version>${surefire.version}</version>
                <executions>
                    <execution>
                        <id>default-integration-test</id>
                        <goals>
                            <goal>integration-test</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <systemPropertyVariables>

<shadedJarPath>${project.build.directory}/${project.artifactId}-${project.version}-shaded.jar</shadedJarPath>
                    </systemPropertyVariables>
                </configuration>
            </plugin>

and using the Java-task from Ant:

import org.apache.tools.ant.BuildException;
import org.apache.tools.ant.ExitStatusException;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.taskdefs.Java;
import org.apache.tools.ant.types.Commandline;

public class ShadedIT {
    @Test
   public void testShaded() throws Exception {
        Java java = new Java();
        java.setProject(new Project());
        java.setFailonerror(true);
        java.setFork(true);
        java.setJar(shadedJar);
        Commandline.Argument arg = java.createArg();
        arg.setFile(csvFile);
        java.execute();
    }
}

This will be executed by failsafe from the CLI and you may run the
class from Netbeans without any special settings.
Regards Mirko
--
http://illegalstateexception.blogspot.com/
https://github.com/mfriedenhagen/ (http://osrc.dfm.io/mfriedenhagen)
https://bitbucket.org/mfriedenhagen/


On Thu, Mar 13, 2014 at 10:50 AM, Adrien Rivard <adrien.rivard@gmail.com> wrote:
> If you are using Eclipse you could also pass the system property directly
> to the JRE. ( Windows/Preferences/installed JRE/ edit /default VM arguments)
> It require less work than putting it in all run configuration, but all your
> process will have it.
>
>
>
> On Thu, Mar 13, 2014 at 8:56 AM, Stephen Connolly <
> stephen.alan.connolly@gmail.com> wrote:
>
>> You could use test resource filtering to put the path into a resource file
>> on the test classpath.
>>
>> That way the IDE will pick up the same path.
>>
>> On Thursday, 13 March 2014, Alex Karasulu <akarasulu@apache.org> wrote:
>>
>> > Hello,
>> >
>> > I've got a module that builds an executable jar file using the Maven
>> > Assembly Plugin. I'm trying to setup an integration test (in the same
>> > module) that runs this executable jar file as a separate process and
>> > interacts with it. To fire up the executable jar file, my integration
>> test
>> > requires the path to the executable jar file.
>> >
>> > I'm trying to achieve this by passing a property to the integration-test
>> > via system properties. This makes me feel really really dirty though and
>> it
>> > has issues: although the test runs on the CLI it does not in any IDE
>> > without requiring further configuration (i.e. the property has to be
>> > manually added to a run configuration).
>> >
>> > After googling around a bit and reading the documentation there seems to
>> be
>> > no other option for this scenario. In case I'm overlooking something, I
>> > wanted to ask here if there is a better way to start up this executable
>> jar
>> > file or pass in the needed parameters to do so in the integration test?
>> >
>> > --
>> > Best Regards,
>> > -- Alex
>> >
>>
>>
>> --
>> Sent from my phone
>>
>
>
>
> --
> Adrien Rivard

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


