From users-return-135937-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Tue Mar 25 22:32:39 2014
Return-Path: <users-return-135937-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8DB221088C
	for <apmail-maven-users-archive@www.apache.org>; Tue, 25 Mar 2014 22:32:39 +0000 (UTC)
Received: (qmail 49042 invoked by uid 500); 25 Mar 2014 22:32:35 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 48966 invoked by uid 500); 25 Mar 2014 22:32:35 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 48958 invoked by uid 99); 25 Mar 2014 22:32:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Mar 2014 22:32:35 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mfriedenhagen@gmail.com designates 209.85.219.46 as permitted sender)
Received: from [209.85.219.46] (HELO mail-oa0-f46.google.com) (209.85.219.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Mar 2014 22:32:31 +0000
Received: by mail-oa0-f46.google.com with SMTP id i7so1433266oag.19
        for <users@maven.apache.org>; Tue, 25 Mar 2014 15:32:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=TsFEpx2pvGslbb+hBa3Wvanvum7r+ruPWWr/ecbo5fM=;
        b=WHBrNew4yGMKa9M+ByBvVNcu8VTfhp7Ss6wp+BNz6R4wJzSXOY1ipUBt2qexPwwwfS
         oZu2l7XSTO73hZ0MVGnfV3MYdIekCQXannsfkT4DqyuoXLZ5MYAjTIKELQbRtWiQ5KK0
         dmtqNIi4wryMFZ7A0TytJlfHFyaSfsdQuHBRd4uPwW97P0E7RAhTOsZa1alIbMWSinBf
         T+1bhQ1ijDgou7zGrNL5HqyJhfpXwGt7BcxO7Zw9U42vSM1Im+1oXKsdT+Sn4FtujvQB
         W7HrRMC3vsGWj+GsXAtl8D/K/TW9Q+SSAwcA80cHfRtTg3W8wh82MXWH+eZdVZMAnSvS
         Cdow==
MIME-Version: 1.0
X-Received: by 10.182.20.111 with SMTP id m15mr3748516obe.61.1395786730651;
 Tue, 25 Mar 2014 15:32:10 -0700 (PDT)
Received: by 10.182.193.9 with HTTP; Tue, 25 Mar 2014 15:32:10 -0700 (PDT)
Received: by 10.182.193.9 with HTTP; Tue, 25 Mar 2014 15:32:10 -0700 (PDT)
In-Reply-To: <5331EF6E.1070106@gmail.com>
References: <532B4246.9050606@gmail.com>
	<CAK8jvqxqOQS34dbfjxsJFv4E17bAddK3zKww6syckRPwOv6z6Q@mail.gmail.com>
	<532C9CCE.70404@gmail.com>
	<5331EF6E.1070106@gmail.com>
Date: Tue, 25 Mar 2014 23:32:10 +0100
Message-ID: <CAK8jvqyvRgW97BzT441fzVsKOH8vEBnnkePdstBYQfGcNKHZTQ@mail.gmail.com>
Subject: Re: Forcing Integration Tests Before a Release
From: Mirko Friedenhagen <mfriedenhagen@gmail.com>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=001a11330e6643493804f575ec35
X-Virus-Checked: Checked by ClamAV on apache.org

--001a11330e6643493804f575ec35
Content-Type: text/plain; charset=UTF-8

Eric,

I do only use release:prepare, see
https://github.com/1and1/foss-parent/blob/master/release line 47ff.

Regards
Mirko
-- 
Sent from my mobile
On Mar 25, 2014 10:05 PM, "Eric Kolotyluk" <eric.kolotyluk@gmail.com> wrote:

> I have tried to get this working, but it does not seem to work. When I do
>
>   mvn release:prepare
>
> I get
>
>   [INFO] Executing: cmd.exe /X /C "D:\bin\Apache\apache-maven-3.1.1\bin\mvn
> -s C:\Users\Eric\AppData\Local\Temp\release-settings2652114304406041143.xml
> clean verify site --no-plugin-updates -Psonatype-oss-release -P
> user,local-repository"
>
> In the output I can see the 'clean' and the 'site' happen, but the
> failsafe integration tests do not run. If I do
>
>   mvn verify -P run-it
>
> then the integration tests run as normal.
>
> Cheers, Eric
>
>   <build>
>     <pluginManagement>
>       <plugins>
>         <plugin>
>           <groupId>org.apache.maven.plugins</groupId>
>           <artifactId>maven-failsafe-plugin</artifactId>
>           <version>2.17</version>
>           <executions>
>             <execution>
>               <id>default-integration-test</id>
>               <goals>
>                 <goal>integration-test</goal>
>               </goals>
>             </execution>
>             <execution>
>               <id>default-verify</id>
>               <goals>
>                 <goal>verify</goal>
>               </goals>
>             </execution>
>           </executions>
>         </plugin>
>         <plugin>
>           <artifactId>maven-release-plugin</artifactId>
>           <version>2.5</version>
>         </plugin>
>       </plugins>
>     </pluginManagement>
>     <plugins>
>       <plugin>
>         <artifactId>maven-release-plugin</artifactId>
>         <configuration>
>           <preparationGoals>clean verify site</preparationGoals>
>         </configuration>
>       </plugin>
>     . . .
>
>   <profiles>
>     <profile>
>       <id>run-it</id>
>       <activation>
>         <property>
>           <name>performRelease</name>
>           <value>true</value>
>         </property>
>       </activation>
>       <build>
>         <plugins>
>           <plugin>
>             <groupId>org.apache.maven.plugins</groupId>
> <artifactId>maven-failsafe-plugin</artifactId>
>             <executions>
>               <execution>
>                 <goals>
>                   <goal>integration-test</goal>
>                   <goal>verify</goal>
>                 </goals>
>               </execution>
>             </executions>
>           </plugin>
>         </plugins>
>       </build>
>     </profile>
>   </profiles>
>
> On 3/21/2014 1:10 PM, Eric Kolotyluk wrote:
>
>> Cool, that is what I am looking for. Thanks so much.
>>
>> Cheers, Eric
>>
>> On 2014-03-20, 1:50 PM, Mirko Friedenhagen wrote:
>>
>>> Eric,
>>>
>>> when you use the maven-release-plugin a property performRelease is set
>>> during release:perform.
>>>
>>> So define in the pluginManagement section a definition for the
>>> maven-failsafe-plugin in your build section:
>>>
>>> <build>
>>>     <pluginManagement>
>>>         <plugins>
>>>                <plugin>
>>> <groupId>org.apache.maven.plugins</groupId>
>>> <artifactId>maven-failsafe-plugin</artifactId>
>>>                      <version>2.17</version>
>>>                      <executions>
>>>                          <execution>
>>> <id>default-integration-test</id>
>>>                              <goals>
>>> <goal>integration-test</goal>
>>>                              </goals>
>>>                          </execution>
>>>                          <execution>
>>>                              <id>default-verify</id>
>>>                              <goals>
>>>                                  <goal>verify</goal>
>>>                              </goals>
>>>                          </execution>
>>>                      </executions>
>>>                  </plugin>
>>>         </plugins>
>>>     </pluginManagement>
>>> </build>
>>>
>>> and later on in your pom
>>>
>>>      <profile>
>>>              <id>release-run-failsafe</id>
>>>              <activation>
>>>                  <property>
>>>                      <name>performRelease</name>
>>>                      <value>true</value>
>>>                  </property>
>>>              </activation>
>>>              <build>
>>>                   <plugins>
>>>                      <plugin>
>>> <groupId>org.apache.maven.plugins</groupId>
>>> <artifactId>maven-failsafe-plugin</artifactId>
>>>                      </plugin>
>>>                  </plugins>
>>>              </build>
>>>      <profile>
>>>
>>> So only during release:perform your integration tests will be executed
>>> and success is verified.
>>> Regards Mirko
>>> --
>>> http://illegalstateexception.blogspot.com/
>>> https://github.com/mfriedenhagen/ (http://osrc.dfm.io/mfriedenhagen)
>>> https://bitbucket.org/mfriedenhagen/
>>>
>>>
>>> On Thu, Mar 20, 2014 at 8:32 PM, Eric Kolotyluk
>>> <eric.kolotyluk@gmail.com> wrote:
>>>
>>>> I am looking for some way to force my integration tests before a
>>>> release,
>>>> without explicitly using a profile.
>>>>
>>>> For example,
>>>>
>>>>        <plugin>
>>>> <artifactId>maven-release-plugin</artifactId>
>>>>          <configuration>
>>>>            <preparationGoals>clean verify site</preparationGoals>
>>>>          </configuration>
>>>>        </plugin>
>>>>
>>>> But that doesn't work because unless the failsafe plugin is defined, it
>>>> won't run the tests.
>>>>
>>>> I thought of doing something like
>>>>
>>>>    <profiles>
>>>>      <profile>
>>>>        <id>run-it</id>
>>>>        <activation>
>>>>          <file>
>>>> <missing>target/failsafe-reports</missing>
>>>>          </file>
>>>>        </activation>
>>>>        <build>
>>>>          <plugins>
>>>>            <plugin>
>>>> <groupId>org.apache.maven.plugins</groupId>
>>>> <artifactId>maven-failsafe-plugin</artifactId>
>>>>              <version>2.17</version>
>>>>              <executions>
>>>>                <execution>
>>>>                  <goals>
>>>>                    <goal>integration-test</goal>
>>>>                    <goal>verify</goal>
>>>>                  </goals>
>>>>                </execution>
>>>>              </executions>
>>>>            </plugin>
>>>>          </plugins>
>>>>        </build>
>>>>      </profile>
>>>>    </profiles>
>>>>
>>>> But that will cause the integration tests to be run after every clean.
>>>>
>>>> Is there some way I can trigger the integration tests when doing a
>>>> release
>>>>
>>>>     mvn release:prepare
>>>>
>>>> without having to do
>>>>
>>>>     mvn release:prepare -P run-it
>>>>
>>>> Cheers, Eric
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
>>>> For additional commands, e-mail: users-help@maven.apache.org
>>>>
>>>>  ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
>>> For additional commands, e-mail: users-help@maven.apache.org
>>>
>>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> For additional commands, e-mail: users-help@maven.apache.org
>
>

--001a11330e6643493804f575ec35--

