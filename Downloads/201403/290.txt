From users-return-135778-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Wed Mar 12 03:07:35 2014
Return-Path: <users-return-135778-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0085F10689
	for <apmail-maven-users-archive@www.apache.org>; Wed, 12 Mar 2014 03:07:35 +0000 (UTC)
Received: (qmail 36599 invoked by uid 500); 12 Mar 2014 03:07:31 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 36028 invoked by uid 500); 12 Mar 2014 03:07:30 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 36017 invoked by uid 99); 12 Mar 2014 03:07:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Mar 2014 03:07:27 +0000
X-ASF-Spam-Status: No, hits=-8.0 required=5.0
	tests=ENV_AND_HDR_SPF_MATCH,RCVD_IN_DNSWL_NONE,SPF_PASS,USER_IN_DEF_SPF_WL
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mmao@ebay.com designates 216.113.172.65 as permitted sender)
Received: from [216.113.172.65] (HELO phx-mipot-002.corp.ebay.com) (216.113.172.65)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Mar 2014 03:07:21 +0000
DomainKey-Signature: s=ebaycorp; d=ebay.com; c=nofws; q=dns;
  h=X-EBay-Corp:X-IronPort-AV:Received:Received:From:To:CC:
   Subject:Thread-Topic:Thread-Index:Date:Message-ID:
   References:In-Reply-To:Accept-Language:Content-Language:
   X-MS-Has-Attach:X-MS-TNEF-Correlator:x-originating-ip:
   Content-Type:Content-Transfer-Encoding:MIME-Version:
   X-CFilter;
  b=neXXKHTbbYcnvaGXshXnTiH0EXJe7dPOggv5zs9P0CWYUp/FpvxZ1/TG
   0DfYd9sn929MasCmWdyFksZtPG1gGAMh7xCfi1L5Pa7yqLuMNhVqrPzIN
   nnz4wZUFDdIebhbuD+LNP28laxa6DZJvCCU46CObRq5Ab6Y8dMbc4iAd9
   Y=;
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ebay.com; i=@ebay.com; q=dns/txt; s=ebaycorp;
  t=1394593641; x=1426129641;
  h=from:to:cc:subject:date:message-id:references:
   in-reply-to:content-transfer-encoding:mime-version;
  bh=guxWT8v7xg5taXMVo6M91e3vWuJOX+5B80cWgxRQtF0=;
  b=G8y9UXVUgsBh8ethylk/g+LoNOGSs6zXvb3zYuaeoVDO07VUL+nIeHA8
   lOybnyWhWBtYUHxq53jQQt5Olvu0ZU7fAl8rdpYfq1SLzNzLVEPFDxhvC
   n/CBPC8rEx+D4Rzbru1wstA2lS1Tq8D45yVxayhxwu8ffBSFPns18WsWd
   s=;
X-EBay-Corp: Yes
X-IronPort-AV: E=Sophos;i="4.97,635,1389772800"; 
   d="scan'208";a="195761307"
Received: from phx-vteml-004.corp.ebay.com (HELO PHX-EXMHT-005.corp.ebay.com) ([10.58.40.103])
  by phx-mipot-002.corp.ebay.com with ESMTP; 11 Mar 2014 20:06:59 -0700
Received: from PHX-EXRDA-S21.corp.ebay.com ([169.254.1.230]) by
 PHX-EXMHT-005.corp.ebay.com ([10.58.12.78]) with mapi id 14.03.0174.001; Tue,
 11 Mar 2014 20:06:58 -0700
From: "Mao, James(Maode)" <mmao@ebay.com>
To: Bernd Eckenfels <ecki@zusammenkunft.net>
CC: "users@maven.apache.org" <users@maven.apache.org>
Subject: RE: Maven 3.1.1 dependency downloading issues
Thread-Topic: Maven 3.1.1 dependency downloading issues
Thread-Index: Ac89Cfv57EbFwkl9Sd2kSPM5z8tohgAzXBAAAA4lU2A=
Date: Wed, 12 Mar 2014 03:06:57 +0000
Message-ID: <87911B8B30550C43B5947BA274E00CB472535265@PHX-EXRDA-S21.corp.ebay.com>
References: <87911B8B30550C43B5947BA274E00CB472534993@PHX-EXRDA-S21.corp.ebay.com>
 <20140312034246.00007de1.ecki@zusammenkunft.net>
In-Reply-To: <20140312034246.00007de1.ecki@zusammenkunft.net>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-originating-ip: [10.58.61.242]
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-CFilter: Scanned
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Bernd,

Thanks for the quick response.

For example, my project's pom defined only one repository (mycentral), but =
the dependencies maybe defined three other repository (jboss/redhat/codehau=
s)

In Maven 3.0.5, I guess it download artifacts from 4 repos one by one, so m=
ycentral is the first one to try, and if it gets artifact from that repo, a=
nd it's done. It will not try to download from the rest repos.

In Maven 3.1.1, I guess it starts 4 threads to download artifact from 4 rep=
os in parallel, so here comes the issue. in my server, I cannot access jbos=
s/redhat/codehaus, I can only access mycentral. So the 1st thread get the a=
rtifact, but the other three threads are still trying to download the artif=
acts from jboss/redhat/codehaus, which are not accessible. and it's blocked=
 until timeout, so this really slow down the build.

I am not sure if what I am saying is correct behavior for Maven 3.1.1.

If it's correct, seems my options are
1. configure the threads to just 1, so mycental always the first one to try=
.=20
2. block all external repositories, just left mycentral.

Any other suggestions?

Thanks,
James

-----Original Message-----
From: Bernd Eckenfels [mailto:ecki@zusammenkunft.net]=20
Sent: Wednesday, March 12, 2014 10:43 AM
To: Mao, James(Maode)
Cc: users@maven.apache.org
Subject: Re: Maven 3.1.1 dependency downloading issues

Hello,

Am Tue, 11 Mar 2014 09:20:57 +0000
schrieb "Mao, James(Maode)" <mmao@ebay.com>:

> Hi,
>=20
> I found that Maven 3.1.1 will try downloading the artifacts in=20
> parallel.
> This cause the issue, actually the first try already downloaded the=20
> pom, but Maven still trying other repository in paralle.

Not sure which issue?

> In our CI
> server we cannot access repository.jboss.org. that cause the system=20
> hang until it's timeout.

You typically add a mirror to external repositories onto your local reposit=
ory. Then maven can get those artifacts and you will be able to archive a l=
ocal copy to make your build process reproducible.

> l  Can we configure the threads number for parallel downloading.

This is a 2.1 feature, it is described in the maven guide:

http://maven.apache.org/guides/mini/guide-configuring-maven.html

> l  Why Maven 3.1.1 will try to download artifacts from=20
> repository.jboss.org, we did not define in our settings.xml and pom.

You have most likely some POMs in your project from JBoss/Redhat which have=
 itself defined the JBoss repository. If it rresolves your dependencies it =
will download the other resources from the repositories defined in those de=
pendend projects.=20

> Can we remove those external repositories?

You could have a look at the -X debug output and <exclude> the dependencies=
 which have those repository requirements, but as I wrote above you typical=
ly have to operate a mirror sooner or later.

BTW: no need to ask on both maven lists, the users list is perfectly fine, =
will remove the developer list from the distributon.

Greertings
Bernd

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


