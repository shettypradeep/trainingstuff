From users-return-135302-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Thu Jan 30 08:50:00 2014
Return-Path: <users-return-135302-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CCB9910C28
	for <apmail-maven-users-archive@www.apache.org>; Thu, 30 Jan 2014 08:50:00 +0000 (UTC)
Received: (qmail 6516 invoked by uid 500); 30 Jan 2014 08:49:55 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 6362 invoked by uid 500); 30 Jan 2014 08:49:51 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 6348 invoked by uid 99); 30 Jan 2014 08:49:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Jan 2014 08:49:50 +0000
X-ASF-Spam-Status: No, hits=0.2 required=5.0
	tests=FREEMAIL_ENVFROM_END_DIGIT,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of matthias.1.0@gmx.de designates 212.227.17.22 as permitted sender)
Received: from [212.227.17.22] (HELO mout.gmx.net) (212.227.17.22)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Jan 2014 08:49:43 +0000
Received: from 3capp-gmx-bs09.server.lan ([172.19.170.60]) by
 mrigmx.server.lan (mrigmx002) with ESMTP (Nemesis) id
 0M3PbS-1VICl12xrE-00qxpQ for <users@maven.apache.org>; Thu, 30 Jan 2014
 09:49:23 +0100
Received: from [212.227.35.93] by 3capp-gmx-bs09.server.lan with HTTP; Thu
 Jan 30 09:49:23 CET 2014
MIME-Version: 1.0
Message-ID: <trinity-0b389549-c055-4c46-bc14-f0fd4de6c290-1391071763589@3capp-gmx-bs09>
From: "Matthias Mayer" <matthias.1.0@gmx.de>
To: users@maven.apache.org
Subject: maven-enforcer-plugin problems with test dependency in multi module
 project
Content-Type: text/plain; charset=UTF-8
Date: Thu, 30 Jan 2014 09:49:23 +0100 (CET)
Importance: normal
Sensitivity: Normal
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-Provags-ID: V03:K0:tSFy7l6Ve4+i4p5vN9S4Ag4pvZKy2e4+a49xQvPkgQH
 8cQJd8NYCpVTCA+UucaqBCBq5H9JsHmgEs5Mu1ANmFAjVEgnQ0
 mHC4cx6cRAClrEKeLyYmZgYRtZh/73b9DNRrUEZU2wrnwLISBz
 k9wtgxRurSrcZuD3kLbXr22+8DvYyYmvsBIhjopPCJjP8uxqj7
 VKPmblXmJjTD/TQaccyGmGYGepj/4I77Yq2eSjtn2FT/GDdDHr
 km41h7F6uCEheBXSrrt9IwjWg3MZdTYUk4iUt08S9ukKbsNbjM LbAyvo=
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
=C2=A0
I have a multi-module-project with one module that implements classes for =
testing (test-parent) and another module (test-child) that uses theses clas=
ses. There is a dependency in test scope from the test-child to the test-pa=
rent.
(See article http://stackoverflow.com/questions/1725476/maven-test-depende=
ncy-in-multi-module-project and http://maven.apache.org/guides/mini/guide-a=
ttached-tests.html[http://maven.apache.org/guides/mini/guide-attached-tests=
.html])
The pom of the depending test-child contains the following code:

<dependencies>
=C2=A0 <dependency>
=C2=A0=C2=A0=C2=A0 <groupId>test</groupId>
=C2=A0=C2=A0=C2=A0 <artifactId>test-parent</artifactId>
=C2=A0=C2=A0=C2=A0 <version>1.0-SNAPSHOT</version>
=C2=A0=C2=A0=C2=A0 <type>test-jar</type>
=C2=A0=C2=A0=C2=A0 <scope>test</scope>
=C2=A0 </dependency>
</dependencies>

The test-parent module that contains the derived classes contains the foll=
owing code:

<plugins>
=C2=A0 <plugin>
=C2=A0=C2=A0=C2=A0 <artifactId>maven-jar-plugin</artifactId>
=C2=A0=C2=A0=C2=A0 <version>2.2</version>
=C2=A0=C2=A0=C2=A0 <executions>
=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0<execution>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0<goals>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0=C2=A0<goal>test-jar</goa=
l>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0</goals>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <phase>test-compile</phase>
=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0</execution>
=C2=A0=C2=A0=C2=A0 </executions>
=C2=A0 </plugin>
</plugins>

In a parent pom the maven-enforcer-plugin is included and the RequireRelea=
seDeps rule is added to the list of rules. While running the Maven goal =E2=
=80=9Ccompile=E2=80=9D =C2=A0the project compilation of the test-child fail=
s with the following message:
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-enforcer-plu=
gin:1.3.1:enforce (default) on project test-child: Execution default of goa=
l org.apache.maven.plugins:maven-enforcer-plugin:1.3.1:enforce failed: org.=
apache.maven.shared.dependency.graph.DependencyGraphBuilderException: Could=
 not resolve dependencies for project test:test-child:jar:1.0.0: Failure to=
 find test:test-parent:jar:tests:1.0.0
It seems that Maven checks the dependencies of type and scope =E2=80=9Ctes=
t=E2=80=9D in the compile phase. In the case the test-jar is build in the t=
est-compile and is not present yet. This leads to the error.
If I remove the RequireReleaseDeps from the rules it works fine.
Here is the simplified config of the maven-enforcer-plugin:

<pluginManagement>
=C2=A0 <plugins>
=C2=A0=C2=A0=C2=A0 <plugin>
=C2=A0=C2=A0 =C2=A0=C2=A0=C2=A0<groupId>org.apache.maven.plugins</groupId>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <artifactId>maven-enforcer-plugin</artifact=
Id>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <version>${maven-enforcer-plugin.version}</=
version>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <inherited>true</inherited>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <executions>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0<execution>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0<goals><goal>enforc=
e</goal></goals>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0</execution>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 </executions>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <configuration>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <!-- <skip/> -->
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <rules>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <requireReleaseDeps=
>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0<onlyWh=
enRelease>false</onlyWhenRelease>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 </requireReleaseDep=
s>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <requireMavenVersio=
n>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0<versio=
n>[3.0.4,]</version>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0</requireMavenVersi=
on>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 </rules>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0<fail>${maven-enforcer-plugin.f=
ail}</fail>
=C2=A0=C2=A0=C2=A0 =C2=A0=C2=A0</configuration>
=C2=A0 =C2=A0=C2=A0</plugin>
=C2=A0 </plugins>
</pluginManagement>
=C2=A0 <plugins>
=C2=A0=C2=A0=C2=A0 <plugin>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <groupId>org.apache.maven.plugins</gr=
oupId>
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 <artifactId>maven-enforcer-plugin</artifact=
Id>
=C2=A0=C2=A0=C2=A0 </plugin>
=C2=A0 </plugins>
</build>

Is this behavior of the maven-enforcer-plug-in correct? If so, is there a =
way to work around it?
=C2=A0
Matthias

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


