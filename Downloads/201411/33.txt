From users-return-137885-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Sun Nov 30 11:30:55 2014
Return-Path: <users-return-137885-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 03980C5FC
	for <apmail-maven-users-archive@www.apache.org>; Sun, 30 Nov 2014 11:30:55 +0000 (UTC)
Received: (qmail 55597 invoked by uid 500); 30 Nov 2014 11:30:52 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 55497 invoked by uid 500); 30 Nov 2014 11:30:52 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 55485 invoked by uid 99); 30 Nov 2014 11:30:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Nov 2014 11:30:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of christofer.dutz@c-ware.de designates 157.55.234.145 as permitted sender)
Received: from [157.55.234.145] (HELO emea01-db3-obe.outbound.protection.outlook.com) (157.55.234.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Nov 2014 11:30:47 +0000
Received: from AMSPR05MB0611.eurprd05.prod.outlook.com (10.242.15.149) by
 AMSPR05MB0611.eurprd05.prod.outlook.com (10.242.15.149) with Microsoft SMTP
 Server (TLS) id 15.1.26.15; Sun, 30 Nov 2014 11:30:03 +0000
Received: from AMSPR05MB0611.eurprd05.prod.outlook.com ([10.242.15.149]) by
 AMSPR05MB0611.eurprd05.prod.outlook.com ([10.242.15.149]) with mapi id
 15.01.0026.003; Sun, 30 Nov 2014 11:30:03 +0000
From: Christofer Dutz <christofer.dutz@c-ware.de>
To: Maven Users List <users@maven.apache.org>
Subject: AW: Problems with the release plugin
Thread-Topic: Problems with the release plugin
Thread-Index: AdAKPRrNeNhgM+z+QnigxnOcqOU3bQA9YwWAAFdAj3A=
Date: Sun, 30 Nov 2014 11:30:02 +0000
Message-ID: <46b88b5354ce4ec3a8ef5307adcb4381@AMSPR05MB0611.eurprd05.prod.outlook.com>
References: <4D781E28644D7B46878137FBCBC852F01269EB@gf0vswex001p.corp.int>
 <op.xp1p28hrkdkhrr@robertscholte.dynamic.ziggo.nl>
In-Reply-To: <op.xp1p28hrkdkhrr@robertscholte.dynamic.ziggo.nl>
Accept-Language: de-DE, en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-originating-ip: [84.150.109.236]
x-microsoft-antispam: BCL:0;PCL:0;RULEID:;SRVR:AMSPR05MB0611;
x-exchange-antispam-report-test: UriScan:;
x-exchange-antispam-report-cfa-test: BCL:0;PCL:0;RULEID:;SRVR:AMSPR05MB0611;
x-forefront-prvs: 04111BAC64
x-forefront-antispam-report: SFV:NSPM;SFS:(10019020)(6009001)(199003)(252514010)(51704005)(189002)(107886001)(62966003)(77156002)(110136001)(40100003)(33646002)(74482002)(229853001)(76576001)(4396001)(108616004)(21056001)(120916001)(99396003)(122556002)(31966008)(450100001)(97736003)(46102003)(95666004)(107046002)(15202345003)(106356001)(105586002)(66066001)(86362001)(76176999)(87936001)(19580405001)(54356999)(19580395003)(64706001)(101416001)(50986999)(15975445006)(2656002)(75402003)(92566001)(74316001)(20776003)(1720100001)(24736002);DIR:OUT;SFP:1102;SCL:1;SRVR:AMSPR05MB0611;H:AMSPR05MB0611.eurprd05.prod.outlook.com;FPR:;SPF:None;MLV:sfv;PTR:InfoNoRecords;A:1;MX:1;LANG:en;
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-OriginatorOrg: c-ware.de
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Robert,

Thanks for your reply, but I have encountered numerous situations where thi=
s restriction resulted in people not using the pulugin at all ... doing eac=
h step with alternate plugins and unfortunately leaving away some of the st=
eps.

So ususally they use the versions plugin or manually adjust the versions.
Commit
Tag
Build & Deploy
Update to the next version
Comit again

completely skipping some of the usual additional testing steps

I know that handling the commandline is tricky and a lot can go wrong here.=
 Thats why I usually have this created by a Jenkins plugin which I created =
(https://github.com/chrisdutz/jenkins-release-plugin).=20

Also it sort of feels like I am doing Ant to Maven migration for the last f=
ew years all the time ... for business, in other Apache Project (Mainly Apa=
che Flex) ... and every now and then I come to this point.=20

I still don't really see how losening this restriction would really break s=
omething. Every time this issue comes up, I get responses like "don't want =
to break anything" but I don't quite understand how this would actually bre=
ak things.

Another route would be to extend the versions plugin tob e able to set mult=
iple artifacts versions to given versions.=20

Or last but least to create a new plugin, which I would really like to avoi=
d.

Chris





-----Urspr=FCngliche Nachricht-----
Von: Robert Scholte [mailto:rfscholte@apache.org]=20
Gesendet: Freitag, 28. November 2014 18:42
An: Maven Users List
Betreff: Re: Problems with the release plugin

Op Thu, 27 Nov 2014 14:12:58 +0100 schreef Dutz, Christofer
<C.Dutz@ing-diba.de>:

> Hi,
>
> I just ran into a problem I was having a few times now with the=20
> release plugin. This time the usage scenario is different, but the=20
> code needed to be changed is still the same.
>
> This time I am helping migrate a large set of projects from Ant to=20
> Maven. As this involves a large amount of training the transition is=20
> done project by project.
> Currently as a first step all projects are changed to deploy SNAPSHOT=20
> and release versions to Nexus instead of deploying to an Ivy repo. For=20
> this all Ant builds were extended to produce and deploy artifacts=20
> useable by Maven and the Ant builds are configured to use Nexus=20
> instead of Ivy.
>
> Now whenever a release is done there actually have to be two releases=20
> performed. One Ant and one Maven release. For the Maven part we wanted=20
> to use the default release plugin. For this we are planning on=20
> providing the release and development version for each artifact as=20
> described in this article:
> http://maven.apache.org/maven-release/maven-release-plugin/examples/no
> n-interactive-release.html For the Ant part we have created an Ant=20
> task that updates the ivy.xml to the correct versions, which=20
> understands the same syntax of providing dev and rel versions as that=20
> of the Maven release plugin.
>
> Now the problem is that AbstractRewritePomsPhase only seems to process=20
> the version numbers of artifacts that are in the reactor:
>
> https://github.com/apache/maven-release/blob/trunk/maven-release-manag
> er/src/main/java/org/apache/maven/shared/release/phase/AbstractRewrite
> PomsPhase.java
>
> Wouldn't it be possible to leave the version map the way it is,=20
> without filtering anything out? If a user provides the rel version and=20
> the dev version for an artifact I would assume that he actually should=20
> have a reason for doing this. This behaviour is causing quite some=20
> difficulties here.
>
This is probably the most tricky part. I'd like to keep the process as simp=
le as possible with a minimum of a failing release. Since we only have full=
 control over the versions of the current (multimodule) project, these are =
safe to map. *If* we allow versions of other dependencies as well, then the=
se should be checked as well, both release and development version.
The maven-release-plugin is just too important to allow these kind of manua=
l input where the changes of failure are that big.

I've started with the introduction of a VersionPolicy[1] in the maven-relea=
se-plugin. It's not yet exposed, so you can't specify your own policies yet=
. But this would give you the opportunity to select the versions automatica=
lly instead of specifying it from cmdline (which is doomed to fail every no=
w and than).

So here you could help and see if this concept works for you as well.

regards,
Robert

[1]
http://maven.apache.org/maven-release/maven-release-api/apidocs/index.html

> I would be glad to assitst in finding a good solution for this, if=20
> there is no chance in getting this changed, we will propably have to=20
> work on a custom version oft he release plugin, which I would really like=
 to avoid.
>
> Chris
>
> --
>
> ING-DiBa AG, Frankfurt am Main. Registernummer HRB 7727,=20
> Handelsregister Amtsgericht Frankfurt am Main. Vorstand: Roland=20
> Boekhout (Vorsitzender), Herbert Willius (stellv. Vorsitzender), Bernd=20
> Geilen, Katharina Herrmann, Martin Krebs, Remco Nieland.
> Aufsichtsrat: Ben Tellings (Vorsitzender)
>
> Diese E-Mail enth=E4lt vertrauliche und/oder rechtlich gesch=FCtzte=20
> Informationen. Wenn Sie nicht der richtige Adressat sind oder diese=20
> E-Mail irrt=FCmlich erhalten haben, informieren Sie bitte sofort den=20
> Absender und vernichten Sie diese Mail.
> Das unerlaubte Kopieren sowie die unbefugte Weitergabe dieser Mail ist=20
> nicht gestattet.
>
> This e-mail may contain confidential and/or privileged information. If=20
> you are not the intended recipient (or have received this e-mail in
> error) please notify the sender immediately and destroy this e-mail.=20
> Any unauthorized copying, disclosure or distribution of the material=20
> in this e-mail is strictly forbidden.
>
> ING-DiBa AG, Frankfurt am Main. Registernummer HRB 7727,=20
> Handelsregister Amtsgericht Frankfurt am Main. Vorstand: Roland=20
> Boekhout (Vorsitzender), Bernd Geilen, Katharina Herrmann, Martin Krebs, =
Remco Nieland.
> Aufsichtsrat: Ben Tellings (Vorsitzender)
>
> Diese E-Mail enth=E4lt vertrauliche und/oder rechtlich gesch=FCtzte=20
> Informationen. Wenn Sie nicht der richtige Adressat sind oder diese=20
> E-Mail irrt=FCmlich erhalten haben, informieren Sie bitte sofort den=20
> Absender und vernichten Sie diese Mail.
> Das unerlaubte Kopieren sowie die unbefugte Weitergabe dieser Mail ist=20
> nicht gestattet.
>
> This e-mail may contain confidential and/or privileged information. If=20
> you are not the intended recipient (or have received this e-mail in
> error) please notify the sender immediately and destroy this e-mail.=20
> Any unauthorized copying, disclosure or distribution of the material=20
> in this e-mail is strictly forbidden.

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


