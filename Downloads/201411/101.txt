From users-return-137876-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Nov 28 17:42:22 2014
Return-Path: <users-return-137876-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 074EBC7B2
	for <apmail-maven-users-archive@www.apache.org>; Fri, 28 Nov 2014 17:42:22 +0000 (UTC)
Received: (qmail 41455 invoked by uid 500); 28 Nov 2014 17:42:20 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 41371 invoked by uid 500); 28 Nov 2014 17:42:20 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 41360 invoked by uid 99); 28 Nov 2014 17:42:20 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Nov 2014 17:42:20 +0000
Received: from robertscholte.dynamic.ziggo.nl (5248749D.cm-4-1b.dynamic.ziggo.nl [82.72.116.157])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 7B78D1A0019
	for <users@maven.apache.org>; Fri, 28 Nov 2014 17:42:03 +0000 (UTC)
Content-Type: text/plain; charset=iso-8859-15; format=flowed; delsp=yes
To: "Maven Users List" <users@maven.apache.org>
Subject: Re: Problems with the release plugin
References: <4D781E28644D7B46878137FBCBC852F01269EB@gf0vswex001p.corp.int>
Date: Fri, 28 Nov 2014 18:42:17 +0100
MIME-Version: 1.0
Content-Transfer-Encoding: Quoted-Printable
From: "Robert Scholte" <rfscholte@apache.org>
Message-ID: <op.xp1p28hrkdkhrr@robertscholte.dynamic.ziggo.nl>
In-Reply-To: <4D781E28644D7B46878137FBCBC852F01269EB@gf0vswex001p.corp.int>
User-Agent: Opera Mail/12.17 (Win32)

Op Thu, 27 Nov 2014 14:12:58 +0100 schreef Dutz, Christofer  =

<C.Dutz@ing-diba.de>:

> Hi,
>
> I just ran into a problem I was having a few times now with the releas=
e  =

> plugin. This time the usage scenario is different, but the code needed=
  =

> to be changed is still the same.
>
> This time I am helping migrate a large set of projects from Ant to  =

> Maven. As this involves a large amount of training the transition is  =

> done project by project.
> Currently as a first step all projects are changed to deploy SNAPSHOT =
 =

> and release versions to Nexus instead of deploying to an Ivy repo. For=
  =

> this all Ant builds were extended to produce and deploy artifacts  =

> useable by Maven and the Ant builds are configured to use Nexus instea=
d  =

> of Ivy.
>
> Now whenever a release is done there actually have to be two releases =
 =

> performed. One Ant and one Maven release. For the Maven part we wanted=
  =

> to use the default release plugin. For this we are planning on providi=
ng  =

> the release and development version for each artifact as described in =
 =

> this article:  =

> http://maven.apache.org/maven-release/maven-release-plugin/examples/no=
n-interactive-release.html
> For the Ant part we have created an Ant task that updates the ivy.xml =
to  =

> the correct versions, which understands the same syntax of providing d=
ev  =

> and rel versions as that of the Maven release plugin.
>
> Now the problem is that AbstractRewritePomsPhase only seems to process=
  =

> the version numbers of artifacts that are in the reactor:
>
> https://github.com/apache/maven-release/blob/trunk/maven-release-manag=
er/src/main/java/org/apache/maven/shared/release/phase/AbstractRewritePo=
msPhase.java
>
> Wouldn't it be possible to leave the version map the way it is, withou=
t  =

> filtering anything out? If a user provides the rel version and the dev=
  =

> version for an artifact I would assume that he actually should have a =
 =

> reason for doing this. This behaviour is causing quite some difficulti=
es  =

> here.
>
This is probably the most tricky part. I'd like to keep the process as  =

simple as possible with a minimum of a failing release. Since we only ha=
ve  =

full control over the versions of the current (multimodule) project, the=
se  =

are safe to map. *If* we allow versions of other dependencies as well,  =

then these should be checked as well, both release and development versi=
on.
The maven-release-plugin is just too important to allow these kind of  =

manual input where the changes of failure are that big.

I've started with the introduction of a VersionPolicy[1] in the  =

maven-release-plugin. It's not yet exposed, so you can't specify your ow=
n  =

policies yet. But this would give you the opportunity to select the  =

versions automatically instead of specifying it from cmdline (which is  =

doomed to fail every now and than).

So here you could help and see if this concept works for you as well.

regards,
Robert

[1]  =

http://maven.apache.org/maven-release/maven-release-api/apidocs/index.ht=
ml

> I would be glad to assitst in finding a good solution for this, if the=
re  =

> is no chance in getting this changed, we will propably have to work on=
 a  =

> custom version oft he release plugin, which I would really like to avo=
id.
>
> Chris
>
> --
>
> ING-DiBa AG, Frankfurt am Main. Registernummer HRB 7727, Handelsregist=
er
> Amtsgericht Frankfurt am Main. Vorstand: Roland Boekhout (Vorsitzender=
),
> Herbert Willius (stellv. Vorsitzender), Bernd Geilen, Katharina  =

> Herrmann, Martin Krebs, Remco Nieland.
> Aufsichtsrat: Ben Tellings (Vorsitzender)
>
> Diese E-Mail enth=E4lt vertrauliche und/oder rechtlich gesch=FCtzte
> Informationen. Wenn Sie nicht der richtige Adressat sind oder diese
> E-Mail irrt=FCmlich erhalten haben, informieren Sie bitte sofort den
> Absender und vernichten Sie diese Mail.
> Das unerlaubte Kopieren sowie die unbefugte Weitergabe dieser Mail ist=

> nicht gestattet.
>
> This e-mail may contain confidential and/or privileged information. If=

> you are not the intended recipient (or have received this e-mail in
> error) please notify the sender immediately and destroy this e-mail. A=
ny
> unauthorized copying, disclosure or distribution of the material in th=
is
> e-mail is strictly forbidden.
>
> ING-DiBa AG, Frankfurt am Main. Registernummer HRB 7727, Handelsregist=
er
> Amtsgericht Frankfurt am Main. Vorstand: Roland Boekhout (Vorsitzender=
),
> Bernd Geilen, Katharina Herrmann, Martin Krebs, Remco Nieland.
> Aufsichtsrat: Ben Tellings (Vorsitzender)
>
> Diese E-Mail enth=E4lt vertrauliche und/oder rechtlich gesch=FCtzte
> Informationen. Wenn Sie nicht der richtige Adressat sind oder diese
> E-Mail irrt=FCmlich erhalten haben, informieren Sie bitte sofort den
> Absender und vernichten Sie diese Mail.
> Das unerlaubte Kopieren sowie die unbefugte Weitergabe dieser Mail ist=

> nicht gestattet.
>
> This e-mail may contain confidential and/or privileged information. If=

> you are not the intended recipient (or have received this e-mail in
> error) please notify the sender immediately and destroy this e-mail. A=
ny
> unauthorized copying, disclosure or distribution of the material in th=
is
> e-mail is strictly forbidden.

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


