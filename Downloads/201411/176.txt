From users-return-137748-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Nov 14 18:58:05 2014
Return-Path: <users-return-137748-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8533AFB22
	for <apmail-maven-users-archive@www.apache.org>; Fri, 14 Nov 2014 18:58:05 +0000 (UTC)
Received: (qmail 51181 invoked by uid 500); 14 Nov 2014 18:58:03 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 51092 invoked by uid 500); 14 Nov 2014 18:58:03 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 51081 invoked by uid 99); 14 Nov 2014 18:58:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 18:58:03 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gcjtmu-turbine-maven-user-846@m.gmane.org designates 80.91.229.3 as permitted sender)
Received: from [80.91.229.3] (HELO plane.gmane.org) (80.91.229.3)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 18:57:58 +0000
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <gcjtmu-turbine-maven-user-846@m.gmane.org>)
	id 1XpM1l-0000tN-33
	for users@maven.apache.org; Fri, 14 Nov 2014 19:55:25 +0100
Received: from hsi-kbw-046-005-167-099.hsi8.kabel-badenwuerttemberg.de ([46.5.167.99])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <users@maven.apache.org>; Fri, 14 Nov 2014 19:55:25 +0100
Received: from joerg.schaible by hsi-kbw-046-005-167-099.hsi8.kabel-badenwuerttemberg.de with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <users@maven.apache.org>; Fri, 14 Nov 2014 19:55:25 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: users@maven.apache.org
From: =?UTF-8?B?SsO2cmc=?= Schaible <joerg.schaible@gmx.de>
Subject: Re: Change dependency version through property
Date: Fri, 14 Nov 2014 19:55:12 +0100
Lines: 68
Message-ID: <m45j6h$g3q$1@ger.gmane.org>
References: <CAGr9p8CxcuY7L5UQkRAi2kSBLAYR4eDNkmshvebgp5fiGYDHCQ@mail.gmail.com>
Reply-To: joerg.schaible@gmx.de
Mime-Version: 1.0
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: 8Bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: hsi-kbw-046-005-167-099.hsi8.kabel-badenwuerttemberg.de
User-Agent: KNode/4.12.5
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Robert,

Robert Metzger wrote:

> Hi,
> 
> I'm a developer at the Apache Flink (incubating) project. I'm trying to
> pass the version of a dependency using a property from the command line to
> the binary build. But it seems that the version I've set is not respected
> everywhere.
> 
> 
> We have the following setup:
> - flink-parent
>    - flink-core
>    - ... more modules ...
>    - flink-yarn
>    - flink-dist
> 
> The "flink-yarn" module (and others) have dependencies to Apache Hadoop.
> We have a property (called hadoop.version) to have one place for setting
> the Hadoop version. The default Hadoop version 2.2.0.
> 
> The "flink-dist" module is creating the binary release for Flink. It is
> using the maven-assembly-plugin for that. All jars we depend on are placed
> in the "lib" directory.
> The "flink-dist" module has most of our modules (also the flink-yarn)
> module as a dependency so that we can use the modules in the assembly.
> 
> 
> 
> What I'm trying to do is building Flink for a different Hadoop version,
> say "2.2.0-cdh5.0.0-beta-2". Therefore, I'm passing this version as
> "-Dhadoop.version=2.2.0-cdh5.0.0-beta-2".
> 
> However, some files from Hadoop "2.2.0" end up in the "lib" directory.
> 
> mvn dependency:tree reveals for "flink-dist":
> 
> [INFO] +- org.apache.flink:flink-yarn:jar:0.8-incubating-SNAPSHOT:compile
> [INFO] |  +- org.apache.hadoop:hadoop-yarn-client:jar:2.2.0:compile
> [INFO] |  |  +- org.apache.hadoop:hadoop-yarn-api:jar:2.2.0:compile
> [INFO] |  |  +- org.apache.hadoop:hadoop-yarn-common:jar:2.2.0:compile
> 
> however, for "flink-yarn" the versions are correct:
> 
> [INFO] +-
> org.apache.hadoop:hadoop-yarn-client:jar:2.2.0-cdh5.0.0-beta-2:compile
> [INFO] |  +- commons-logging:commons-logging:jar:1.1.3:compile
> [INFO] |  +- commons-lang:commons-lang:jar:2.6:compile
> 
> Here is the full dependency:tree output:
> https://gist.github.com/rmetzger/70c5f35d4cfd06a91169
> 
> 
> How can I create builds for different Hadoop versions using Maven?

General rule:
- don't use a version tag for direct dependencies
- use a common parent for all modules with
  - a dependency management section for any dependency you want to control
  - use properties for these versions

These properties can be overwritten from command line or setting the 
property again explicitly in a module.

Cheers,
JÃ¶rg


---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


