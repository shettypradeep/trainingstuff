From users-return-137877-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Nov 28 17:46:05 2014
Return-Path: <users-return-137877-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2B815C7D5
	for <apmail-maven-users-archive@www.apache.org>; Fri, 28 Nov 2014 17:46:05 +0000 (UTC)
Received: (qmail 49598 invoked by uid 500); 28 Nov 2014 17:46:03 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 49512 invoked by uid 500); 28 Nov 2014 17:46:03 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 49501 invoked by uid 99); 28 Nov 2014 17:46:03 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Nov 2014 17:46:03 +0000
Received: from robertscholte.dynamic.ziggo.nl (5248749D.cm-4-1b.dynamic.ziggo.nl [82.72.116.157])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 057B41A0019
	for <users@maven.apache.org>; Fri, 28 Nov 2014 17:45:46 +0000 (UTC)
Content-Type: text/plain; charset=iso-8859-15; format=flowed; delsp=yes
To: "Maven Users List" <users@maven.apache.org>
Subject: Re: release plugin issue
References: <OFA2E1BE63.3A77C845-ON85257D9D.00817D6E-85257D9D.008354E4@belden.com>
Date: Fri, 28 Nov 2014 18:45:58 +0100
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
From: "Robert Scholte" <rfscholte@apache.org>
Message-ID: <op.xp1qawdgkdkhrr@robertscholte.dynamic.ziggo.nl>
In-Reply-To: <OFA2E1BE63.3A77C845-ON85257D9D.00817D6E-85257D9D.008354E4@belden.com>
User-Agent: Opera Mail/12.17 (Win32)

Op Fri, 28 Nov 2014 00:54:29 +0100 schreef  
<Alejandro.Endo@grassvalley.com>:

> I'm using the release-plugin v2.5.1 and I'm often encountering two
> recurring stories with failed releases
>
> 1) Now the release can fail due to errors in the javadoc. This is not a
> problem, the problem is that IF there are problems in the javadoc the
> release doesn't complete but the two commits and the tag has been done so
> after fixing the javadoc I need to reset the git repo to right before the
> failed released AND I have to remove the tag to try again. I am releasing
> from jenkins so the resume flag is set to false. if something fails we
> start from the beginning, which makes sense in a build server IMO. My
> suggestion here would be to generate all those artifacts (javadoc and
> source) before committing and tagging the code, that way if they fail,  
> the
> repo is not in an invalid state. Another option would be improvement #2
>
> 2) Very often the dryRun succeeds but the real release fails, to the  
> point
> where the dryRun is meaningless. This defeats the whole purpose of a
> dry-run. The problem is that the dry run is over simplified. For example,
> again, if there are javadoc problems they won't be spotted because the
> dry-run doesn't run javadoc generation. Anything that's part of the real
> build should be run on the dry-run except for things that make persistent
> changes. Another problem I encounter often is that the real release fails
> because the tag already exists in SCM (leftover from a previous failed
> release). This should also be validated by the dryRun. If a real release
> can fail because a tag is already present then the dry run should fail if
> the tag is already present
>
> What do you guys think? If these points are considered valid I will open  
> a
> ticket at least for the second one, which is the worse of the two
>

It's also possible to do a dryrun for the release:perform since version  
2.3 [1]
That's still not the default of the jenkins m2-release-plugin, but it  
works.

Robert

[1] https://jira.codehaus.org/browse/MRELEASE-736

>
> Alejandro Endo | Software Designer/Concepteur de logiciels
>
>
> DISCLAIMER:
> Privileged and/or Confidential information may be contained in this
> message. If you are not the addressee of this message, you may not
> copy, use or deliver this message to anyone. In such event, you
> should destroy the message and kindly notify the sender by reply
> e-mail. It is understood that opinions or conclusions that do not
> relate to the official business of the company are neither given
> nor endorsed by the company.
> Thank You.

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


