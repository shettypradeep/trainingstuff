From users-return-137673-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Sat Nov  1 07:48:30 2014
Return-Path: <users-return-137673-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 71F3617A23
	for <apmail-maven-users-archive@www.apache.org>; Sat,  1 Nov 2014 07:48:30 +0000 (UTC)
Received: (qmail 68575 invoked by uid 500); 1 Nov 2014 07:48:28 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 68490 invoked by uid 500); 1 Nov 2014 07:48:28 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 68478 invoked by uid 99); 1 Nov 2014 07:48:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Nov 2014 07:48:27 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephen.alan.connolly@gmail.com designates 209.85.214.169 as permitted sender)
Received: from [209.85.214.169] (HELO mail-ob0-f169.google.com) (209.85.214.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Nov 2014 07:48:24 +0000
Received: by mail-ob0-f169.google.com with SMTP id va2so6958030obc.14
        for <users@maven.apache.org>; Sat, 01 Nov 2014 00:48:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ZDLDN/edcSs7C7XkemXQijmVBRY6RrxBMXSU6C5S9Ec=;
        b=WhWfpO2BcRW8pjd0KvQ2fKciIuKOtRj/P8pVLFe39neMiMjS2l0uaOahSdbolQxEve
         m/0LwjBAReP1q9h48gm9Q/06uyKzlub20pEaHK9bNz/V1uf9sVGurhLGCi8+fcEJcw/v
         Phc/0bPak4ohEDu4jPndy6GzlNmvWfz4yAlADJI9qL4kok9RtNCP31zXHrKdgKpIOiGD
         ysF5TzXJpeXxd0K6w2Gpa75KXfy1LFeY6qxEFjqfXKca/illypaP6zH5WbE23oAxc8W1
         JmmBCB9+5sngurLwPUTXpEwhmPO8ePG4NHhlmjULoF/1+bo3Lfw/ofUWzsgTg5xd1JeG
         FBew==
MIME-Version: 1.0
X-Received: by 10.202.199.88 with SMTP id x85mr603157oif.61.1414828083319;
 Sat, 01 Nov 2014 00:48:03 -0700 (PDT)
Received: by 10.60.116.39 with HTTP; Sat, 1 Nov 2014 00:48:03 -0700 (PDT)
In-Reply-To: <op.xoltlfy3kdkhrr@robertscholte>
References: <20141031172652.00002dfe.ecki@zusammenkunft.net>
	<op.xoltlfy3kdkhrr@robertscholte>
Date: Sat, 1 Nov 2014 07:48:03 +0000
Message-ID: <CA+nPnMy0QBpTSU2MrLBiFQnVcknYrTy+hkJ0wL03LOEkrxiO1g@mail.gmail.com>
Subject: Re: maven-release got stuck when tag exists with released version in pom
From: Stephen Connolly <stephen.alan.connolly@gmail.com>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=001a1134ed1a5318080506c755a7
X-Virus-Checked: Checked by ClamAV on apache.org

--001a1134ed1a5318080506c755a7
Content-Type: text/plain; charset=UTF-8

On Friday, October 31, 2014, Robert Scholte <rfscholte@apache.org> wrote:

> Hi,
>
> see MRELEASE-165 (release:prepare should fail if the tag already exists)[1]
> The main reason why it is still not implemented, is that this must be
> solved in the SCM project. If we know how to do a valid(!) check of the
> existence of a tag for the scm providers, we could start implementing it.


Actually we need only have the SCM api return a tristate:

Exists
Doesn't exist
Don't know

Then the default impl can return don't know, and the release plugin can
implement the check via the SCM API immediately... That makes the problem
just belong to the SCM API implementations

;-)


> My experience is, is that these kind of issues only happen at the start of
> a new project. Once it works, it'll all stay fine.
>
> About the rollback: it's already there: release:rollback[2]
> And it works just as you described. However, if you do the release with
> the Jenkins m2-release-plugin, that plugin in still missing the rollback
> option[3].
>
> thanks,
> Robert
>
> [1] https://jira.codehaus.org/browse/MRELEASE-165
> [2] http://maven.apache.org/maven-release/maven-release-plugin/
> rollback-mojo.html
> [3] https://issues.jenkins-ci.org/browse/JENKINS-8038
>
> Op Fri, 31 Oct 2014 17:26:52 +0100 schreef Bernd Eckenfels <
> ecki@zusammenkunft.net>:
>
>  Hello,
>>
>> one thing which bites me quite regularly with the maven release plugin
>> is the fact, that it will update the POMs to the release version then
>> commit them and then tag them. If the tagging fails (especially because
>> the tag existed already) then it will leave the head on a released
>> version number.
>>
>> This is in my case a problem as I have to go through a gerrit release
>> to change it to a snapshot version to try again.
>>
>> A good improvement would be to first check the existence of the tag.
>> This would not cover all error cases but the most common.
>>
>> Another option (or in addition to that), a rollback action would be to
>> actually commit the updated POM with the old snapshot version again?
>>
>> (just to warn people, in my case if an integration build is triggert on
>> the master which has configured jenkins to deploy (normally the
>> snapshots) it will happyly deply the released version).
>>
>> Gruss
>> Bernd
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
>> For additional commands, e-mail: users-help@maven.apache.org
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> For additional commands, e-mail: users-help@maven.apache.org
>
>

-- 
Sent from my phone

--001a1134ed1a5318080506c755a7--

