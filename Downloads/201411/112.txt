From users-return-137875-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Nov 28 15:33:40 2014
Return-Path: <users-return-137875-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BB781C419
	for <apmail-maven-users-archive@www.apache.org>; Fri, 28 Nov 2014 15:33:40 +0000 (UTC)
Received: (qmail 29582 invoked by uid 500); 28 Nov 2014 15:33:39 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 29492 invoked by uid 500); 28 Nov 2014 15:33:39 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 29478 invoked by uid 99); 28 Nov 2014 15:33:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Nov 2014 15:33:38 +0000
X-ASF-Spam-Status: No, hits=-0.1 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of prvs=3409bfbf18=Alejandro.Endo@grassvalley.com designates 12.161.118.90 as permitted sender)
Received: from [12.161.118.90] (HELO mx1.belden.com) (12.161.118.90)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Nov 2014 15:33:12 +0000
X-AuditID: 0a01015a-b7f628e000000d19-c6-547895b613c0
Received: from bdcnotes1.belden.com ( [10.1.1.71])
	by mx1.belden.com (Service Ready) with SMTP id 99.58.03353.6B598745; Fri, 28 Nov 2014 10:33:10 -0500 (EST)
In-Reply-To: <CA+nPnMxt-=3szXek7Bky2Viv5oLCiWOQiTJGBYm95JpO=pBcKQ@mail.gmail.com>
References: <OFA2E1BE63.3A77C845-ON85257D9D.00817D6E-85257D9D.008354E4@belden.com> <CA+nPnMxt-=3szXek7Bky2Viv5oLCiWOQiTJGBYm95JpO=pBcKQ@mail.gmail.com>
To: "Maven Users List" <users@maven.apache.org>
MIME-Version: 1.0
Subject: Re: release plugin issue
X-KeepSent: F53CAD72:C800FA64-85257D9E:00544C06;
 type=4; name=$KeepSent
X-Mailer: Lotus Notes Release 8.5.3FP2 SHF99 September 04, 2012
From: Alejandro.Endo@grassvalley.com
Message-ID: <OFF53CAD72.C800FA64-ON85257D9E.00544C06-85257D9E.00556FD6@belden.com>
Date: Fri, 28 Nov 2014 10:33:12 -0500
X-MIMETrack: Serialize by Router on BDCNotes1/BeldenCDT(Release 9.0.1FP2|August  03, 2014) at
 11/28/2014 10:33:11 AM,
	Serialize complete at 11/28/2014 10:33:11 AM
Content-Type: multipart/alternative; boundary="=_alternative 00556F5985257D9E_="
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFnrDIsWRmVeSWpSXmKPExsXCxcjorrttakWIQV+/tsWjrdcZHRg92p8K
	BTBGNTDaJCWWlAVnpufp29kk5uXllySWpCqkpBYn2yo5peakpOYpuGQWJ+ckZuamFul6Bvvr
	WliYWiopZKbYKhkpKRTkJCan5qbmldgqJRYUpOalKNlxKWAAG6CyzDyF1Lzk/JTMvHRbpdAQ
	N10LJTsXz2DnhFbWjObWVqaCA34VT6bNYm9gXOzQxcjJISFgIrF522NGCFtM4sK99WxdjFwc
	QgLzGSUu3rvLBJLgFAiUWLLsMytEYjqjxLk9B9hAEiIC+hLLDt5nAbF5BQQlTs58AmYLCyhK
	HL+6nBViqqdE6+Nd7BC2vcT3Rx/AatgEVCSm/b3DCNEbJNFwcCpYPYuAqsSHyWeZQZZJCCxj
	lFg04zbQFRwczAIBEmf+a01g5J+FZN0shAxImFlAR+LEqmPMELa2xKIrP9kXMLKsYuTLrTDU
	SwIHtV5yfu4mRkiMRe1gfNqicIhRgINRiYeXx6wiRIg1say4MvcQowQHs5IIb3oJUIg3JbGy
	KrUoP76oNCe1+BBjENCVE5mluJPzgfGfVxJvbGBAJEdJnPfUpZwQIYF0YALITk0tSC2CGcrE
	wQmylEtKpBgYw6lFiaUlGfGgZBNfDEw3Ug2MVm5/2hhbX8yImMDHdvUF5zvn3w6df1h+L2c2
	kDf41n6B+f/iH2/SP31fdYh7diV/h8nyIuszWT+sYv4XqbaG5+1q00/9xnM96EzVpClfxGZV
	HrhuGm274nyztd5Tzq/d526y1buV+xfPbvmkLj63Ol31wsJdKxj8Jz1/4fuu+vKLo2dFhZM8
	lFiKMxINtZiLihMBuF0k4P8CAAA=
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 00556F5985257D9E_=
Content-Type: text/plain; charset="US-ASCII"

Hi Stephen,

We are not using any preparationGoals. So it's not that my preparation 
goals are not mimicking a full release. It is that the default dry run is 
not mimicking a default full release. 
We are talking about completely vanilla release:prepare. The only 
non-default value is the resume=false.
And about the tradeoff, I see your point, but IMO the defaults should not 
make those tradeoff decisions for you. The default should be the safest 
setting, not the fastest

Here are the two goals we run for full and for dry-run respectively

-Dresume=false release:prepare release:perform
-Dresume=false -DdryRun=true release:prepare

I will try to play with the preparationGoals, but again, the default 
behaviour seems flawed to me

Thanks for your help


Alejandro Endo | Software Designer/Concepteur de logiciels 





From:   Stephen Connolly <stephen.alan.connolly@gmail.com>
To:     Maven Users List <users@maven.apache.org>, 
Date:   2014-11-27 07:44 PM
Subject:        Re: release plugin issue



On Thursday, 27 November 2014, <Alejandro.Endo@grassvalley.com> wrote:

> I'm using the release-plugin v2.5.1 and I'm often encountering two
> recurring stories with failed releases
>
> 1) Now the release can fail due to errors in the javadoc. This is not a
> problem, the problem is that IF there are problems in the javadoc the
> release doesn't complete but the two commits and the tag has been done 
so
> after fixing the javadoc I need to reset the git repo to right before 
the
> failed released AND I have to remove the tag to try again. I am 
releasing
> from jenkins so the resume flag is set to false. if something fails we
> start from the beginning, which makes sense in a build server IMO. My
> suggestion here would be to generate all those artifacts (javadoc and
> source) before committing and tagging the code, that way if they fail, 
the
> repo is not in an invalid state. Another option would be improvement #2


It sounds like your preparationGoals are not mimicing a full release...
Very often people set them up that way because they are willing to trade
off a failed perform against a faster prepare.

Typically if you are doing the trade-off you go all the way and make
preparationGoals be `initialize`... Sure version numbers are free don't 
you
know


>
> 2) Very often the dryRun succeeds but the real release fails, to the 
point
> where the dryRun is meaningless. This defeats the whole purpose of a
> dry-run. The problem is that the dry run is over simplified. For 
example,
> again, if there are javadoc problems they won't be spotted because the
> dry-run doesn't run javadoc generation. Anything that's part of the real
> build should be run on the dry-run except for things that make 
persistent
> changes.


Again I wonder have you (or somebody else) tweaked the defaults


> Another problem I encounter often is that the real release fails
> because the tag already exists in SCM (leftover from a previous failed
> release). This should also be validated by the dryRun.


Or by prepare before it starts the build... I think that should be a valid
complaint


>  If a real release
> can fail because a tag is already present then the dry run should fail 
if
> the tag is already present
>
> What do you guys think? If these points are considered valid I will open 
a
> ticket at least for the second one, which is the worse of the two
>
>
> Alejandro Endo | Software Designer/Concepteur de logiciels
>
>
> DISCLAIMER:
> Privileged and/or Confidential information may be contained in this
> message. If you are not the addressee of this message, you may not
> copy, use or deliver this message to anyone. In such event, you
> should destroy the message and kindly notify the sender by reply
> e-mail. It is understood that opinions or conclusions that do not
> relate to the official business of the company are neither given
> nor endorsed by the company.
> Thank You.
>


-- 
Sent from my phone


DISCLAIMER:
Privileged and/or Confidential information may be contained in this
message. If you are not the addressee of this message, you may not
copy, use or deliver this message to anyone. In such event, you
should destroy the message and kindly notify the sender by reply
e-mail. It is understood that opinions or conclusions that do not
relate to the official business of the company are neither given
nor endorsed by the company.
Thank You.

--=_alternative 00556F5985257D9E_=--

