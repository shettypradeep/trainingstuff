From users-return-136352-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Tue May 13 22:38:41 2014
Return-Path: <users-return-136352-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 48F4A112D0
	for <apmail-maven-users-archive@www.apache.org>; Tue, 13 May 2014 22:38:41 +0000 (UTC)
Received: (qmail 40144 invoked by uid 500); 13 May 2014 22:11:56 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 40070 invoked by uid 500); 13 May 2014 22:11:56 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 40062 invoked by uid 99); 13 May 2014 22:11:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2014 22:11:56 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [74.125.82.181] (HELO mail-we0-f181.google.com) (74.125.82.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2014 22:11:50 +0000
Received: by mail-we0-f181.google.com with SMTP id w61so1077416wes.12
        for <users@maven.apache.org>; Tue, 13 May 2014 15:11:29 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=VthnmBzVXldd6hT4alfZsttRk0lozcCHU4VjAG8Vce4=;
        b=aoDRFd/ACTytBtabhqAveycEYZXhX79KiQghURXMeSnfzLfimpNztyTjva65KtqA72
         VBPb+rilWGVjS+4ZziS7DoEGQPbY+DnXPx6UuqVqbQlOBZrx+fQm7RxMxOPbrxOaqDP4
         7oZYtwQqjNEtlSlBFCUVsiJpuG3Af/hOl+WOrQ25Te9ICnuym4xHvoXVW9Z/JXp7UgDZ
         tCDR5br/NoRxQyrmJM6RrkR0u+/Jg6nQsXgd/OrCU2koRnXi+1Q471W6CzBY/11mhA3q
         MdA4LKM+Kpxsgd5W7ys3sroUoj3xXBMOcQrkYFQt++KlRRGZjTWQJ86+H6act4+Z8y3F
         GIkQ==
X-Gm-Message-State: ALoCoQmQGiEP3sobLNwa+fXyLZfjm6RS5xNLbGT2bcaGHgSw5O3GIm9m/M07Sa/J26ryqP0oKmB0
MIME-Version: 1.0
X-Received: by 10.180.92.69 with SMTP id ck5mr340036wib.15.1400019089132; Tue,
 13 May 2014 15:11:29 -0700 (PDT)
Received: by 10.216.235.4 with HTTP; Tue, 13 May 2014 15:11:29 -0700 (PDT)
X-Originating-IP: [101.165.250.71]
In-Reply-To: <CAEBcyzoHDucu-yEWCg7HDe1XW46QO8LZvtYcyYKp9Lacib9GjA@mail.gmail.com>
References: <CAEBcyzoHDucu-yEWCg7HDe1XW46QO8LZvtYcyYKp9Lacib9GjA@mail.gmail.com>
Date: Wed, 14 May 2014 08:11:29 +1000
Message-ID: <CAEBcyzrZ+dq-GGFsTDSmDawAn+k9WDrfeumRUmj=qaCeowXApg@mail.gmail.com>
Subject: Re: Wagon extensions not available from AbstractMavenLifecycleParticipant
 or maven-dependency-tree?
From: William Ferguson <william.ferguson@xandar.com.au>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=20cf306847397ca2ef04f94f58b4
X-Virus-Checked: Checked by ClamAV on apache.org

--20cf306847397ca2ef04f94f58b4
Content-Type: text/plain; charset=UTF-8

Anyone?


On Mon, May 12, 2014 at 8:58 PM, William Ferguson <
william.ferguson@xandar.com.au> wrote:

> I have a MavenLifecycleParticipant in my plugin. It uses
> maven-dependency-tree to resolve some deps that we need to do extra
> processing on. It works fine if the deps are in the local repo.
>
> But if the s3 Wagon is defined in the project along with a dependency from
> the s3 bucket, then the following debug log shows that
> DependencyGraphBuilder of maven-dependency-tree can't resolve the s3 wagon,
> and the dependency is not resolved now or later in the build, so
> compilation fails.
>
> NB If I remove the MavenLifecycleParticipant then the dep is resolved via
> the S3 Wagon.
>
> Q1) When are the Wagons configured? Shouldn't it be prior to
> MavenLifecycleParticipant being called?
> Q2) How can I get the DependencyGraphBuilder to resolve the s3 artifact
> from within the MavenLifecycleParticipant?
>
>
> Here is the stacktrace:
>
> [DEBUG] Could not find metadata
> com.viewpagerindicator:viewpagerindicator:2.4.2-SNAPSHOT/maven-metadata.xml
> in local (D:\dev\maven-local-repository)
> [DEBUG] java.util.NoSuchElementException
>       role: org.apache.maven.wagon.Wagon
>   roleHint: s3
> org.codehaus.plexus.component.repository.exception.ComponentLookupException:
> java.util.NoSuchElementException
>       role: org.apache.maven.wagon.Wagon
>   roleHint: s3
> at
> org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:264)
>  at
> org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:252)
> at
> org.eclipse.aether.internal.connector.wagon.PlexusWagonProvider.lookup(PlexusWagonProvider.java:33)
>  at
> org.eclipse.aether.connector.wagon.WagonRepositoryConnector.lookupWagon(WagonRepositoryConnector.java:337)
> at
> org.eclipse.aether.connector.wagon.WagonRepositoryConnector.<init>(WagonRepositoryConnector.java:157)
>  at
> org.eclipse.aether.connector.wagon.WagonRepositoryConnectorFactory.newInstance(WagonRepositoryConnectorFactory.java:159)
> at
> org.eclipse.aether.internal.impl.DefaultRepositoryConnectorProvider.newRepositoryConnector(DefaultRepositoryConnectorProvider.java:139)
>  at
> org.eclipse.aether.internal.impl.DefaultMetadataResolver$ResolveTask.run(DefaultMetadataResolver.java:613)
> at
> org.eclipse.aether.util.concurrency.RunnableErrorForwarder$1.run(RunnableErrorForwarder.java:67)
>  at
> org.eclipse.aether.internal.impl.DefaultMetadataResolver$1.execute(DefaultMetadataResolver.java:540)
> at
> org.eclipse.aether.internal.impl.DefaultMetadataResolver.resolve(DefaultMetadataResolver.java:395)
>  at
> org.eclipse.aether.internal.impl.DefaultMetadataResolver.resolveMetadata(DefaultMetadataResolver.java:218)
> at
> org.apache.maven.repository.internal.DefaultVersionResolver.resolveVersion(DefaultVersionResolver.java:250)
>  at
> org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom(DefaultArtifactDescriptorReader.java:284)
> at
> org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.readArtifactDescriptor(DefaultArtifactDescriptorReader.java:217)
>  at
> org.eclipse.aether.internal.impl.DefaultDependencyCollector.process(DefaultDependencyCollector.java:461)
> at
> org.eclipse.aether.internal.impl.DefaultDependencyCollector.collectDependencies(DefaultDependencyCollector.java:261)
>  at
> org.eclipse.aether.internal.impl.DefaultRepositorySystem.collectDependencies(DefaultRepositorySystem.java:317)
> at
> org.apache.maven.project.DefaultProjectDependenciesResolver.resolve(DefaultProjectDependenciesResolver.java:159)
>  at
> org.apache.maven.shared.dependency.graph.internal.Maven31DependencyGraphBuilder.resolveDependencies(Maven31DependencyGraphBuilder.java:113)
> at
> org.apache.maven.shared.dependency.graph.internal.Maven31DependencyGraphBuilder.buildDependencyGraph(Maven31DependencyGraphBuilder.java:99)
>  at
> org.apache.maven.shared.dependency.graph.internal.DefaultDependencyGraphBuilder.buildDependencyGraph(DefaultDependencyGraphBuilder.java:74)
> at
> com.jayway.maven.plugins.android.common.DependencyResolver.getProjectDependenciesFor(DependencyResolver.java:54)
>  at
> com.jayway.maven.plugins.android.phase_prebuild.ClasspathModifierLifecycleParticipant.afterProjectsRead(ClasspathModifierLifecycleParticipant.java:78)
> at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:317)
>  at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:155)
> at org.apache.maven.cli.MavenCli.execute(MavenCli.java:584)
>  at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:213)
> at org.apache.maven.cli.MavenCli.main(MavenCli.java:157)
>  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> at
> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
>  at
> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
> at java.lang.reflect.Method.invoke(Method.java:606)
>  at
> org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
> at
> org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
>  at
> org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
> at
> org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
>
>
> William
>

--20cf306847397ca2ef04f94f58b4--

