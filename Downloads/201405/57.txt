From users-return-136460-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Thu May 29 23:53:27 2014
Return-Path: <users-return-136460-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2C0B710B15
	for <apmail-maven-users-archive@www.apache.org>; Thu, 29 May 2014 23:53:27 +0000 (UTC)
Received: (qmail 17439 invoked by uid 500); 29 May 2014 23:53:25 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 17355 invoked by uid 500); 29 May 2014 23:53:25 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 17347 invoked by uid 99); 29 May 2014 23:53:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2014 23:53:25 +0000
X-ASF-Spam-Status: No, hits=2.2 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ljnelson@gmail.com designates 209.85.192.49 as permitted sender)
Received: from [209.85.192.49] (HELO mail-qg0-f49.google.com) (209.85.192.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2014 23:53:22 +0000
Received: by mail-qg0-f49.google.com with SMTP id a108so3193679qge.22
        for <users@maven.apache.org>; Thu, 29 May 2014 16:52:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=iid40Uff79hMKvw5qOlORKjB3zv5Bx/9XQL5z/l+NFs=;
        b=K7Wk4+09MsBxnGYCZnQ1kQAFopezjkEKYye285+MmwTE9E6fedFZoWbT2DvTVMQbB2
         59Q6UiamKVsU063d0dxqrNXqnuUy4o+KAVYTOS6izkqrsrzzCVXJdh8PxvDp6/sBmeFa
         Gy7x+JE7VQxyJMPwtSHKWEJb8kxiMlN2HYhpTZn8RqZ0fyiLe6dgbeWaHbsRqvDaJKva
         e9qiSBvhtzofcgMyBO9IlyzmWMvGWpLAFjOWFC3PVDUv1EA6Lg4odeVKT2CeF39EAr82
         i10KtTzlB1fwZSJb5QXshDoUzACd/sf5uVzbMnLxpq79Nt18MuVP7+6U8vN5VtJ8ofi4
         5KPw==
MIME-Version: 1.0
X-Received: by 10.224.28.65 with SMTP id l1mr15658577qac.81.1401407578375;
 Thu, 29 May 2014 16:52:58 -0700 (PDT)
Received: by 10.96.46.137 with HTTP; Thu, 29 May 2014 16:52:58 -0700 (PDT)
Date: Thu, 29 May 2014 19:52:58 -0400
Message-ID: <CAHNdxunGiSpmRipvkmmhUzcnoW8tm4g6bod0oz+LX4AMO-x-3w@mail.gmail.com>
Subject: Maven release plugin having trouble with transformations?
From: Laird Nelson <ljnelson@gmail.com>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=001a11c2cd28e50cec04fa92a0dd
X-Virus-Checked: Checked by ClamAV on apache.org

--001a11c2cd28e50cec04fa92a0dd
Content-Type: text/plain; charset=UTF-8

This is very puzzling.

For years I've used the maven-release-plugin to automate my releases with
no trouble.

Now, on a particular project on GitHub, it is incorrectly transforming my
pom.xml and attempting to release the project as a snapshot.

The project is drop-dead brainlessly simple.  It is a single-module project.

The version is of the form 1.X.X-SNAPSHOT to start with.  Let's say it's at
1.0.3-SNAPSHOT.

I run mvn release:prepare and answer all the prompts with the defaults, as
I have for years.  It correctly surmises that the release version should be
1.0.3 and the new dev version should be 1.0.4-SNAPSHOT.

It then transforms the pom.xml (apparently), and (apparently) tags the repo.

When I investigate the release.properties file, it looks OK.

However, when I look at the contents of the tag just created, it has the
wrong version in it (1.0.3-SNAPSHOT).  I've tried this back to back, and
sometimes the tag has really random old versions: it's almost like the git
checkout command that the release plugin issues is checking out the wrong
branch or otherwise screwing things up--and all of a sudden, for no
discernible reason.

When I then do a release:perform, what gets mvn deploy'ed is a snapshot
version instead of the expected release version.  Investigating
target/checkout shows that the wrong branch--or perhaps the "right"
branch/tag with the wrong contents--is what was "perform"ed on.

This behavior has never happened to me before and I have not added any
settings or changed anything.  I'm using Maven 3.0.5, the release plugin
version 2.4.2 and Apple git 1.8.5.2.  Completely stumped.

This is really just a plea for help with shotgunning in the dark; has
anyone observed behavior remotely like this before?

Thanks,
Best,
Laird

-- 
http://about.me/lairdnelson

--001a11c2cd28e50cec04fa92a0dd--

