From users-return-137580-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Oct 17 20:06:32 2014
Return-Path: <users-return-137580-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4307B17B24
	for <apmail-maven-users-archive@www.apache.org>; Fri, 17 Oct 2014 20:06:32 +0000 (UTC)
Received: (qmail 35434 invoked by uid 500); 17 Oct 2014 20:06:29 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 35358 invoked by uid 500); 17 Oct 2014 20:06:29 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 35347 invoked by uid 99); 17 Oct 2014 20:06:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Oct 2014 20:06:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of christofer.dutz@c-ware.de designates 157.56.112.147 as permitted sender)
Received: from [157.56.112.147] (HELO emea01-am1-obe.outbound.protection.outlook.com) (157.56.112.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Oct 2014 20:06:02 +0000
Received: from AMSPR05MB0611.eurprd05.prod.outlook.com (10.242.15.149) by
 AMSPR05MB0610.eurprd05.prod.outlook.com (10.242.15.148) with Microsoft SMTP
 Server (TLS) id 15.0.1054.13; Fri, 17 Oct 2014 20:05:39 +0000
Received: from AMSPR05MB0611.eurprd05.prod.outlook.com ([10.242.15.149]) by
 AMSPR05MB0611.eurprd05.prod.outlook.com ([10.242.15.149]) with mapi id
 15.00.1054.004; Fri, 17 Oct 2014 20:05:39 +0000
From: Christofer Dutz <christofer.dutz@c-ware.de>
To: Maven Users List <users@maven.apache.org>
Subject: AW: AW: Strange Dependency problem after switching to Maven 3.1.1
Thread-Topic: AW: Strange Dependency problem after switching to Maven 3.1.1
Thread-Index: AQHP6gMrdmVV6BMAdUCscz/aCf3jDpw0N1s/gAAq3maAABSUgIAAO0JA
Date: Fri, 17 Oct 2014 20:05:38 +0000
Message-ID: <5807288db5d94993bc7d120976bc3486@AMSPR05MB0611.eurprd05.prod.outlook.com>
References: <1413548420515.75258@c-ware.de>,<1413548891289.97719@c-ware.de>,<1413558236574.98615@c-ware.de>
 <BLU172-W998EA26432D41BAF30E82AEA80@phx.gbl>
In-Reply-To: <BLU172-W998EA26432D41BAF30E82AEA80@phx.gbl>
Accept-Language: de-DE, en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-ms-exchange-transport-fromentityheader: Hosted
x-originating-ip: [84.150.104.32]
x-microsoft-antispam: BCL:0;PCL:0;RULEID:;SRVR:AMSPR05MB0610;
x-exchange-antispam-report-test: UriScan:;
x-forefront-prvs: 0367A50BB1
x-forefront-antispam-report: SFV:NSPM;SFS:(10019020)(6009001)(189002)(252514010)(243025005)(51704005)(199003)(31966008)(101416001)(2656002)(4396001)(87936001)(15202345003)(74316001)(99396003)(85852003)(120916001)(19580395003)(86362001)(92566001)(74482002)(46102003)(76176999)(19580405001)(54356999)(50986999)(40100003)(122556002)(15975445006)(108616004)(21056001)(97736003)(93886004)(66066001)(85306004)(64706001)(20776003)(33646002)(110136001)(75402003)(106356001)(229853001)(107046002)(105586002)(106116001)(107886001)(95666004)(76576001)(24736002);DIR:OUT;SFP:1102;SCL:1;SRVR:AMSPR05MB0610;H:AMSPR05MB0611.eurprd05.prod.outlook.com;FPR:;MLV:sfv;PTR:InfoNoRecords;MX:1;A:1;LANG:en;
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-OriginatorOrg: c-ware.de
X-Virus-Checked: Checked by ClamAV on apache.org

Well it seems that I'm still stuck. As even with different GAV it seems tha=
t the same rules apply :-(
The parent in this case doesn't seem to the the pom-parent, but the artifac=
t having a dependency on the child artifact.
So I guess Maven wants to figgure out what scope it should set for the chil=
dren based upon the scope of the parent.
So if it's a "normal" compile dependency, it leaves the child scope unchang=
ed, if the parent is "test" or "runtime" then it forces all children to be =
the same, which makes sense. But in the end there is that dredded "runtime"=
 if none of the others apply :-( I wonder why this wasn't a problem prior t=
o 3.1 ... at least with separate GAV I now have the same problem with Maven=
 3.0.5 ... at least I have consistency ;-)

I know that Maven isn't indended on being a pure Java build system, even if=
 it is mainly used for that. But I have successfully used it for building J=
ava, Flex, C++ and C# projects. Flex and all the C's support different link=
ing types while Java effectively supports only one. How would it be to make=
 Maven extendable with custom scopes? After all we are able to add custom t=
ypes. If I were to refactor flexmojos to support different types ("type=3Ds=
wc" =3D (default) statically-linked, "type=3Dswc-rsl" =3D dynamicly linked,=
 "type=3Dswc-include" =3D statically-linked with all classes embedded in th=
e output) ... would a this work?

Assuming I have a pom artifact A containing only one dependency:

        <dependency>
            <groupId>org.apache.flex.framework</groupId>
            <artifactId>B</artifactId>
            <version>4.13.0.20140701</version>
            <type>swc</type>
        </dependency>

And then in my module I have this:

        <dependency>
            <groupId>org.apache.flex.framework</groupId>
            <artifactId>B</artifactId>
            <version>4.13.0.20140701</version>
            <type>swc-rsl</type>
        </dependency>

        <dependency>
            <groupId>org.apache.flex.framework</groupId>
            <artifactId>A</artifactId>
            <version>4.13.0.20140701</version>
            <type>pom</type>
        </dependency>

Then would the type of "B" in the first dependency override the type of "B"=
 imported by the pom dependency to A? I doubt it ...
I would expect the resulting module to have dependencies to two artifacts "=
B", one of type "swc" and one of "swc-rsl".

I would really really like to sort out this problem and release Flexmojos w=
ith support of maven 3.1 and above ... currently we're stuck at 3.0.5 :-(

Chris


-----Urspr=FCngliche Nachricht-----
Von: Martin Gainty [mailto:mgainty@hotmail.com]=20
Gesendet: Freitag, 17. Oktober 2014 18:14
An: users@maven.apache.org
Betreff: RE: AW: Strange Dependency problem after switching to Maven 3.1.1





> From: christofer.dutz@c-ware.de
> To: users@maven.apache.org
> Subject: AW: Strange Dependency problem after switching to Maven 3.1.1
> Date: Fri, 17 Oct 2014 15:04:00 +0000
>=20
> Ok ... well think I have to answer my own question again :-(
>=20
> It took me about a day to debug this, but it seems the conflict resolutio=
n of Maven has changed.
> The thing is the framework:swc has the same name and groupId as the frame=
work:rb.swc ... so maven thinks there are two identical dependencies but wi=
th different scope. This causes maven to go into JavaScopeDeriver.getDerive=
dScope .... here in the end in the "else" simply RUNTIME is assumed as a de=
fault.

MG>"runtime default scoping" is explained somewhat at=20
MG>http://books.sonatype.com/mvnref-book/pdf/mvnref-pdf.pdf
MG>clearing up the situation for each dependency to have different GAV=20
MG>will resolve

I think I will have to refactor the structure of our artifacts to generate =
the resource bundles into a different artifact (assumably by appending ".rb=
" to the group Id
MG>perhaps the owner of=20
MG>http://books.sonatype.com/mvnref-book/pdf/mvnref-pdf.pdf doc will allow =
documenting this side effect by Chris Dutz...no sense in anyone else being =
bit by "Identical GAV default runtime scoping side-effect"
>=20
> Chris
>=20
> ________________________________________
> Von: Christofer Dutz <christofer.dutz@c-ware.de>
> Gesendet: Freitag, 17. Oktober 2014 14:28
> An: Maven Users List
> Betreff: AW: Strange Dependency problem after switching to Maven 3.1.1
>=20
> Actually in MavenProject the "resolvedArtifacts" variable contains this d=
ata ... not "artifacts" as the runtime artifacts are stripped out by the "a=
rtifactFilter".
>=20
> Chris
>=20
> ________________________________________
> Von: Christofer Dutz <christofer.dutz@c-ware.de>
> Gesendet: Freitag, 17. Oktober 2014 14:20
> An: Maven Users List
> Betreff: Strange Dependency problem after switching to Maven 3.1.1
>=20
> Hi,
>=20
>=20
> I'm currently working on updating the Flexmojos plugin to support newer M=
aven versions. Now I'm having a strange problem:
>=20
>=20
> Flexmojos defines Flex dependencies as type "swc" for flex libraries and =
"rb.swc" for resource bundles. Furthermore we have a scope "rsl" (runtime s=
hared library) which sort of turns the default static linking to dynamic li=
nking.
>=20
>=20
> So assume I have an artifact A and B of type "swc" that has one "rb.swc" =
dependency to its corresponding resource bundle.
>=20
>=20
> In my project I now add one dependency to A with scope "rsl" and one depe=
ndency to B with the default "compile" scope.
>=20
>=20
> In Maven 3.0.5 I can see the MavenProjects.artifacts list containing
>=20
>=20
> A:swc:rsl
>=20
> A:rb.swc:compile
>=20
> B:swc:compile
>=20
> B:rb.swc:compile
>=20
>=20
> In Maven 3.1.1 this however is:
>=20
>=20
> A:swc:rsl
>=20
> A:rb.swc:runtime
>=20
> B:swc:compile
>=20
> B:rb.swc:compile
>=20
>=20
> Why does the scope of the transitive dependencies switch to "runtime" in =
Maven 3.1.1?
>=20
>=20
> Chris
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> For additional commands, e-mail: users-help@maven.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> For additional commands, e-mail: users-help@maven.apache.org
>=20
 		 	   		 =20

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


