From users-return-135476-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Feb 14 06:52:47 2014
Return-Path: <users-return-135476-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 56F5A10A62
	for <apmail-maven-users-archive@www.apache.org>; Fri, 14 Feb 2014 06:52:47 +0000 (UTC)
Received: (qmail 39211 invoked by uid 500); 14 Feb 2014 06:52:43 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 38812 invoked by uid 500); 14 Feb 2014 06:52:41 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 38800 invoked by uid 99); 14 Feb 2014 06:52:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Feb 2014 06:52:40 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anders.g.hammar@gmail.com designates 74.125.82.173 as permitted sender)
Received: from [74.125.82.173] (HELO mail-we0-f173.google.com) (74.125.82.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Feb 2014 06:52:37 +0000
Received: by mail-we0-f173.google.com with SMTP id x48so2741279wes.4
        for <users@maven.apache.org>; Thu, 13 Feb 2014 22:52:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:sender:in-reply-to:references:date:message-id:subject
         :from:to:content-type;
        bh=Zj3DmdcjjLKJUwWyvQGqcYkGDT3/sHOyXTVZ4DkMNi8=;
        b=EHj6nygUiEPnnJ7zLI877AU7NcwJipkAxqaYLJpRrNqKhTHUvHIEqT7FF4vTK+GA/J
         xjqTTyFhmwAERsi9P4cAEK6UbK7sENJPsXQA2GKB8GU1HJhfZ1QqKQTTtrN5J1D+ev+G
         nbbpLrw8V8pRzYK7GPwYFSODSaXTCkvU/n0KK1q456kTJEGjy54cCSyRC4n4KM5oXkdn
         WG7FR6INs0CPD1DYKpl1eadpiSVvFSyKxtaoKEuZsfjDKzHkLsSLB7U54zv13rCyd+7D
         GkwPQRlvdkk5csMMfIeYZqs80v9p+iNJsNSbRgbWletqbDn8DOTXVZnE1B95UtLaAVmW
         xmfg==
MIME-Version: 1.0
X-Received: by 10.194.6.8 with SMTP id w8mr4549668wjw.16.1392360735769; Thu,
 13 Feb 2014 22:52:15 -0800 (PST)
Sender: anders.g.hammar@gmail.com
Received: by 10.194.137.100 with HTTP; Thu, 13 Feb 2014 22:52:15 -0800 (PST)
In-Reply-To: <CAJZYdzjHBa08qjUi0Oncfyrh4BYRb__-y8QhxgnCVCS1_YyZCA@mail.gmail.com>
References: <CAJZYdzjdZKS69VX64izc104aeb2m0CZQqcR2BWCbaHp3mginjg@mail.gmail.com>
	<52F4EED5.2040305@artifact-software.com>
	<CAJZYdzjLSdYqes9wtokB0U6yvO8DkV1Qt8dqf2s2i_gwuR_uvA@mail.gmail.com>
	<52F50425.50107@artifact-software.com>
	<CAJZYdziKda4m1LLqefAzztmM6QM2ooA7mSsLkrUt4YMbbwy=Hg@mail.gmail.com>
	<CANWgJS6gedPKQ_S5Gyt_D6j4KFnJoSfBrUf7GdE6ht6wo7fq6Q@mail.gmail.com>
	<CAJZYdzjHBa08qjUi0Oncfyrh4BYRb__-y8QhxgnCVCS1_YyZCA@mail.gmail.com>
Date: Fri, 14 Feb 2014 07:52:15 +0100
X-Google-Sender-Auth: -6NXqLgeVTMaiR1QOtikeN-deAo
Message-ID: <CAKDUN1td5rA6ij7L4JgOuWaCQU+qsQejs+wcEFSVXcDBQ4xCzQ@mail.gmail.com>
Subject: Re: maven-ear-plugin silently overrides libraries
From: Anders Hammar <anders@hammar.net>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=047d7b5d64980e0a6904f2583fc0
X-Virus-Checked: Checked by ClamAV on apache.org

--047d7b5d64980e0a6904f2583fc0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

You need to create an account at Codehaus Xircles. Go to
http://jira.codehaus.org and there is more info in the top left hand
gadget/box.

/Anders


On Fri, Feb 14, 2014 at 7:46 AM, Reto Habl=FCtzel <rethab@rethab.ch> wrote:

> Is JIRA open for public registration / issue creation? I could not find a
> link to sign up..
>
> Anyways, I attached a sample project. Please follow these steps to
> recreate the issue (btw. I think the whole naming thing is also a problem
> if you are referencing two ejbs with the same artifactId and version):
>
> Install 'utilities' project in 'collections':
> collections/utilities> mvn install
>
> Install 'utilities' project in 'email':
> email/utilities> mvn install
>
> Package 'ear' project:
> ear> mvn package
>
> Look at contents of ear and notice how only one jar is included:
> ear> unzip -v target/ear-1.0.0.ear
>
> Now use the debug flag to see why only one gets included:
> ear> mvn --debug clean package
>
> Partial output:
>   [INFO] Copying artifact [jar:ch.rethab.email:utilities:1.0.0] to
> [utilities-1.0.0.jar]
>   [DEBUG] Skipping artifact [jar:ch.rethab.collections:utilities:1.0.0],
> as it is already up to date at [utilities-1.0.0.jar]
>
>
>
>
> On Thu, Feb 13, 2014 at 7:32 PM, Baptiste Mathus <bmathus@batmat.net>wrot=
e:
>
>> That's the way to go. Even more if you're able to attach a test project.
>> One report without report is far less likely to be worked on.
>> Cheers
>> Le 13 f=E9vr. 2014 14:06, "Reto Habl=FCtzel" <rethab@rethab.ch> a =E9cri=
t :
>>
>> > So what's the status on this? Shall I create a ticket?
>> >
>> >
>> > On Fri, Feb 7, 2014 at 5:04 PM, Ron Wheeler
>> > <rwheeler@artifact-software.com>wrote:
>> >
>> > > Exclusions will not help in this case.
>> > > Looking through the dependency hierarchy will at least get you to se=
e
>> the
>> > > problem earlier which I think was the nature of your question.
>> > >
>> > > It appears from my brief reading and fun with making servlets run in
>> > > production that classloaders merge classes by name.
>> > > Maven does not.
>> > >
>> > > I am a bit surprised that groupId does not count.
>> > >
>> > > If one uses a lot of third -party libraries, it would seem inevitabl=
e
>> > that
>> > > you could need com.artifact-software:utilities:1.0 at the same time =
as
>> > > ch.rethab:utilities:1.0 at the same time.
>> > > The classloader is not going to cause any problem but if Maven throw=
s
>> out
>> > > one of these as a duplicate, you will be missing classes at run-time=
.
>> > >
>> > > It is difficult to force everyone to create unique artifactIds unles=
s
>> you
>> > > get rid of the GroupId altogther and make GAV -> <AV> and put the
>> group
>> > > name into the artifactID.
>> > >
>> > > This seems to be a design flaw if it is true.
>> > >
>> > > Ron
>> > >
>> > >
>> > > On 07/02/2014 9:43 AM, Reto Habl=FCtzel wrote:
>> > >
>> > >> Sure, but exclusions don't do the trick if you need both of them, d=
o
>> > >> they? I am talking about completely independent libraries that
>> happen to
>> > >> have the same artifactId.
>> > >>
>> > >> Those were actually both libraries of mine and I could obviously fi=
x
>> > this
>> > >> issue rather simply, but I was just thinking that it would be
>> helpful to
>> > >> have at least a warning or something from maven - regardless of the
>> IDE.
>> > >>
>> > >> - Reto
>> > >>
>> > >>
>> > >> On Fri, Feb 7, 2014 at 3:33 PM, Ron Wheeler
>> <rwheeler@artifact-software.
>> > >> com <mailto:rwheeler@artifact-software.com>> wrote:
>> > >>
>> > >>     If your IDE supports Maven (Eclipse/STS for example), you will
>> see
>> > >>     the conflict in the dependency hierarchy view and you can fix i=
t
>> > >>     with the right exclusions.
>> > >>
>> > >>     It is almost always worth a quick look through the dependency
>> > >>     hierarchy view if you use a lot of third party libraries.
>> > >>     Not everyone updates their dependencies when they build a
>> > >>     shareable library.
>> > >>     You can sometimes get some pretty old versions of things dragge=
d
>> > >>     in with the latest version of otherwise well-written libraries.
>> > >>     Exclusions need to be added to get what you want in your
>> artifacts.
>> > >>
>> > >>     Ron
>> > >>
>> > >>
>> > >>     On 07/02/2014 9:21 AM, Reto Habl=FCtzel wrote:
>> > >>
>> > >>         Hi there,
>> > >>
>> > >>         I built an ear using the maven-ear-plugin (version 2.6).
>> > >>
>> > >>         The ear is configured such that it includes two libraries
>> into
>> > >>         the lib
>> > >>         folder, both with the same artifactId as well as the same
>> > >>         version, but a
>> > >>         different groupId. Now if I simply call 'mvn package' only
>> the
>> > >>         first one is
>> > >>         included, but no warning whatsoever appears. Only once I tu=
rn
>> > >>         on debugging
>> > >>         (mvn --debug package), I see one subtle message:
>> > >>         [DEBUG] Skipping artifact [jar:com.foo:bar:1.0] as it is
>> > >>         already up to date
>> > >>         at [lib/bar-1.0.jar]
>> > >>
>> > >>         Wouldn't it make sense to either include the groupId in the
>> > >>         filename or at
>> > >>         least make a check (that includes the groupId) beforehand i=
f
>> > >>         there are any
>> > >>         conflicts?
>> > >>
>> > >>         Cheers,
>> > >>         Reto
>> > >>
>> > >>
>> > >>
>> > >>     --     Ron Wheeler
>> > >>     President
>> > >>     Artifact Software Inc
>> > >>     email: rwheeler@artifact-software.com
>> > >>     <mailto:rwheeler@artifact-software.com>
>> > >>
>> > >>     skype: ronaldmwheeler
>> > >>     phone: 866-970-2435, ext 102
>> > >>
>> > >>
>> > >>
>> > ---------------------------------------------------------------------
>> > >>     To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
>> > >>     <mailto:users-unsubscribe@maven.apache.org>
>> > >>
>> > >>     For additional commands, e-mail: users-help@maven.apache.org
>> > >>     <mailto:users-help@maven.apache.org>
>> > >>
>> > >>
>> > >>
>> > >
>> > > --
>> > > Ron Wheeler
>> > > President
>> > > Artifact Software Inc
>> > > email: rwheeler@artifact-software.com
>> > > skype: ronaldmwheeler
>> > > phone: 866-970-2435, ext 102
>> > >
>> > >
>> >
>>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> For additional commands, e-mail: users-help@maven.apache.org
>

--047d7b5d64980e0a6904f2583fc0--

