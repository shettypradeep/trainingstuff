From users-return-135642-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Feb 28 02:13:49 2014
Return-Path: <users-return-135642-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 076E610240
	for <apmail-maven-users-archive@www.apache.org>; Fri, 28 Feb 2014 02:13:49 +0000 (UTC)
Received: (qmail 54939 invoked by uid 500); 28 Feb 2014 02:13:45 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 54770 invoked by uid 500); 28 Feb 2014 02:13:45 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 54762 invoked by uid 99); 28 Feb 2014 02:13:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Feb 2014 02:13:45 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mcculls@gmail.com designates 209.85.212.171 as permitted sender)
Received: from [209.85.212.171] (HELO mail-wi0-f171.google.com) (209.85.212.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Feb 2014 02:13:39 +0000
Received: by mail-wi0-f171.google.com with SMTP id cc10so186695wib.10
        for <users@maven.apache.org>; Thu, 27 Feb 2014 18:13:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to;
        bh=+3Z9BA/BsY45uMs5HsgVW9omQc/7AfXtnhmN2xXr0ME=;
        b=0eVtP/aLhTdfYQbqCzvm3pyMS4pIFklPRZnB6Rh4ZN0zhB2g9b4NC77X5zkrokw8sk
         V2509KoJrhfggv4k+PaqInrOq59egQcNglrldB0plT19tI3ng3z9dl/ERAifxgDEz0Dm
         iFGSbxp1MOYTMMQA2x5oPA0U/w+Gjs8MRcqzJpWLGlx1vsR7linxnM6uq+lZuhaTV2VM
         I03b6Oq+ZdA9F+k5VPTcWCvEGNfZFAM8rmwo9sBw68bYMfYjhnfHSwhxEhOIIQMYPXf/
         qC6s/lWhdwoRJVbr+Brgbz5Y5Mn+uhmDn1e6slnSYck7WNIW1PHkOqxhBvHhWNRu2/pg
         EdPQ==
X-Received: by 10.180.25.46 with SMTP id z14mr123204wif.49.1393553598362;
        Thu, 27 Feb 2014 18:13:18 -0800 (PST)
Received: from tulloch.home (host86-153-167-162.range86-153.btcentralplus.com. [86.153.167.162])
        by mx.google.com with ESMTPSA id br10sm485885wjb.3.2014.02.27.18.13.17
        for <users@maven.apache.org>
        (version=TLSv1 cipher=ECDHE-RSA-RC4-SHA bits=128/128);
        Thu, 27 Feb 2014 18:13:17 -0800 (PST)
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 7.2 \(1874\))
Subject: Re: Guice provision error with AbstractMavenLifecycleParticipant
From: Stuart McCulloch <mcculls@gmail.com>
In-Reply-To: <CAEBcyzqFMx09wypuh4bXUd68FZ+TUegEnpMUs3ffje3DWS=eCg@mail.gmail.com>
Date: Fri, 28 Feb 2014 02:13:16 +0000
Content-Transfer-Encoding: quoted-printable
Message-Id: <3E4BAFCA-287A-42F4-BCF0-21B8B8B4FA79@gmail.com>
References: <CAEBcyzqFMx09wypuh4bXUd68FZ+TUegEnpMUs3ffje3DWS=eCg@mail.gmail.com>
To: Maven Users List <users@maven.apache.org>
X-Mailer: Apple Mail (2.1874)
X-Virus-Checked: Checked by ClamAV on apache.org

On 28 Feb 2014, at 01:17, William Ferguson =
<william.ferguson@xandar.com.au> wrote:

> As part of the development of the android-maven-plugin we have need to =
add
> in an AbstractMavenLifecycleParticipant so that we can modify the =
compile
> classpath to add artefacts that are contained within a project's
> dependencies. Igor provided a lot of the coaching on this.
>=20
> The build works fine. Does what is intended.
>=20
> But now, when you open a project in intelliJ13 that uses the
> android-maven-plugin, IntelliJ declares a problem with the POM that
> references our MavenLifecycleParticipant.
>=20
> What I'd like help with is:
> 1) Is this a problem with the plugin itself. Ie have we defined =
something
> incorrectly.
> 2) Is it just a problem with how IntelliJ is parsing a POM that =
declares
> the plugin.
>=20
> If it is (1), what do we need to do to fix it?
>=20
> However, I suspect it is (2) because similar error messages seem to =
occur
> when plugins designed for Maven 3.1 (and the switch to Eclipse Aether =
from
> Sonatype Aether) are used in a Maven-3.0 environment. I'm thinking =
that
> maybe IntelliJ is using a Maven-3.0 core. But I'm really not sure and =
would
> love some clarity from those who understand what is going on a bit =
better.
> And if it is (2) is there anything we or IntelliJ can do to fix it?
>=20
> The plugin itself can be found at:
> https://github.com/jayway/maven-android-plugin
>=20
> A project showing the failure can be found at:
> =
https://github.com/jayway/maven-android-plugin-samples/tree/master/morsefl=
ash/morseflash-app
>=20
> And the error message is (visible via flyover in the POM editor window =
or
> in idea.log):

I can recreate the same exception on the command-line using the plugin =
with Maven 3.0.5 (after I removed the 3.1.1 pre-req from the plugin=92s =
pom.xml)

The issue is that the plugin expects Maven core to supply an =
implementation of org.eclipse.aether.impl.VersionResolver, namely =
DefaultVersionResolver from maven-aether-provider.

However in Maven 3.0.x the maven-aether-provider module only supplies an =
implementation of org.sonatype.aether.impl.VersionResolver =85 which is =
why you see that exception :/

Unfortunately adding a direct plugin dependency to the =
maven-aether-provider from 3.1.1 won=92t help because Maven will filter =
out this dependency as being supplied from Maven core

If you want the plugin to work on both Maven 3.0.x and 3.1.x then you=92ll=
 either need to use an API common to both (like the shared =
maven-dependency-tree component) or write two versions of the code that =
talks to Aether and select the appropriate one at runtime using =
reflection. But if you just want to avoid the exception when Intellij =
processes the pom.xml then you could conceivably provide dummy/stubbed =
@Component implementations of the Eclipse/Aether resolver, with the role =
set to a non-default value such as =93dummy=94 so that it doesn=92t =
interfere with the default implementation provided in Maven 3.1.1

> java.lang.RuntimeException: com.google.inject.ProvisionException:
> Guice provision errors:
>=20
> 1) No implementation for org.eclipse.aether.impl.VersionResolver was =
bound.
>  while locating =
org.eclipse.aether.internal.impl.DefaultRepositorySystem
>  at =
ClassRealm[extension>com.jayway.maven.plugins.android.generation2:android-=
maven-plugin:3.9.0-rc.1,
> parent: sun.misc.Launcher$AppClassLoader@39172e08]
>  at =
ClassRealm[extension>com.jayway.maven.plugins.android.generation2:android-=
maven-plugin:3.9.0-rc.1,
> parent: sun.misc.Launcher$AppClassLoader@39172e08]
>  while locating org.eclipse.aether.RepositorySystem
>  while locating
> =
com.jayway.maven.plugins.android.phase_prebuild.AarMavenLifecycleParticipa=
nt
>  at =
ClassRealm[extension>com.jayway.maven.plugins.android.generation2:android-=
maven-plugin:3.9.0-rc.1,
> parent: sun.misc.Launcher$AppClassLoader@39172e08]
>  at =
ClassRealm[extension>com.jayway.maven.plugins.android.generation2:android-=
maven-plugin:3.9.0-rc.1,
> parent: sun.misc.Launcher$AppClassLoader@39172e08]
>  while locating org.apache.maven.AbstractMavenLifecycleParticipant
> annotated with =
@com.google.inject.name.Named(value=3DAarMavenLifecycleListener)
>=20
>=20
> We are tracking this at:
> https://code.google.com/p/maven-android-plugin/issues/detail?id=3D449
>=20
>=20
> Any help appreciated.
>=20
>=20
> William


---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


