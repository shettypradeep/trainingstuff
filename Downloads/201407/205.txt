From users-return-136939-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Tue Jul 29 13:48:20 2014
Return-Path: <users-return-136939-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8F7DD11BD8
	for <apmail-maven-users-archive@www.apache.org>; Tue, 29 Jul 2014 13:48:20 +0000 (UTC)
Received: (qmail 6110 invoked by uid 500); 29 Jul 2014 13:48:18 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 6031 invoked by uid 500); 29 Jul 2014 13:48:18 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 6018 invoked by uid 99); 29 Jul 2014 13:48:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Jul 2014 13:48:18 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.larsson@klarna.com designates 209.85.215.48 as permitted sender)
Received: from [209.85.215.48] (HELO mail-la0-f48.google.com) (209.85.215.48)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Jul 2014 13:48:15 +0000
Received: by mail-la0-f48.google.com with SMTP id gl10so6522213lab.21
        for <users@maven.apache.org>; Tue, 29 Jul 2014 06:47:50 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=DlXn0K9U5F7XT6T3lVJZT3P5K9Ehm5Xv/2cCvkXOUaw=;
        b=YJGRS//y6eWXtUe/zAkiqMyBPkn0FqonWgU5jbkhVNI8t52FQZXxoQFSvPfsJPMMIz
         8xSvUyuc1+IpgNLgN27hK5R9S04+NJjDmq7Gq0d/+eQhWNU2CxF1kDThes9Si/yyZVIs
         c6XqkoCQ5/Xyp0OwoNT2+IcXFOr0rV9m5hEM94Z/LqENlgibLyHPH3wJ0EwHvg74gSzL
         gpn9f3Rff02HE0uS0msmA7Xnw0AIAMA0dMHC1BXJo3vFgzRT2awDrs75H1+DwmTxo0HX
         WqEbvXmkWAO3t0plu9iNrgqtKaxjfzZEHuKyTp8p8MBvKU/n9uiR7z6GsO6rHdTMENzB
         +tOg==
X-Gm-Message-State: ALoCoQn7QaIGczQGIUK5uHgquUS10YbfbCoLKG+ZGa9tuzB6nM44O+OhH6lgDGv1/vrA8egYH28X
MIME-Version: 1.0
X-Received: by 10.112.204.36 with SMTP id kv4mr2414821lbc.106.1406641670780;
 Tue, 29 Jul 2014 06:47:50 -0700 (PDT)
Received: by 10.114.18.98 with HTTP; Tue, 29 Jul 2014 06:47:50 -0700 (PDT)
Date: Tue, 29 Jul 2014 15:47:50 +0200
Message-ID: <CAP4oMn_+dbHEQ+qcg=KWv8T-Ndd-XoKO3iZMPOR8sBoZSvjP7g@mail.gmail.com>
Subject: Why doesn't wagon ssh look at exit codes instead of error stream content
From: Thomas Larsson <thomas.larsson@klarna.com>
To: users@maven.apache.org
Content-Type: multipart/alternative; boundary=001a11c3cf321d13d404ff55494e
X-Virus-Checked: Checked by ClamAV on apache.org

--001a11c3cf321d13d404ff55494e
Content-Type: text/plain; charset=UTF-8

Hello all,

I am wondering why it is that
org.apache.maven.wagon.providers.ssh.jsch.AbstractJschWagon is not looking
at non-zero exit codes instead of non-null error streams to determine
whether a command has succeeded or not?

We have a case where we execute an Apache Hive query over ssh using the
maven wagon plugin, with a command looking something like "hive -e 'show
databases'".
When doing this, hive outputs parts of the result over stderr (which is
very weird I grant) but the command exits with exit code 0, i.e. no error.
However, since wagon (and in extension the wagon-plugin) sees stderr
content, it considers this a failed step.

I found some TODOs in the code surrounding this but no JIRA Issue.
So I am wondering what the concrete reason is for doing it in this slightly
weird way.

Best Regards
Thomas

--001a11c3cf321d13d404ff55494e--

