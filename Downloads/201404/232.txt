From users-return-136230-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Tue Apr 22 17:15:31 2014
Return-Path: <users-return-136230-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 96E0511D60
	for <apmail-maven-users-archive@www.apache.org>; Tue, 22 Apr 2014 17:15:31 +0000 (UTC)
Received: (qmail 51420 invoked by uid 500); 22 Apr 2014 17:15:27 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 51349 invoked by uid 500); 22 Apr 2014 17:15:26 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 51341 invoked by uid 99); 22 Apr 2014 17:15:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Apr 2014 17:15:26 +0000
X-ASF-Spam-Status: No, hits=-0.5 required=5.0
	tests=FREEMAIL_ENVFROM_END_DIGIT,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of knarayanan88@gmail.com designates 209.85.213.170 as permitted sender)
Received: from [209.85.213.170] (HELO mail-ig0-f170.google.com) (209.85.213.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Apr 2014 17:15:21 +0000
Received: by mail-ig0-f170.google.com with SMTP id uq10so3115836igb.1
        for <users@maven.apache.org>; Tue, 22 Apr 2014 10:15:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=eWcp2LDRIyb5TzADIgGn95sVh1YQDnN/my02Ts3NfTc=;
        b=D8jWf7feL//Jp6Oa7NcxRCwGb//rYUXxqOOjYQZSJMwbRXm+y+jmVSiHiImgd7wWJp
         wn1Y+eJmOfTtqhJgTYKkQqvxNF00QeRTnnGrdx123BfFCSvrwRPhH5mjCf67xY/TrpXD
         Gl1MHZ3WLN3vPug1B6GpcGtNHziN3rYKoYHeL1vMoiPftLb29ScG5uUHY1U8MLRTizJD
         JsY1nB3vrmMS1JqDk/7V92zCrutq1H5kt54JEol43KHW0RalbOWcbNazsaHSjx+CD5zF
         4DpJ96avGoTqeOTosC26928UPGxzuMg6OX7g5HsfJqS+TYZbr5XIJI9yUg11y4aFVwcA
         jVfQ==
MIME-Version: 1.0
X-Received: by 10.43.138.8 with SMTP id iq8mr38240571icc.37.1398186900506;
 Tue, 22 Apr 2014 10:15:00 -0700 (PDT)
Received: by 10.50.122.37 with HTTP; Tue, 22 Apr 2014 10:15:00 -0700 (PDT)
In-Reply-To: <CA+nPnMzLSP8AvqNwdjdChgkmF7spcpYzuovQqYQSm5r7aj8wmQ@mail.gmail.com>
References: <CAAqB__v0TwN+kuL-QYeVQczhX3t+mmd58StYJMtaytFx0ZjnQA@mail.gmail.com>
	<CA+nPnMzLSP8AvqNwdjdChgkmF7spcpYzuovQqYQSm5r7aj8wmQ@mail.gmail.com>
Date: Tue, 22 Apr 2014 10:15:00 -0700
Message-ID: <CAAqB__sJZ9WU9vY0pqQqUvBZZJwwut2+B-UxoGbyp2M-a98Obg@mail.gmail.com>
Subject: Re: Generating war and Jar from same codebase
From: Narayanan K <knarayanan88@gmail.com>
To: Maven Users List <users@maven.apache.org>
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks all for replying.

So having a parent pom and inheriting common dependencies to the 2
child poms is the best solution.

My new maven project structure will be :

.
 | -- pom.xml (parent pom)
 | -- pom-war.xml (inherits from parent, generates a war)
 | -- pom-jar.xml (inherits from parent, generates a jar)

There are no modules in the project. All poms are going to be in the
root path of the project.

1. Any examples on how to write the parent pom referencing the same
codebase for the child poms.
Will there be a <module> tag for parent pom.  I understand that the
packaging for parent pom will be "pom".

2. The child poms will have <relativePath> in <parent> tag as
./pom.xml. Please correct me if this is wrong.

Thanks
Narayanan





Narayanan

On Tue, Apr 22, 2014 at 12:38 AM, Stephen Connolly
<stephen.alan.connolly@gmail.com> wrote:
> On 22 April 2014 01:18, Narayanan K <knarayanan88@gmail.com> wrote:
>
>> Hi
>>
>> We have a default pom file with packaging "war" for our codebase.
>>
>> From the same code base we also want to generate a normal jar and a
>> fat jar with dependencies.
>>
>> Currently solution that has been implemented is another pom-jar.xml
>> file that has the packaging as jar and maven-assembly-plugin to
>> generate the jar with dependencies. We use mvn install -f pom-jar.xml.
>>
>> But we are in a situation where if any new dependency is added to
>> pom.xml, we need to add to pom-jar.xml as well as it is the same
>> codebase.
>>
>> To avoid this we thought of couple of solutions -
>>
>> 1. Add maven-jar-plugin and maven-assembly-plugin to the default pom
>> with packaging war - so it generates a war file, a normal jar file and
>> fat jar out of the same pom. So we can do away with the pom-jar.xml.
>>
>> Not sure if this is a good solution. We tried this, but this is
>> working well only in maven 3.0.4. The assembly plugin is not working
>> well with Maven 2 (which is in our build environment) while generating
>> the fat jar.
>>
>> 2. Have a parent pom and put all the dependencies and plugins in that
>> and have 2 child poms in the same codebase with different names
>> inherit from parent pom, one that has packaging of war that generates
>> war file and the other child pom has packaging jar with maven assembly
>> plugin to generate both normal and fat jar. And all new dependencies
>> need to be added only to parent pom.
>>
>> This solution will make us have 3 pom files in codebase, doesnt look
>> very elegant,
>
>
> actually depends on your point of view. To me this is the more elegant
> solution as you clearly see the relationship between inputs (pom.xml) and
> outputs (artifacts, e.g. jars wars, etc)
>
>
>> but will solve our dependency management issues between
>> the 2 packaging.
>>
>>
>> Are these good solutions? Is there any other good solution available
>> for this scenario ?
>>
>>
>> Regards
>> Narayanan
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
>> For additional commands, e-mail: users-help@maven.apache.org
>>
>>

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


