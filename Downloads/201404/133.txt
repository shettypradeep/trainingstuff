From users-return-136100-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Sun Apr  6 17:15:27 2014
Return-Path: <users-return-136100-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9A23111239
	for <apmail-maven-users-archive@www.apache.org>; Sun,  6 Apr 2014 17:15:27 +0000 (UTC)
Received: (qmail 60202 invoked by uid 500); 6 Apr 2014 17:15:21 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 60037 invoked by uid 500); 6 Apr 2014 17:15:19 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 60011 invoked by uid 99); 6 Apr 2014 17:15:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Apr 2014 17:15:18 +0000
X-ASF-Spam-Status: No, hits=2.2 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of eric.kolotyluk@gmail.com designates 209.85.192.172 as permitted sender)
Received: from [209.85.192.172] (HELO mail-pd0-f172.google.com) (209.85.192.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Apr 2014 17:15:12 +0000
Received: by mail-pd0-f172.google.com with SMTP id p10so5535641pdj.3
        for <users@maven.apache.org>; Sun, 06 Apr 2014 10:14:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type;
        bh=Oak/X0vcdYK8Jjd33xhiXKt7olbpDCm9cte8Z4Qc1jg=;
        b=Mzaq1Jrij6py7JBB1lHCQWcjtwSvMmcSXUzu7e9kAbxxqEir+cYk9pTyXoTPCBnMpk
         ztzyEuVLzZ3Gjhxir3WqgnYk+sGl73cgYQEKDZI8TAkKBL8Mki6p0OBgq+WugB0ga2eG
         cE0WV6kumYCxlAY9SqG9njdgW92dGOOJ+T3H3MyinqmS+yWAbyVCCv4s4pDhax8l+PkL
         ZbnrkXkTY9XYn4ANuxFKqLS2GKd3ZE3jXDMzu4pAXOMIyYOXCyQvPUikkW+KuPqyKdSX
         6pc8rrkX2CNZGQrTADOlkUDEP4Z0RB4jDEVLayFvPEvytE9RJxhRqE1JxEBfevTV0gg8
         7I5Q==
X-Received: by 10.68.125.164 with SMTP id mr4mr26204269pbb.27.1396804489794;
        Sun, 06 Apr 2014 10:14:49 -0700 (PDT)
Received: from [192.168.0.17] (S0106602ad07f9cfa.vc.shawcable.net. [24.85.131.20])
        by mx.google.com with ESMTPSA id j3sm31301638pbh.38.2014.04.06.10.14.47
        for <users@maven.apache.org>
        (version=TLSv1 cipher=ECDHE-RSA-RC4-SHA bits=128/128);
        Sun, 06 Apr 2014 10:14:48 -0700 (PDT)
Message-ID: <53418B87.7030205@gmail.com>
Date: Sun, 06 Apr 2014 10:14:47 -0700
From: Eric Kolotyluk <eric.kolotyluk@gmail.com>
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:24.0) Gecko/20100101 Thunderbird/24.4.0
MIME-Version: 1.0
To: maven users <users@maven.apache.org>
Subject: GitHub Site Deployment
Content-Type: multipart/alternative;
 boundary="------------030404020007070509010702"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------030404020007070509010702
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

I have my automated site deployment working with GitHub finally, but 
there are some inelegant aspects of it, and I am wondering if there are 
some more elegant solutions.

In order to get the maven-release-plugin to work properly I had to add 
the following to my pom.xml

<distributionManagement>
<site>
<!--
         Fake site used to trick maven-release-plugin into doing 
site-distribution.
         Real site-distribution is done via com.github.github 
site-maven-plugin.
         Even if you specify <goals>deploy site-deploy</goals> to the 
release
         plugin, it still needs to see <distributionManagement>.
       -->
<id>fake</id>
<url>file:///fake-site</url>
</site>
</distributionManagement>

I would rather not have to use such a hack, but I have found no other 
way. The actual site deployment is handled by

<profiles>
<profile>
<id>github-site</id>
<!--
         We do not want to deploy our site to GitHub until we release it,
         otherwise, snap-shot releases get published. For example:
           mvn release:clean
           mvn release:prepare
           mvn release:perform
         should just work. Add the following to the maven-release-plugin
           <plugin>
             <artifactId>maven-release-plugin</artifactId>
             <configuration>
                 <releaseProfiles>github-site</releaseProfiles>
           </configuration>
         </plugin>
       -->
<build>
<plugins>
<plugin>
<!--
                 deploy the site to github pages
                 https://github.com/github/maven-plugins
             -->
<groupId>com.github.github</groupId>
<artifactId>site-maven-plugin</artifactId>
<configuration>
<!-- the id of the server with the passwords in settings.xml -->
<server>github</server>
<!-- sometimes the plugin cannot figure out the owner and name  -->
<!-- from the scm info, so it is best to define it explicitly   -->
<!--               <repositoryOwner>kolotyluk</repositoryOwner> -->
<!--               <repositoryName>java-file-utilities</repositoryName> -->
<message>Creating GitHub Pages site for ${project.version}</message>
</configuration>
<executions>
<execution>
<phase>site-deploy</phase>
<goals>
<goal>site</goal> <!-- the site goal uploads to gh_pages -->
</goals>
</execution>
</executions>
</plugin>
</plugins>
</build>
</profile>
</profiles>

I would have rather done something like

<distributionManagement>
<site>
<id>github</id>
<url>/some magic URL that specifies the gh_pages branch of my project/</url>
</site>
</distributionManagement>

but GitHub chose another solution.

Cheers, Eric


--------------030404020007070509010702--

