From users-return-136267-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Sat Apr 26 20:53:24 2014
Return-Path: <users-return-136267-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 96AC111591
	for <apmail-maven-users-archive@www.apache.org>; Sat, 26 Apr 2014 20:53:24 +0000 (UTC)
Received: (qmail 70735 invoked by uid 500); 26 Apr 2014 20:53:20 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 70662 invoked by uid 500); 26 Apr 2014 20:53:20 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 70654 invoked by uid 99); 26 Apr 2014 20:53:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Apr 2014 20:53:20 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tim.t.wu@ericsson.com designates 193.180.251.37 as permitted sender)
Received: from [193.180.251.37] (HELO sesbmg23.ericsson.net) (193.180.251.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Apr 2014 20:53:15 +0000
X-AuditID: c1b4fb25-f798a6d000005ede-84-535c1ca3134a
Received: from ESGSCHC001.ericsson.se (Unknown_Domain [153.88.253.124])
	by sesbmg23.ericsson.net (Symantec Mail Security) with SMTP id 0E.9D.24286.4AC1C535; Sat, 26 Apr 2014 22:52:53 +0200 (CEST)
Received: from ESGSCMB101.ericsson.se ([169.254.1.227]) by
 ESGSCHC001.ericsson.se ([10.0.18.117]) with mapi id 14.03.0174.001; Sun, 27
 Apr 2014 04:52:50 +0800
From: Tim Wu T <tim.t.wu@ericsson.com>
To: Maven Users List <users@maven.apache.org>
Subject: RE: Maven sure fire plugin npe problem.
Thread-Topic: Maven sure fire plugin npe problem.
Thread-Index: AQHPYEk1hdgQnL+yokG4Eklmkm0j9ZskYUMQ
Date: Sat, 26 Apr 2014 20:52:49 +0000
Message-ID: <75F3A2D98EDE2545BDC06B5B6C1CEC516DF849EC@ESGSCMB101.ericsson.se>
References: <75F3A2D98EDE2545BDC06B5B6C1CEC516DF84192@ESGSCMB101.ericsson.se>
 <CAJZRQKxq1j8JnExT=-BcK-V9D64HhZyQT49Pj-CPAae2s0q8OA@mail.gmail.com>
In-Reply-To: <CAJZRQKxq1j8JnExT=-BcK-V9D64HhZyQT49Pj-CPAae2s0q8OA@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-originating-ip: [146.11.116.128]
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFrrKLMWRmVeSWpSXmKPExsUyM+Jvje5SmZhgg///VS0ebb3O6MDo0f5U
	KIAxissmJTUnsyy1SN8ugStjbfszpoL7ihX9CwUbGHfLdDFyckgImEjs+7uNBcIWk7hwbz0b
	iC0kcJRRou2TYxcjF5C9iFHi6pq5TCAJNgE1iY9XNrKC2CICuhIPLz5h7mLk4BAWMJA4Oz0D
	ImwosfHyeRYI20hi375VYOUsAqoSu/rfM4LYvAK+EusWXmGGmD+FUWLJ7BlgizkFAiU6Jn4B
	K2IEOuj7qTVge5kFxCVuPZnPBHGogMSSPeeZIWxRiZeP/7FC2EoSja+2QdXrSCzY/YkNwtaW
	WLbwNTPEYkGJkzOfsExgFJ2FZOwsJC2zkLTMQtKygJFlFaNocWpxUm66kbFealFmcnFxfp5e
	XmrJJkZgPBzc8lt1B+PlN46HGAU4GJV4eIu/RAYLsSaWFVfmHmKU5mBREuf9cssnWEggPbEk
	NTs1tSC1KL6oNCe1+BAjEwenVAOjvNM1C6HyqII1u2c/k+pdeOdv61xftef7WURt7QS3Kcpp
	czMLqL+t2Kv8/47FIr07jZ8sTv3zeXPOf92m/0tEdz7M52t6bpk907VU8tjGqyYB0dMZTH+I
	J8+159zy5e5jWd6Gm5f6Jd8dSrzyZH9n//Zwxp3czHlHLue1briXrCrwUUs/W15ZiaU4I9FQ
	i7moOBEAe2HKCWgCAAA=
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

After detail investigation, I can prove this is a bug of maven surefire plu=
gin, after version 2.12. That means from 2.12~2.17 it met the same problem.

The problem will happen in a special condition, you don't met any error dur=
ing the test case execution time, however, you set the result to fail durin=
g IInvokedMethodListener#afterInovation, such as result.setStatus(Fail),

Then maven surefire plugin will run ITestListener#onTestFailure method twic=
e and throw a Null pointer exception.

Currently, I rollback our plugin version to 2.12 to avoid this type of prob=
lem.

Br,
Tim
-----Original Message-----
From: kristian.rosenvold@zenior.no [mailto:kristian.rosenvold@zenior.no] On=
 Behalf Of Kristian Rosenvold
Sent: den 25 april 2014 07:42
To: Maven Users List
Subject: Re: Maven sure fire plugin npe problem.

It would appear that testng is not reporting the throwable that is cause of=
 the failure. You might want to try a few different testNG versions to see =
if this is a recently introduced regression.

Surefire should probably not NPE on this, but gaining some insight into the=
 root cause is probably a good thing (tm).

Kristian



2014-04-24 21:57 GMT+02:00 Tim Wu T <tim.t.wu@ericsson.com>:

> Hi everyone,
>
> I am not sure if some of you met this problem before, we have some=20
> smoke test in Jenkins sever, which will run some test case through=20
> maven sure fire plugin, version is 2.17
>
> But it will always throw an exception like this:
> java.lang.NullPointerException
>      at
> org.apache.maven.surefire.report.SmartStackTraceParser.<init>(SmartStackT=
raceParser.java:60)
>      at
> org.apache.maven.surefire.report.PojoStackTraceWriter.smartTrimmedStackTr=
ace(PojoStackTraceWriter.java:60)
>      at
> org.apache.maven.surefire.booter.ForkingRunListener.encode(ForkingRunList=
ener.java:328)
>      at
> org.apache.maven.surefire.booter.ForkingRunListener.encode(ForkingRunList=
ener.java:312)
>      at
> org.apache.maven.surefire.booter.ForkingRunListener.toString(ForkingRunLi=
stener.java:258)
>      at
> org.apache.maven.surefire.booter.ForkingRunListener.testFailed(ForkingRun=
Listener.java:137)
>      at
> org.apache.maven.surefire.testng.TestNGReporter.onTestFailure(TestNGRepor=
ter.java:105)
>      at org.testng.internal.Invoker.runTestListeners(Invoker.java:1901)
>      at org.testng.internal.Invoker.runTestListeners(Invoker.java:1885)
>      at org.testng.internal.Invoker.invokeMethod(Invoker.java:788)
>      at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:907)
>      at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1237)
>      at
> org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.j=
ava:127)
>      at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:11=
1)
>      at org.testng.TestRunner.privateRun(TestRunner.java:767)
>      at org.testng.TestRunner.run(TestRunner.java:617)
>      at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
>      at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
>      at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
>      at org.testng.SuiteRunner.run(SuiteRunner.java:240)
>      at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:51)
>      at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:85)
>      at org.testng.TestNG.runSuitesSequentially(TestNG.java:1197)
>      at org.testng.TestNG.runSuitesLocally(TestNG.java:1122)
>      at org.testng.TestNG.run(TestNG.java:1030)
>      at
> org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:2=
93)
>      at
> org.apache.maven.surefire.testng.TestNGXmlTestSuite.execute(TestNGXmlTest=
Suite.java:84)
>      at
> org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.jav=
a:91)
>      at
> org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLo=
ader(ForkedBooter.java:200)
>      at
> org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBo=
oter.java:153)
>      at
> org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:1
> 03)
>
>
>
> I try to google something, but I don't get any good feedback.
>
> Thanks in advance.
>
> Br,
> Tim
>

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


