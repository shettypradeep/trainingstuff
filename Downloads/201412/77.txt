From users-return-137933-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Thu Dec  4 23:41:41 2014
Return-Path: <users-return-137933-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 388C810614
	for <apmail-maven-users-archive@www.apache.org>; Thu,  4 Dec 2014 23:41:41 +0000 (UTC)
Received: (qmail 95688 invoked by uid 500); 4 Dec 2014 23:41:38 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 95604 invoked by uid 500); 4 Dec 2014 23:41:38 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 95587 invoked by uid 99); 4 Dec 2014 23:41:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 Dec 2014 23:41:37 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephen.alan.connolly@gmail.com designates 209.85.214.181 as permitted sender)
Received: from [209.85.214.181] (HELO mail-ob0-f181.google.com) (209.85.214.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 04 Dec 2014 23:41:33 +0000
Received: by mail-ob0-f181.google.com with SMTP id gq1so3700364obb.40
        for <users@maven.apache.org>; Thu, 04 Dec 2014 15:40:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=dyzLjTjYOLA1UcUM7IStGtyJP3pLmWmaZxMfBSTkMv4=;
        b=NUf0gQuo2+QEoxTisMBkDS6kJCRrfo9pLYEaIu7ceZwXixkVFDzvJszbEYt7M86lb0
         D32wrC5sPkwrLYWB9V0sT6MkFoUkfGWbLrry/LcG7b0N83uAju9x5cl5Oqr6cMq65ZGr
         TUwqCU/oqAoepN76pNBZAruvrnCQnF6h5cLckgwfgdu8NJsBDDZpDA817+bzhiwTcvRU
         VZRXtEGvux2h3T8DDuryclPq021dalMRwcigoMsN7o6RytCAiYE4TQIWoSe0TCHmRXSH
         L1RZQUms0VcilaM6yyC5h65/WY8ui/5twlIKzgMcy8B3OgDDJHKOp2yv8G5lqgP7O5Ch
         T/kQ==
MIME-Version: 1.0
X-Received: by 10.202.9.142 with SMTP id 136mr7899631oij.89.1417736427507;
 Thu, 04 Dec 2014 15:40:27 -0800 (PST)
Received: by 10.60.37.103 with HTTP; Thu, 4 Dec 2014 15:40:27 -0800 (PST)
In-Reply-To: <5480EE4B.7010001@yahoo.com>
References: <5480EE4B.7010001@yahoo.com>
Date: Thu, 4 Dec 2014 23:40:27 +0000
Message-ID: <CA+nPnMzqNH0zKT3spQYBEGHiKMAU7-P7n-JeQhYofTpO75WpGw@mail.gmail.com>
Subject: Re: Using shaded JAR as a dependency in a WAR module
From: Stephen Connolly <stephen.alan.connolly@gmail.com>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=001a113d1d942598f705096c7cb8
X-Virus-Checked: Checked by ClamAV on apache.org

--001a113d1d942598f705096c7cb8
Content-Type: text/plain; charset=UTF-8

DependencyReducedPom

On Thursday, 4 December 2014, Mark Eggers <its_toasted@yahoo.com.invalid>
wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Folks,
>
> I admit it, I'm a bit confused (and relatively new to maven).
>
> Goal:
>
> To release a WAR file with a minimal number of JAR files in WEB-INF/lib.
>
> Thought:
>
> 1. Break up the WAR project into a WAR module and a JAR module
> 2. Make the WAR module be dependent on the JAR module
> 3. Use the Maven shade plugin in the JAR module to create a shaded JAR
> 4. Drive the entire project with an agregator pom.xml
>
> The JAR module does shade properly, creating a single JAR with all of
> the dependencies bundled into a single JAR. It uses a pom dependency
> to gather in most of its requirements. None of the JAR or pom
> dependencies have further dependencies, so the resulting JAR is
> self-contained.
>
> However, when I build the WAR file and reference the shaded JAR file
> as a dependency, I do not get the shaded JAR file in WEB-INF/lib.
> Instead, I get all of the dependencies as individual JAR files in
> WEB-INF/lib.
>
> I'm using the following environment (can post my complete pom.xml
> files if needed).
>
> OS:    Fedora Linux 64 bit - latest updates
> JDK:   1.7.0_72 64 bit
> Maven: 3.2.3
>
> maven-shade-plugin: 2.3
> maven-war-plugin:   2.4
>
> shade configuration and dependencies for
> org.mdeggers:IFCResources:1.0-SNAPSHOT
>
> <properties>
>     <calhost.version>1.0-SNAPSHOT</calhost.version>
>     <ihomeresources.version>1.0-SNAPSHOT</ihomeresources.version>
> </properties>
>
> <dependencies>
>     <dependency>
>         <groupId>org.mdeggers</groupId>
>         <artifactId>Calhost</artifactId>
>         <version>${calhost.version}</version>
>     </dependency>
>     <dependency>
>         <groupId>org.mdeggers</groupId>
>         <artifactId>IHomeResources</artifactId>
>         <version>${ihomeresources.version}</version>
>         <type>pom</type>
>     </dependency>
> </dependencies>
>
> <plugin>
>     <groupId>org.apache.maven.plugins</groupId>
>     <artifactId>maven-shade-plugin</artifactId>
>     <version>2.3</version>
>     <executions>
>         <execution>
>             <id>combine</id>
>             <phase>package</phase>
>             <goals>
>                 <goal>shade</goal>
>             </goals>
>             <configuration>
>                 <artifactSet>
>                     <includes>
>                         <include>org.mdeggers:*</include>
>                     </includes>
>                 </artifactSet>
>             </configuration>
>          </execution>
>     </executions>
> </plugin>
>
> Partial dependencies for org.mdeggers:iforeclosure:1.0-SNAPSHOT:war
>
> <dependencies>
>     <dependency>
>         <groupId>org.mdeggers</groupId>
>         <artifactId>IFCResources</artifactId>
>         <version>1.0-SNAPSHOT</version>
>     </dependency>
> </dependencies>
>
> Parent pom modules section:
>
> <modules>
>     <module>IFCResources</module>
>     <module>iforeclosure</module>
> </modules>
>
> I'm obviously missing something here. Thoughts, corrections, pointers
> are all appreciated.
>
> I know, using a shaded JAR as a dependency is probably not best
> practice. However, the resulting WAR file is an end product and the
> shaded JAR only contains internal components from other web overlays
> used to build the final war.
>
> . . . just my (confused) 2 cents
> /mde/
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2
>
> iQEcBAEBAgAGBQJUgO5LAAoJEEFGbsYNeTwt9YgIAKLuOll7rpDRI4Ea3ieshWgY
> HugkUrvaja1UZdKkFm0bdo4qQxUUmKHL9byHTQzPiLb6+WKeXaaQaMDvhA0DgbAp
> tJQ+4WKEPBzKx5MUvftY2oEiW8eVEnMIkZ6qLA0aPKxrenodlekz3eKlxJ/D8kxF
> dqf5UvncIYGNlzbThVlFaOpmp7FgF6dStrBDPuyGdhcLWpb4UkI/sVqo92/copnY
> tMR2uX9/Uscn+11pXlcTTg+YfGGwlguZIEkSBRlUBiAYMwiDG0fyDqRaVcv18BtS
> /iLB6hlB8xNkRArvIpDV+h7W2sHK6jekjzfCU80ZO72ZSgsiYUKMqWlY04GlPTU=
> =jCy7
> -----END PGP SIGNATURE-----
>
> ---
> This email is free from viruses and malware because avast! Antivirus
> protection is active.
> http://www.avast.com
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org <javascript:;>
> For additional commands, e-mail: users-help@maven.apache.org
> <javascript:;>
>
>

-- 
Sent from my phone

--001a113d1d942598f705096c7cb8--

