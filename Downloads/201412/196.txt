From users-return-138092-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Mon Dec 29 10:20:51 2014
Return-Path: <users-return-138092-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7E2A110BCA
	for <apmail-maven-users-archive@www.apache.org>; Mon, 29 Dec 2014 10:20:51 +0000 (UTC)
Received: (qmail 95245 invoked by uid 500); 29 Dec 2014 10:20:49 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 95162 invoked by uid 500); 29 Dec 2014 10:20:49 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 95150 invoked by uid 99); 29 Dec 2014 10:20:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 Dec 2014 10:20:47 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of waterlx@gmail.com designates 209.85.216.169 as permitted sender)
Received: from [209.85.216.169] (HELO mail-qc0-f169.google.com) (209.85.216.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 29 Dec 2014 10:20:18 +0000
Received: by mail-qc0-f169.google.com with SMTP id w7so9296134qcr.14
        for <users@maven.apache.org>; Mon, 29 Dec 2014 02:18:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=7R1CR1Af5gXpp+C26JmXvWjd4tK7gJblCnVzOM2k59o=;
        b=oJKrxmY+Gbwc+UF/CoyOuN9s9UUrKvRZUSy8sXU23pyHtge6Xhtn5c8EwgDHgfQ6k1
         kUxr+jlvqBBqN77sEzgezUx9B6a43U27tphbb4CjRevgy8/b22gyjDghn+U6iD78wMJF
         kzJaO5P6szWRSGA6u2azrvjhZNtkHdQy6HIbXxSxtp+NYsioppedIf1Cq5vVLzPmoSQ0
         F/oi/B7qL0Qe9WIL4IUXyy2xXbIVXxWGABsXEcrpMOi/61oc1RhBTWd8BQjFyuXeKZeM
         xpgqWfOompf8OI/qu5tbbYnjmce41LA9vwbohaak+k+VHbG9g8ldLzTNKsKj0WHPozui
         qUDA==
MIME-Version: 1.0
X-Received: by 10.140.85.231 with SMTP id n94mr23621286qgd.63.1419848281543;
 Mon, 29 Dec 2014 02:18:01 -0800 (PST)
Received: by 10.96.130.164 with HTTP; Mon, 29 Dec 2014 02:18:01 -0800 (PST)
Date: Mon, 29 Dec 2014 18:18:01 +0800
Message-ID: <CAPcmo=5tq75JvOq2YJeXfDRiTLQnxbcb6GKJbErT+HsmW=676A@mail.gmail.com>
Subject: Set system property by -Dxxx=xxx vs. in java source file. Why it does
 not work if setting in java source file ?
From: =?UTF-8?B?5p2O5ZON?= <waterlx@gmail.com>
To: users@maven.apache.org
Content-Type: multipart/alternative; boundary=001a11c14db674edaa050b5830ba
X-Virus-Checked: Checked by ClamAV on apache.org

--001a11c14db674edaa050b5830ba
Content-Type: text/plain; charset=UTF-8

Hi, I am using IBM JDK 7.1-2.0. Because SSL v3 is disabled by the JDK, so I
need to set com.ibm.jsse2.disableSSLv3 to false to enable it when running
some test cases.

The project is managed by maven. I tried with:

1. mvn xxxx -Dcom.ibm.jsse2.disableSSLv3=false, or add
<com.ibm.jsse2.disableSSLv3>false</com.ibm.jsse2.disableSSLv3> into
<systemPropertyVariables> of pom.xml.

  It works.

2. Modify the java source file of the test case
   I used : String old=System.setProperty("com.ibm.jsse2.disableSSLv3",
"false") and got the exception:

Caused by: java.lang.IllegalArgumentException: Only SSLv3 was enabled while
com.ibm.jsse2.disableSSLv3 is set to true (It should be "false" here, seems
a JDK bug, never mind)
        at com.ibm.jsse2.pb.a(pb.java:17)
        at com.ibm.jsse2.pb.<init>(pb.java:7)
        at com.ibm.jsse2.qc.setEnabledProtocols(qc.java:689)
        at
org.apache.flume.source.http.TestHTTPSource$DisabledProtocolsSocketFactory.createSocket(TestHTTPSource.java:514)
<-- sc.setEnabledProtocols(protocols), sc is an instance of SSLSocket
        at com.ibm.net.ssl.www2.protocol.https.c.afterConnect(c.java:7)
        at com.ibm.net.ssl.www2.protocol.https.d.connect(d.java:9)
        at
sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1103)
        at com.ibm.net.ssl.www2.protocol.https.b.getOutputStream(b.java:84)
        at
org.apache.flume.source.http.TestHTTPSource.doTestHttps(TestHTTPSource.java:392)
        at
org.apache.flume.source.http.TestHTTPSource.testHttpsSSLv3(TestHTTPSource.java:321)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:95)
        at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:56)
        at java.lang.reflect.Method.invoke(Method.java:620)
        at
org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
        at
org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
        at
org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
        at
org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
        at
org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:22)
        ... 24 more

   I printed the value of com.ibm.jsse2.disableSSLv3 before the line
514 of TestHTTPSource.java,
and com.ibm.jsse2.disableSSLv3 is false, as expected.

  It seems that com.ibm.jsse2.disableSSLv3=false do not take effect here.
Why ???? Is it because the program gets out of TestHTTPSource.java and get
into JDK, or something else, so the system property does not take effect ??

THANKS IN ADVANCE !

--001a11c14db674edaa050b5830ba--

