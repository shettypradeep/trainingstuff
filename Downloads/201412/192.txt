From users-return-137934-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Dec  5 04:42:18 2014
Return-Path: <users-return-137934-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 87830101CE
	for <apmail-maven-users-archive@www.apache.org>; Fri,  5 Dec 2014 04:42:18 +0000 (UTC)
Received: (qmail 42158 invoked by uid 500); 5 Dec 2014 04:42:16 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 42082 invoked by uid 500); 5 Dec 2014 04:42:16 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 42067 invoked by uid 99); 5 Dec 2014 04:42:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 Dec 2014 04:42:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [24.37.79.202] (HELO smtp.artifact-software.com) (24.37.79.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 Dec 2014 04:41:50 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by smtp.artifact-software.com (Postfix) with ESMTP id D64516A6583
	for <users@maven.apache.org>; Thu,  4 Dec 2014 23:41:17 -0500 (EST)
X-Virus-Scanned: amavisd-new at artifact-software.com
Received: from smtp.artifact-software.com ([127.0.0.1])
	by localhost (smtp.artifact-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id qvAqm7_AchX4 for <users@maven.apache.org>;
	Thu,  4 Dec 2014 23:41:17 -0500 (EST)
Received: from [192.168.3.170] (unknown [192.168.3.170])
	by smtp.artifact-software.com (Postfix) with ESMTP id 8CF6D6A6582
	for <users@maven.apache.org>; Thu,  4 Dec 2014 23:41:17 -0500 (EST)
Message-ID: <5481376B.9030305@artifact-software.com>
Date: Thu, 04 Dec 2014 23:41:15 -0500
From: Ron Wheeler <rwheeler@artifact-software.com>
Reply-To: Maven Users List <users@maven.apache.org>
Organization: Artifact Software
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Thunderbird/24.6.0
MIME-Version: 1.0
To: users@maven.apache.org
Subject: Re: Using shaded JAR as a dependency in a WAR module
References: <5480EE4B.7010001@yahoo.com>
In-Reply-To: <5480EE4B.7010001@yahoo.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

We do this all the time and it always works.
http://blog.artifact-software.com/tech/?p=121 Aggregation jars make development simpler and wars smaller


Partial dependencies for org.mdeggers:iforeclosure:1.0-SNAPSHOT:war

<dependencies>
     <dependency>
         <groupId>org.mdeggers</groupId>
         <artifactId>IFCResources</artifactId>
         <version>1.0-SNAPSHOT</version>
     </dependency>
</dependencies>

What are the dependencies for the war file? Partial list is not much help.

Ron


On 04/12/2014 6:29 PM, Mark Eggers wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Folks,
>
> I admit it, I'm a bit confused (and relatively new to maven).
>
> Goal:
>
> To release a WAR file with a minimal number of JAR files in WEB-INF/lib.
>
> Thought:
>
> 1. Break up the WAR project into a WAR module and a JAR module
> 2. Make the WAR module be dependent on the JAR module
> 3. Use the Maven shade plugin in the JAR module to create a shaded JAR
> 4. Drive the entire project with an agregator pom.xml
>
> The JAR module does shade properly, creating a single JAR with all of
> the dependencies bundled into a single JAR. It uses a pom dependency
> to gather in most of its requirements. None of the JAR or pom
> dependencies have further dependencies, so the resulting JAR is
> self-contained.
>
> However, when I build the WAR file and reference the shaded JAR file
> as a dependency, I do not get the shaded JAR file in WEB-INF/lib.
> Instead, I get all of the dependencies as individual JAR files in
> WEB-INF/lib.
>
> I'm using the following environment (can post my complete pom.xml
> files if needed).
>
> OS:    Fedora Linux 64 bit - latest updates
> JDK:   1.7.0_72 64 bit
> Maven: 3.2.3
>
> maven-shade-plugin: 2.3
> maven-war-plugin:   2.4
>
> shade configuration and dependencies for
> org.mdeggers:IFCResources:1.0-SNAPSHOT
>
> <properties>
>      <calhost.version>1.0-SNAPSHOT</calhost.version>
>      <ihomeresources.version>1.0-SNAPSHOT</ihomeresources.version>
> </properties>
>
> <dependencies>
>      <dependency>
>          <groupId>org.mdeggers</groupId>
>          <artifactId>Calhost</artifactId>
>          <version>${calhost.version}</version>
>      </dependency>
>      <dependency>
>          <groupId>org.mdeggers</groupId>
>          <artifactId>IHomeResources</artifactId>
>          <version>${ihomeresources.version}</version>
>          <type>pom</type>
>      </dependency>
> </dependencies>
>
> <plugin>
>      <groupId>org.apache.maven.plugins</groupId>
>      <artifactId>maven-shade-plugin</artifactId>
>      <version>2.3</version>
>      <executions>
>          <execution>
>              <id>combine</id>
>              <phase>package</phase>
>              <goals>
>                  <goal>shade</goal>
>              </goals>
>              <configuration>
>                  <artifactSet>
>                      <includes>
>                          <include>org.mdeggers:*</include>
>                      </includes>
>                  </artifactSet>
>              </configuration>
>           </execution>
>      </executions>
> </plugin>
>
> Partial dependencies for org.mdeggers:iforeclosure:1.0-SNAPSHOT:war
>
> <dependencies>
>      <dependency>
>          <groupId>org.mdeggers</groupId>
>          <artifactId>IFCResources</artifactId>
>          <version>1.0-SNAPSHOT</version>
>      </dependency>
> </dependencies>
>
> Parent pom modules section:
>
> <modules>
>      <module>IFCResources</module>
>      <module>iforeclosure</module>
> </modules>
>
> I'm obviously missing something here. Thoughts, corrections, pointers
> are all appreciated.
>
> I know, using a shaded JAR as a dependency is probably not best
> practice. However, the resulting WAR file is an end product and the
> shaded JAR only contains internal components from other web overlays
> used to build the final war.
>
> . . . just my (confused) 2 cents
> /mde/
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2
>
> iQEcBAEBAgAGBQJUgO5LAAoJEEFGbsYNeTwt9YgIAKLuOll7rpDRI4Ea3ieshWgY
> HugkUrvaja1UZdKkFm0bdo4qQxUUmKHL9byHTQzPiLb6+WKeXaaQaMDvhA0DgbAp
> tJQ+4WKEPBzKx5MUvftY2oEiW8eVEnMIkZ6qLA0aPKxrenodlekz3eKlxJ/D8kxF
> dqf5UvncIYGNlzbThVlFaOpmp7FgF6dStrBDPuyGdhcLWpb4UkI/sVqo92/copnY
> tMR2uX9/Uscn+11pXlcTTg+YfGGwlguZIEkSBRlUBiAYMwiDG0fyDqRaVcv18BtS
> /iLB6hlB8xNkRArvIpDV+h7W2sHK6jekjzfCU80ZO72ZSgsiYUKMqWlY04GlPTU=
> =jCy7
> -----END PGP SIGNATURE-----
>
> ---
> This email is free from viruses and malware because avast! Antivirus protection is active.
> http://www.avast.com
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
> For additional commands, e-mail: users-help@maven.apache.org
>
>


-- 
Ron Wheeler
President
Artifact Software Inc
email: rwheeler@artifact-software.com
skype: ronaldmwheeler
phone: 866-970-2435, ext 102


---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


