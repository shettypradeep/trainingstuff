From users-return-137942-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Dec  5 17:04:44 2014
Return-Path: <users-return-137942-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A3E73100FC
	for <apmail-maven-users-archive@www.apache.org>; Fri,  5 Dec 2014 17:04:44 +0000 (UTC)
Received: (qmail 36269 invoked by uid 500); 5 Dec 2014 17:04:43 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 36183 invoked by uid 500); 5 Dec 2014 17:04:43 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 36171 invoked by uid 99); 5 Dec 2014 17:04:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 Dec 2014 17:04:42 +0000
X-ASF-Spam-Status: No, hits=1.0 required=5.0
	tests=FORGED_YAHOO_RCVD,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of its_toasted@yahoo.com designates 98.138.91.178 as permitted sender)
Received: from [98.138.91.178] (HELO nm18-vm4.bullet.mail.ne1.yahoo.com) (98.138.91.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 05 Dec 2014 17:04:15 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=GU4OVdULgJmEF9ddCn1Dkfl1T+IaG7FpiABoSCSiThzUq+jq4JPRybnMQkleemLxLI+csNVPwt6TWdjOFLXqKd9Xj7eSPH/lA/ZbegWuFp1jbr2zu2y2PFOpAtaOK3oWXnAWwAgiTJQI4K3hcyp0ZEFVxcoYFQR3GGV5uCqo9C2ApKKh3n3oRact1FJr8ExiWDfn8IBk48XqjnGQri9XF4eanPlmHuLKagJjpB9n1jWGJhM5ak8af+jgHyTnamQITVBNmPqu8OZ4xGgRjSS+OZaExLRwFkyr1nfR9RsM1S2JQxVdwiigajpNQzphOgph4PgzDWBlY+auF4/HcTPI+A==;
Received: from [98.138.226.180] by nm18.bullet.mail.ne1.yahoo.com with NNFMP; 05 Dec 2014 17:04:14 -0000
Received: from [98.138.226.58] by tm15.bullet.mail.ne1.yahoo.com with NNFMP; 05 Dec 2014 17:04:14 -0000
Received: from [127.0.0.1] by smtp209.mail.ne1.yahoo.com with NNFMP; 05 Dec 2014 17:04:13 -0000
X-Yahoo-Newman-Id: 992171.93025.bm@smtp209.mail.ne1.yahoo.com
X-Yahoo-Newman-Property: ymail-3
X-YMail-OSG: oKZbjJgVM1kF1Y4ywFUfuuhLnw2Pa5aEdLDxpEqmq02tuMr
 b1zqCYMea2FvrLbzZIC67vs_SvYRGyShP6oRcImz11PieJVC4BBI2stulVeN
 sxBJ37K.yFyztG7GlivqsGGY6GTNmGhRkswoTIilKYO0ceoSeLjyKG4bug5l
 bGhEvIk5FvWhXzKlfz.Au8hvaqM8oODSEmk9UpuPo_gn9hIJ.GFb5ROrg33h
 SqaEQR7DWE1hgp3lj7JgfsWrrAzKSHqk0u6fmZNnY8qLSdo0CW4RQGaQcnYF
 yGGwQP.cnBC5ghRrXiHTi8hA_MJoNpEd_0Fyz3Ud1gcTnEN22Xg8Iv0FXD0f
 Z8.jzu7P2jZ8HFYHGYlZFpatRXf4Jf2AZj3U626sd2pUqDym1DgXRLOqtVmq
 YHyfHoOvUPt13MEyLXfn7gcJpEN3FVjuHbXMKSF.vx5Gxn28afPT1x._fdDX
 n3ncXAqGgjoPcAautgMteV_Bj0zBOeAX1HzFU0pBPqcqXTUjZ_vPnSMYAVDV
 9AGpLhciY1IoBcrE8IJMAvZjeeC2KIxNkFp1JhMWYKTnHecw25h6QyDl9RIs
 GA7bA0QGDpYsgzghi.Bix4ZkeeNcYo5nL0Md.J0YbW9TaLg9d_P.2zFlY_9X
 dN8.YOumT3SdbELEO6r2jRuS3X470GoHtUJIVTJjrFQFyxrwFWMjcBnWOug-
 -
X-Yahoo-SMTP: PKuT8k2swBCeFOHzkGy5rTOUTa2hBxlR
Message-ID: <5481E583.9090003@yahoo.com>
Date: Fri, 05 Dec 2014 09:04:03 -0800
From: Mark Eggers <its_toasted@yahoo.com.INVALID>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Thunderbird/31.3.0
MIME-Version: 1.0
To: Maven Users List <users@maven.apache.org>
Subject: Re: Using shaded JAR as a dependency in a WAR module
References: <5480EE4B.7010001@yahoo.com> <5481376B.9030305@artifact-software.com>
In-Reply-To: <5481376B.9030305@artifact-software.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Antivirus: avast! (VPS 141205-1, 12/05/2014), Outbound message
X-Antivirus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Ron,

Thanks for the link. I'm attempting to do this with the shade plugin.
I took a look at the JAR that the shade plugin generates with my
configuration, and it seems to have the pom.xml files from which it
was built, but not the reduced dependency pom.xml (or any pom.xml from
the built / shaded artifact).

This means that I have not configured the shade plugin properly to
produce an artifact that can be consumed as if it was built without
using the shade plugin.

The entire list of dependencies for the WAR module:

<dependencies>
    <dependency>
        <groupId>org.mdeggers</groupId>
        <artifactId>CoreServer</artifactId>
        <version>${coreserver.version}</version>
    </dependency>
    <dependency>
        <groupId>org.mdeggers</groupId>
        <artifactId>CoreClient</artifactId>
        <version>${coreclient.version}</version>
        <type>war</type>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet.jsp</groupId>
        <artifactId>jsp-api</artifactId>
        <version>2.1</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>org.mdeggers</groupId>
        <artifactId>GlobalCalcWeb</artifactId>
        <version>${globalweb.version}</version>
        <type>war</type>
    </dependency>
    <dependency>
        <groupId>org.mdeggers</groupId>
        <artifactId>IHomeWeb</artifactId>
        <version>${ihome.version}</version>
        <type>pom</type>
    </dependency>
    <dependency>
        <groupId>org.mdeggers</groupId>
        <artifactId>IFCResources</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
</dependencies>

There could be as many as 50 components going into the final WAR file,
so it would be nice to manage them in a more organized fashion (as
well as reduce the clutter in WEB-INF/lib).

All of the versions with properties have properties defined. The last
dependency is the shaded JAR, and the one that is not behaving as
expected (but probably as built / configured).

The NetBeans graphical display of the dependencies shows IFCResources,
as well as the three components it was shaded from.

Sorry for the top-post. It seems to be the norm on this list, whereas
the Tomcat mailing list explicitly mentions replying at the bottom. I
didn't see any mention of posting style on the site. If posting at the
bottom is the encouraged form, I'll be happy to do so.

. . . just my two cents
/mde/

On 12/4/2014 8:41 PM, Ron Wheeler wrote:
> We do this all the time and it always works. 
> http://blog.artifact-software.com/tech/?p=121 Aggregation jars make
> development simpler and wars smaller
> 
> 
> Partial dependencies for 
> org.mdeggers:iforeclosure:1.0-SNAPSHOT:war
> 
> <dependencies> <dependency> <groupId>org.mdeggers</groupId> 
> <artifactId>IFCResources</artifactId> 
> <version>1.0-SNAPSHOT</version> </dependency> </dependencies>
> 
> What are the dependencies for the war file? Partial list is not 
> much help.
> 
> Ron
> 
> 
> On 04/12/2014 6:29 PM, Mark Eggers wrote: Folks,
> 
> I admit it, I'm a bit confused (and relatively new to maven).
> 
> Goal:
> 
> To release a WAR file with a minimal number of JAR files in 
> WEB-INF/lib.
> 
> Thought:
> 
> 1. Break up the WAR project into a WAR module and a JAR module 2. 
> Make the WAR module be dependent on the JAR module 3. Use the
> Maven shade plugin in the JAR module to create a shaded JAR 4.
> Drive the entire project with an agregator pom.xml
> 
> The JAR module does shade properly, creating a single JAR with all 
> of the dependencies bundled into a single JAR. It uses a pom 
> dependency to gather in most of its requirements. None of the JAR 
> or pom dependencies have further dependencies, so the resulting
> JAR is self-contained.
> 
> However, when I build the WAR file and reference the shaded JAR 
> file as a dependency, I do not get the shaded JAR file in 
> WEB-INF/lib. Instead, I get all of the dependencies as individual 
> JAR files in WEB-INF/lib.
> 
> I'm using the following environment (can post my complete pom.xml 
> files if needed).
> 
> OS:    Fedora Linux 64 bit - latest updates JDK:   1.7.0_72 64 bit
>  Maven: 3.2.3
> 
> maven-shade-plugin: 2.3 maven-war-plugin:   2.4
> 
> shade configuration and dependencies for 
> org.mdeggers:IFCResources:1.0-SNAPSHOT
> 
> <properties> <calhost.version>1.0-SNAPSHOT</calhost.version> 
> <ihomeresources.version>1.0-SNAPSHOT</ihomeresources.version> 
> </properties>
> 
> <dependencies> <dependency> <groupId>org.mdeggers</groupId> 
> <artifactId>Calhost</artifactId> 
> <version>${calhost.version}</version> </dependency> <dependency> 
> <groupId>org.mdeggers</groupId> 
> <artifactId>IHomeResources</artifactId> 
> <version>${ihomeresources.version}</version> <type>pom</type> 
> </dependency> </dependencies>
> 
> <plugin> <groupId>org.apache.maven.plugins</groupId> 
> <artifactId>maven-shade-plugin</artifactId> <version>2.3</version>
>  <executions> <execution> <id>combine</id> <phase>package</phase> 
> <goals> <goal>shade</goal> </goals> <configuration> <artifactSet> 
> <includes> <include>org.mdeggers:*</include> </includes> 
> </artifactSet> </configuration> </execution> </executions> 
> </plugin>
> 
> Partial dependencies for 
> org.mdeggers:iforeclosure:1.0-SNAPSHOT:war
> 
> <dependencies> <dependency> <groupId>org.mdeggers</groupId> 
> <artifactId>IFCResources</artifactId> 
> <version>1.0-SNAPSHOT</version> </dependency> </dependencies>
> 
> Parent pom modules section:
> 
> <modules> <module>IFCResources</module> 
> <module>iforeclosure</module> </modules>
> 
> I'm obviously missing something here. Thoughts, corrections, 
> pointers are all appreciated.
> 
> I know, using a shaded JAR as a dependency is probably not best 
> practice. However, the resulting WAR file is an end product and the
> shaded JAR only contains internal components from other web 
> overlays used to build the final war.
> 
> . . . just my (confused) 2 cents /mde/
>> 
>> --- This email is free from viruses and malware because avast! 
>> Antivirus protection is active. http://www.avast.com
>> 
>> 
>> ---------------------------------------------------------------------
>>
>>
>> 
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
>> For additional commands, e-mail: users-help@maven.apache.org
>> 
>> 
> 
> 

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQEcBAEBAgAGBQJUgeWDAAoJEEFGbsYNeTwtoTkH+wecGgNHc2VNaHxR8kp8PTXB
xHFRfI7VeD2wrQgwqyZSCnL1pJSbSLUvhHopIQslTiHO1Rbr84/L0o4DZe8z+m49
4Oty9Jz7soEP+b0PnhomErNMD7aPsjtPjsAT59rYS4zlbT5FkphauYzFxfdnmCfC
OCykAIN/dUgNRL0RlUfAX207RHLAx1Kvz3gHhxsMPgLr9HqFaBBHipGh2ZIv+jog
reGqqmK0px2UoH1oniXREJ9fpMCB09dbQEX5UwtAHKgCeAvEblMLosxFuWH3fL/U
VyjiaQNUZwt8pwhDeV1vCjQceOluooFgnYhn95pMxvnrDNHiHP4e+OxKiiczzqU=
=2b8i
-----END PGP SIGNATURE-----

---
This email is free from viruses and malware because avast! Antivirus protection is active.
http://www.avast.com


---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


