From users-return-137271-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Sep 12 18:30:48 2014
Return-Path: <users-return-137271-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A4D40113E4
	for <apmail-maven-users-archive@www.apache.org>; Fri, 12 Sep 2014 18:30:48 +0000 (UTC)
Received: (qmail 86014 invoked by uid 500); 12 Sep 2014 18:30:47 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 85929 invoked by uid 500); 12 Sep 2014 18:30:47 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 85918 invoked by uid 99); 12 Sep 2014 18:30:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 Sep 2014 18:30:46 +0000
X-ASF-Spam-Status: No, hits=2.2 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.223.171] (HELO mail-ie0-f171.google.com) (209.85.223.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 12 Sep 2014 18:30:41 +0000
Received: by mail-ie0-f171.google.com with SMTP id y20so1435644ier.16
        for <users@maven.apache.org>; Fri, 12 Sep 2014 11:30:20 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:content-type:message-id:mime-version
         :subject:date:references:to:in-reply-to;
        bh=sGrnr+Or1sApdzVU3ygdW4Yd6CQFd70sjXjuGfkwXCw=;
        b=Hp4rQLTAvKo7fv+pzSdgXBr6RlYLIM5SdTOyJIWFUrtC+iiK7z6MxW6CrHjJPpLkrc
         YXwurn98z/P8NsgPEiNuktAyS4QkVjsSrH6KmuuscunHrxQd702r+j5TIZu38L0E61Mo
         T8/ph21c28nhk5NH06ynKfZ3Mocs5Dx7wCd4RNv0Zhjva7CCo+JnAO8X66oRN3ZHNRHe
         4nrRjyYoK1brcJ1A6ci1znbibC8lb5cRxTpQ8uw1iCyyj00A9MonaQyPL1eqXTiRpuDR
         It6mkD90XLeJpWtVwqRgWNeh+TPv4kpZZPUK/uzugGjt0GfmzObwszHV6nPKOw1jBeZK
         mUdg==
X-Gm-Message-State: ALoCoQkQPZfxjl4G6qRiUQOgbTTOGiAzmlwOiHGQ/FljPvL6X8fr8YtCFVl1jAHVpeK4eiYKGLnY
X-Received: by 10.42.114.130 with SMTP id g2mr9435264icq.46.1410546620327;
        Fri, 12 Sep 2014 11:30:20 -0700 (PDT)
Received: from [10.0.1.11] (192-0-154-177.cpe.teksavvy.com. [192.0.154.177])
        by mx.google.com with ESMTPSA id ig9sm2141503igb.13.2014.09.12.11.30.19
        for <users@maven.apache.org>
        (version=TLSv1 cipher=ECDHE-RSA-RC4-SHA bits=128/128);
        Fri, 12 Sep 2014 11:30:19 -0700 (PDT)
From: Jason van Zyl <jason@takari.io>
Content-Type: multipart/alternative; boundary="Apple-Mail=_13987204-73A5-4AFA-99B5-76E45EF2A39A"
Message-Id: <0A88A403-A4B6-4A9A-8428-22576FB54D3E@takari.io>
Mime-Version: 1.0 (Mac OS X Mail 7.3 \(1878.6\))
Subject: Re: forking plugin execution?
Date: Fri, 12 Sep 2014 14:30:18 -0400
References: <CAAZU44=eHA=2xAgPjU_HT9E5TE+XELDUPx+fZrowDO2vwu9oFQ@mail.gmail.com>
To: Maven Users List <users@maven.apache.org>
In-Reply-To: <CAAZU44=eHA=2xAgPjU_HT9E5TE+XELDUPx+fZrowDO2vwu9oFQ@mail.gmail.com>
X-Mailer: Apple Mail (2.1878.6)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail=_13987204-73A5-4AFA-99B5-76E45EF2A39A
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=windows-1252


On Sep 12, 2014, at 2:22 PM, Kevin Burton <burton@spinn3r.com> wrote:

> Is it possible to fork plugin execution so that it executes in a =
separate
> process?
>=20

No. Not unless the plugin supports forked execution. I'm not sure we'd =
ever want to support this anyway. Looks like it's loading two copies of =
the classes, or the thread context classloader is getting confused. If =
you can make a small self-contained project that reproduces the problem =
I can take a look.

> I think doxia+markdown has a threading bug with peg down.
>=20
> I get the attached exception.
>=20
> Works fine with default options but -T 8 breaks it.
>=20
> I assume if I just have the site plugin in a separate proc that it =
will
> probably work since I won=92t have two site builds stepping on each =
other.
>=20
>=20
> java.lang.ClassCastException: java.lang.Integer cannot be cast to
> org.pegdown.ast.SuperNode
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:353)
>=20
> at =
org.parboiled.matchers.SequenceMatcher.match(SequenceMatcher.java:46)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.OneOrMoreMatcher.match(OneOrMoreMatcher.java:38)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.SequenceMatcher.match(SequenceMatcher.java:46)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at org.parboiled.matchers.FirstOfMatcher.match(FirstOfMatcher.java:41)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.SequenceMatcher.match(SequenceMatcher.java:46)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at org.parboiled.matchers.FirstOfMatcher.match(FirstOfMatcher.java:41)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.SequenceMatcher.match(SequenceMatcher.java:46)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.SequenceMatcher.match(SequenceMatcher.java:46)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.ZeroOrMoreMatcher.match(ZeroOrMoreMatcher.java:39)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.SequenceMatcher.match(SequenceMatcher.java:46)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.matchers.SequenceMatcher.match(SequenceMatcher.java:46)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> at =
org.parboiled.parserunners.BasicParseRunner.run(BasicParseRunner.java:72)
>=20
> at
> =
org.parboiled.parserunners.ReportingParseRunner.runBasicMatch(ReportingPar=
seRunner.java:86)
>=20
> at
> =
org.parboiled.parserunners.ReportingParseRunner.run(ReportingParseRunner.j=
ava:66)
>=20
> at
> =
org.parboiled.parserunners.AbstractParseRunner.run(AbstractParseRunner.jav=
a:81)
>=20
> at org.pegdown.Parser.parseToParsingResult(Parser.java:1329)
>=20
> at org.pegdown.Parser.parseInternal(Parser.java:1316)
>=20
> at org.pegdown.Parser.parse(Parser.java:78)
>=20
> at =
org.pegdown.PegDownProcessor.parseMarkdown(PegDownProcessor.java:137)
>=20
> at
> =
org.apache.maven.doxia.module.markdown.MarkdownParser.parse(MarkdownParser=
.java:170)
>=20
> at org.apache.maven.doxia.DefaultDoxia.parse(DefaultDoxia.java:65)
>=20
> at
> =
org.apache.maven.doxia.siterenderer.DefaultSiteRenderer.renderDocument(Def=
aultSiteRenderer.java:398)
>=20
> at
> =
org.apache.maven.doxia.siterenderer.DoxiaDocumentRenderer.renderDocument(D=
oxiaDocumentRenderer.java:51)
>=20
> at
> =
org.apache.maven.doxia.siterenderer.DefaultSiteRenderer.renderModule(Defau=
ltSiteRenderer.java:311)
>=20
> at
> =
org.apache.maven.doxia.siterenderer.DefaultSiteRenderer.render(DefaultSite=
Renderer.java:129)
>=20
> at
> =
org.apache.maven.plugins.site.render.SiteMojo.renderDoxiaDocuments(SiteMoj=
o.java:261)
>=20
> at
> =
org.apache.maven.plugins.site.render.SiteMojo.renderLocale(SiteMojo.java:1=
72)
>=20
> at =
org.apache.maven.plugins.site.render.SiteMojo.execute(SiteMojo.java:141)
>=20
> at
> =
org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuild=
PluginManager.java:132)
>=20
> ... 14 more
>=20
> Caused by: java.lang.ClassCastException: java.lang.Integer cannot be =
cast
> to org.pegdown.ast.SuperNode
>=20
> at org.pegdown.Parser.addAsChild(Parser.java:1251)
>=20
> at org.pegdown.Action$mNyPdk1ujbVDZrIU.run(Unknown Source)
>=20
> at org.parboiled.matchers.ActionMatcher.match(ActionMatcher.java:96)
>=20
> at
> =
org.parboiled.parserunners.BasicParseRunner.match(BasicParseRunner.java:77=
)
>=20
> at org.parboiled.MatcherContext.runMatcher(MatcherContext.java:338)
>=20
> ... 65 more
>=20
>=20
> --=20
>=20
> Founder/CEO Spinn3r.com
> Location: *San Francisco, CA*
> blog: http://burtonator.wordpress.com
> =85 or check out my Google+ profile
> <https://plus.google.com/102718274791889610666/posts>
> <http://spinn3r.com>

Thanks,

Jason

----------------------------------------------------------
Jason van Zyl
Founder,  Apache Maven
http://twitter.com/jvanzyl
http://twitter.com/takari_io
---------------------------------------------------------

the course of true love never did run smooth ...

 -- Shakespeare










--Apple-Mail=_13987204-73A5-4AFA-99B5-76E45EF2A39A--

