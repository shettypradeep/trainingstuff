From users-return-137328-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Fri Sep 19 17:19:03 2014
Return-Path: <users-return-137328-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 83A071149E
	for <apmail-maven-users-archive@www.apache.org>; Fri, 19 Sep 2014 17:19:03 +0000 (UTC)
Received: (qmail 72261 invoked by uid 500); 19 Sep 2014 17:19:01 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 72183 invoked by uid 500); 19 Sep 2014 17:19:01 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 72169 invoked by uid 99); 19 Sep 2014 17:19:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 Sep 2014 17:19:01 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of carlspring@gmail.com designates 209.85.215.47 as permitted sender)
Received: from [209.85.215.47] (HELO mail-la0-f47.google.com) (209.85.215.47)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 19 Sep 2014 17:18:35 +0000
Received: by mail-la0-f47.google.com with SMTP id mc6so3521559lab.6
        for <users@maven.apache.org>; Fri, 19 Sep 2014 10:18:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=PRNPvl2ei+jMX+yYTs0hjINN8mb+3WhcQ8A/TS4xxpw=;
        b=yyCpMyOccckxtaFVp50l4fIGGIPfNn2tpkcIN/8r3GlLG/Oj5qVGbBDvJXzuwbv7pU
         KdrDq/eegu+sCvVq0bZtBOgBQrfIdDGAyylEXq7v4UehfkFR+qGE5JvWnN7vkE3SK1bK
         OjcWPukzfuvr5sveuxTFW4R/lmWJhneKhMOBNhvqQqgzViDN9kgQuU3o+yS0Cta3/rMQ
         6ouS3DNQeC6ORKJsw2ZR5ANLxF3fWTYOUh48Uy979JCg9Rp+g9GUg9H4aEZtYzpzBUOC
         Hcl1SYaapFX3hnleVPxtYK1OxUX/W1xty6ZhiCWxcVaPRmbLumB0H6zCG4Y5EB+KSJ00
         9NvQ==
X-Received: by 10.152.9.37 with SMTP id w5mr8197435laa.28.1411147114971; Fri,
 19 Sep 2014 10:18:34 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.112.85.99 with HTTP; Fri, 19 Sep 2014 10:18:14 -0700 (PDT)
In-Reply-To: <CADN69ykruM0o3QPhBjW-wfcET+aTSTdvYkZiw9vtem_gFB-r3Q@mail.gmail.com>
References: <CAAZU44mmd5XNEbZaTMFt+UaixE19MXtAf5bSMTm9hB1Rt4yZ1Q@mail.gmail.com>
 <CADN69ykruM0o3QPhBjW-wfcET+aTSTdvYkZiw9vtem_gFB-r3Q@mail.gmail.com>
From: Martin Todorov <carlspring@gmail.com>
Date: Fri, 19 Sep 2014 18:18:14 +0100
Message-ID: <CANnZoJszHeTjS9OHbPPyyh_-B3EGLv0AOci3Soq9TWW1O7EQNA@mail.gmail.com>
Subject: Re: retrying flakey tests?
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=089e014946f48386ff05036e4add
X-Virus-Checked: Checked by ClamAV on apache.org

--089e014946f48386ff05036e4add
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

I agree with Curtis about the possible approach of doing a for loop. I'm
also aware of the fact that every corner case is a case of it's own and
that you sometimes need to be able to do things quick and dirty.

I had a manager who insisted I should simply ignore one of the test cases
he'd written, which was failing regularly only during releasing on our CI
server. He refused to fix the test for about a year and a half, as it was
"a flake". Eventually, it started hitting people big time, especially when
we moved to the cloud, and it turned out to be something which shouldn't
have been ignored at all...

In the end, it's all up to you, but I'd recommend playing it as safe as
possible! :-)

On Fri, Sep 19, 2014 at 6:08 PM, Curtis Rueden <ctrueden@wisc.edu> wrote:

> Hi Kevin,
>
> > Is there a way to retry a flakey test?
>
> In general I agree with Martin Todorov that tests should be small and
> atomic, and flakiness is a sign of larger problems. However, I also agree
> with you that sometimes flaky tests are a reality: my group has run into
> this with behavior of the JVM garbage collector differing on Windows, for
> example, in a rather nondeterministic way. In that case, retrying tests
> ~5-10 times was a good solution for us.
>
> But rather than configuring Surefire or Failsafe to do this, I'd suggest
> (if possible) to write it into the test itself. Put the test in a for loo=
p,
> and then assert at the end that numSuccesses > 0 or whatever. You then al=
so
> issue a warning if numSuccesses !=3D numAttempts, as you requested. In sh=
ort:
> it gives you the flexibility you need.
>
> Regards,
> Curtis
>
> On Fri, Sep 19, 2014 at 11:24 AM, Kevin Burton <burton@spinn3r.com> wrote=
:
>
> > Is there a way to retry a flakey test?
> >
> > I=E2=80=99d basically like to have a flag that retries a failing test 2=
 or 3
> times.
> >
> > Flakey and non deterministic tests are a fact of life in more complicat=
ed
> > systems.
> >
> > The main problem being that they are impossible to setup again because
> > they=E2=80=99re usually race conditions.
> >
> > If I could just retry the test a second time , that would solve this
> issue.
> >
> > Would be nice to have the build warned that the test is failing though.=
.
> >
> > --
> >
> > Founder/CEO Spinn3r.com
> > Location: *San Francisco, CA*
> > blog: http://burtonator.wordpress.com
> > =E2=80=A6 or check out my Google+ profile
> > <https://plus.google.com/102718274791889610666/posts>
> > <http://spinn3r.com>
> >
>

--089e014946f48386ff05036e4add--

