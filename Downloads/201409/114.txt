From users-return-137344-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Mon Sep 22 07:13:19 2014
Return-Path: <users-return-137344-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 95F5611EA1
	for <apmail-maven-users-archive@www.apache.org>; Mon, 22 Sep 2014 07:13:19 +0000 (UTC)
Received: (qmail 98504 invoked by uid 500); 22 Sep 2014 07:13:17 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 98411 invoked by uid 500); 22 Sep 2014 07:13:17 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 98399 invoked by uid 99); 22 Sep 2014 07:13:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 Sep 2014 07:13:17 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anders.g.hammar@gmail.com designates 74.125.82.172 as permitted sender)
Received: from [74.125.82.172] (HELO mail-we0-f172.google.com) (74.125.82.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 22 Sep 2014 07:13:12 +0000
Received: by mail-we0-f172.google.com with SMTP id p10so1954821wes.31
        for <users@maven.apache.org>; Mon, 22 Sep 2014 00:12:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:sender:in-reply-to:references:date:message-id:subject
         :from:to:content-type;
        bh=GtTV5LOsl43Av15EP7YQ3hAz+XEx/XHriDZWxZYLYKs=;
        b=1Ed9Tn1Clip9hyv4Ov3f8oEXh43R+QdNBd5qnDiAvZnyihIUh5ruDLzN3zC5ZrJi1g
         uJ8VRlkBWEYmPQegn6mAKUSfTTcIZwKyxq68o87j7tCTTp9jIm8A0vydZfEnaAk9CLwq
         RsnyouBCtEhDp+yPNhS2h3ruu9XxDMwKzmmP84/bs8WRirYG+lZMUDaLof2RA+ADEZuj
         6c624rDfNB+B4HJxlzUHapHZoTJRWaHZEt1qx5FVOdGPOyCRBh00F8reCtqzaaX70FMA
         4SaWtDEYSzZ7OhaPbNxAhFD+H6eMqp5dw2qLBcEl8uYTU/U2va/mWKyrKztutOC1McBE
         L48Q==
MIME-Version: 1.0
X-Received: by 10.194.203.105 with SMTP id kp9mr18719871wjc.41.1411369971104;
 Mon, 22 Sep 2014 00:12:51 -0700 (PDT)
Sender: anders.g.hammar@gmail.com
Received: by 10.194.174.225 with HTTP; Mon, 22 Sep 2014 00:12:51 -0700 (PDT)
In-Reply-To: <CAKuK4uE9D1bRtgMdvdSj255uVZgBLstirBVuM1jY1dUqeDOO2w@mail.gmail.com>
References: <CAKuK4uE9D1bRtgMdvdSj255uVZgBLstirBVuM1jY1dUqeDOO2w@mail.gmail.com>
Date: Mon, 22 Sep 2014 09:12:51 +0200
X-Google-Sender-Auth: V3bgJKa21KzwEtk656YN_vM-DQA
Message-ID: <CAKDUN1t5ZCcrhQ5+4mJqwzoDA0CvX6xHXPYcNaESejsFQLpipw@mail.gmail.com>
Subject: Re: Replacing token in WAR web.xml from EAR pom.xml
From: Anders Hammar <anders@hammar.net>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=047d7b6d8764c6429f0503a22d42
X-Virus-Checked: Checked by ClamAV on apache.org

--047d7b6d8764c6429f0503a22d42
Content-Type: text/plain; charset=UTF-8

The solution that comes to my mind is to have one common war module and
then use war overlays and create separat war modules for each "flavor" of
the webapp you need (one for each ear I guess). It means many modules
unfortunately, but is somewhat the Maven way.

Google on "maven war overlay" for more info.

/Anders

On Sat, Sep 20, 2014 at 5:16 AM, Grover Blue <grover.blue@gmail.com> wrote:

> Hello,  I'm new to maven, and trying to navigate all the plugins and
> syntax.  Forgive me if this has been asked previously, but I can't seem to
> things to work.
>
> I have a root/parent project that contains several EAR projects, all which
> use the same WAR project.  I need to customize the contents of web.xml for
> each EAR build/package.  I'm not clear on the steps to do this.  I tried
> copying my ANT script over to the pom, but even though I could update the
> copied web.war, it never carries over to the final *.ear package.
>
> Here is what I'm attempting (shortcut.targetFull and realmName are defined
> properties in this pom):
>
>     <build>
>         <plugins>
>             <plugin>
>                 <groupId>org.apache.maven.plugins</groupId>
>                 <artifactId>maven-antrun-plugin</artifactId>
>                 <version>1.7</version>
>                 <executions>
>
>
>
>
>
> *<execution>
> <id>rename-realm</id>
> <phase></phase>
> <configuration>
> <target>                                <unzip
> src="${shortcut.targetFull}/web-${project.version}.war" dest="${*
> *shortcut.targetFull}/web"/>                                <replace
> file="${*
> *shortcut.targetFull}/web/WEB-INF/web.xml" token="@REALM_NAME@"
> value="${realmName}"/>                                <delete file="${*
> *shortcut.targetFull}/web-${project.version}.war"/>
> <zip destfile="${**shortcut.targetFull}/web-${project.version}.war"
> basedir="${*
> *shortcut.targetFull}/web" />                                <delete
> dir="${*
>
>
>
>
>
> *shortcut.targetFull}/web" />
> </target>                        </configuration>
> <goals>
> <goal>run</goal>
> </goals>                    </execution>*
>                     <execution>
>                         <id>rename-package</id>
>                         <phase></phase>
>                         <configuration>
>                             <target>
>                                 <tstamp>
>                                     <format property="TODAY_BUILD"
> pattern="yyyyMMdd-HHmmss"  locale="en,US"/>
>                                 </tstamp>
>                                 <copy
> file="${project.build.directory}/${project.build.finalName}.ear"
> tofile="${project.build.directory}/${project.name
> }-${project.version}-${TODAY_BUILD}.ear"/>
>                             </target>
>                         </configuration>
>                     </execution>
>                 </executions>
>             </plugin>
>             <plugin>
>                 <groupId>org.apache.maven.plugins</groupId>
>                 <artifactId>maven-compiler-plugin</artifactId>
>                 <version>3.1</version>
>                 <configuration>
>                     <source>1.7</source>
>                     <target>1.7</target>
>                 </configuration>
>             </plugin>
>             <plugin>
>                 <groupId>org.apache.maven.plugins</groupId>
>                 <artifactId>maven-ear-plugin</artifactId>
>                 <version>2.9</version>
>                 <configuration>
>                     <version>6</version>
>                     <defaultLibBundleDir>lib</defaultLibBundleDir>
>                     <displayName>myweb</displayName>
>                     <initializeInOrder>true</initializeInOrder>
>                     <modules>
>                         <jarModule>
>                             <groupId>${project.groupId}</groupId>
>                             <artifactId>lib1</artifactId>
>
> <includeInApplicationXml>false</includeInApplicationXml>
>                         </jarModule>
>                         <ejbModule>
>                             <groupId>${project.groupId}</groupId>
>                             <artifactId>ejb1</artifactId>
>                         </ejbModule>
>                         <webModule>
>                             <groupId>${project.groupId}</groupId>
>                             <artifactId>web</artifactId>
>                             <contextRoot>/myweb</contextRoot>
>                         </webModule>
>                     </modules>
>                 </configuration>
>             </plugin>
>         </plugins>
>     </build>
>

--047d7b6d8764c6429f0503a22d42--

