From users-return-137333-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Sat Sep 20 15:44:50 2014
Return-Path: <users-return-137333-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7C26E11B0C
	for <apmail-maven-users-archive@www.apache.org>; Sat, 20 Sep 2014 15:44:50 +0000 (UTC)
Received: (qmail 39418 invoked by uid 500); 20 Sep 2014 15:44:48 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 39333 invoked by uid 500); 20 Sep 2014 15:44:48 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 39320 invoked by uid 99); 20 Sep 2014 15:44:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 20 Sep 2014 15:44:48 +0000
X-ASF-Spam-Status: No, hits=2.5 required=5.0
	tests=FREEMAIL_REPLY,HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of andreas.gudian@gmail.com designates 74.125.82.175 as permitted sender)
Received: from [74.125.82.175] (HELO mail-we0-f175.google.com) (74.125.82.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 20 Sep 2014 15:44:22 +0000
Received: by mail-we0-f175.google.com with SMTP id u57so189506wes.6
        for <users@maven.apache.org>; Sat, 20 Sep 2014 08:44:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=KIzYACkjGffFN/batVuvX/chDHj4UdAcdsz6UE7SRqI=;
        b=MPjOgxw59bpKvXHVCRbRVlq7GLlAcXMgXavDVIaOPFmTei+ZUmu6sQ1BYLuPbkIk3s
         PK7BrYH+73AXk1dpAABZOl/MdbluqXQAPBMoLniMkQQOiCVjM9C6W8rsxwDVoXJ1e6Qi
         pPjfoJ96GPeVltMCoyqGtlsfQK9K7QKAVa1NVW+qOMDRUF8I8kKRrCAlmgaolcntwCJh
         VzxNK9MWwQa+9OPcabGthW6OzK3tpNw0WCVihK7983ifjAHahAbkNuIxHuAHVCSPCYPE
         51GLAbrvnhQjWZZzvjvTpPlC5QOi60UFDN7GUFzoM814GD+5S4r+mTq+AShv/7JFXa7+
         qH2w==
MIME-Version: 1.0
X-Received: by 10.194.58.148 with SMTP id r20mr8694844wjq.66.1411227862020;
 Sat, 20 Sep 2014 08:44:22 -0700 (PDT)
Received: by 10.217.118.73 with HTTP; Sat, 20 Sep 2014 08:44:21 -0700 (PDT)
In-Reply-To: <CAAZU44mh-BJoKhoaSr-c62t3N_nCAvqO5APJ-_bjXpvODEgfDw@mail.gmail.com>
References: <CAAZU44mmd5XNEbZaTMFt+UaixE19MXtAf5bSMTm9hB1Rt4yZ1Q@mail.gmail.com>
	<CADN69ykruM0o3QPhBjW-wfcET+aTSTdvYkZiw9vtem_gFB-r3Q@mail.gmail.com>
	<CANnZoJszHeTjS9OHbPPyyh_-B3EGLv0AOci3Soq9TWW1O7EQNA@mail.gmail.com>
	<CAAZU44mh-BJoKhoaSr-c62t3N_nCAvqO5APJ-_bjXpvODEgfDw@mail.gmail.com>
Date: Sat, 20 Sep 2014 17:44:21 +0200
Message-ID: <CAK2FUK1-VWU3oaxuJ3C00iDnZdPCp8L5g7LtfKu=q4fbmo3uGA@mail.gmail.com>
Subject: Re: retrying flakey tests?
From: Andreas Gudian <andreas.gudian@gmail.com>
To: Maven Users List <users@maven.apache.org>
Content-Type: multipart/alternative; boundary=047d7bacbb7069b87805038117c0
X-Virus-Checked: Checked by ClamAV on apache.org

--047d7bacbb7069b87805038117c0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi there,

We had a pull request for such a feature and it was merged. It will be part
of our next release: https://jira.codehaus.org/browse/SUREFIRE
<https://jira.codehaus.org/browse/SUREFIRE-1087>-1087

I think the feature makes expecially sense for tracking flaky tests over a
longer period of time, as those flaky tests show up more nicely on the
surefire tester port xml files and can thus be tracked specifically in the
CI system.

Surefire 2.18 should be out in the next couple of weeks.

Hth,
Andreas

Am Samstag, 20. September 2014 schrieb Kevin Burton :

> The loop idea is a good one.. I=E2=80=99d have to implement that on my ow=
n but it=E2=80=99s
> not the end of the world.
>
> And I=E2=80=99d love to live in a world you present above where all test =
cases work
> and can be isolated :)
>
> =E2=80=A6 but it=E2=80=99s not practical. Google has a big problem with t=
his in their unit
> testing.  They have millions of unit tests and they can=E2=80=99t fail a =
whole
> build because 1/5000 of their tests are flakey.  At 1M tests you=E2=80=99=
re going
> to end up with a lot failing.
>
> In my situations I have weird race conditions with ActiveMQ having a JMX
> bug where there=E2=80=99s a race from the GC time of the queue and the ti=
me I read
> the JMX value.
>
> I have about 2-3 of these.. I CAN NOT reproduce these at all.. only durin=
g
> testing. It=E2=80=99s amazingly annoying :-(
>
> On Fri, Sep 19, 2014 at 10:18 AM, Martin Todorov <carlspring@gmail.com
> <javascript:;>>
> wrote:
>
> > I agree with Curtis about the possible approach of doing a for loop. I'=
m
> > also aware of the fact that every corner case is a case of it's own and
> > that you sometimes need to be able to do things quick and dirty.
> >
> > I had a manager who insisted I should simply ignore one of the test cas=
es
> > he'd written, which was failing regularly only during releasing on our =
CI
> > server. He refused to fix the test for about a year and a half, as it w=
as
> > "a flake". Eventually, it started hitting people big time, especially
> when
> > we moved to the cloud, and it turned out to be something which shouldn'=
t
> > have been ignored at all...
> >
> > In the end, it's all up to you, but I'd recommend playing it as safe as
> > possible! :-)
> >
> > On Fri, Sep 19, 2014 at 6:08 PM, Curtis Rueden <ctrueden@wisc.edu
> <javascript:;>> wrote:
> >
> > > Hi Kevin,
> > >
> > > > Is there a way to retry a flakey test?
> > >
> > > In general I agree with Martin Todorov that tests should be small and
> > > atomic, and flakiness is a sign of larger problems. However, I also
> agree
> > > with you that sometimes flaky tests are a reality: my group has run
> into
> > > this with behavior of the JVM garbage collector differing on Windows,
> for
> > > example, in a rather nondeterministic way. In that case, retrying tes=
ts
> > > ~5-10 times was a good solution for us.
> > >
> > > But rather than configuring Surefire or Failsafe to do this, I'd
> suggest
> > > (if possible) to write it into the test itself. Put the test in a for
> > loop,
> > > and then assert at the end that numSuccesses > 0 or whatever. You the=
n
> > also
> > > issue a warning if numSuccesses !=3D numAttempts, as you requested. I=
n
> > short:
> > > it gives you the flexibility you need.
> > >
> > > Regards,
> > > Curtis
> > >
> > > On Fri, Sep 19, 2014 at 11:24 AM, Kevin Burton <burton@spinn3r.com
> <javascript:;>>
> > wrote:
> > >
> > > > Is there a way to retry a flakey test?
> > > >
> > > > I=E2=80=99d basically like to have a flag that retries a failing te=
st 2 or 3
> > > times.
> > > >
> > > > Flakey and non deterministic tests are a fact of life in more
> > complicated
> > > > systems.
> > > >
> > > > The main problem being that they are impossible to setup again
> because
> > > > they=E2=80=99re usually race conditions.
> > > >
> > > > If I could just retry the test a second time , that would solve thi=
s
> > > issue.
> > > >
> > > > Would be nice to have the build warned that the test is failing
> > though..
> > > >
> > > > --
> > > >
> > > > Founder/CEO Spinn3r.com
> > > > Location: *San Francisco, CA*
> > > > blog: http://burtonator.wordpress.com
> > > > =E2=80=A6 or check out my Google+ profile
> > > > <https://plus.google.com/102718274791889610666/posts>
> > > > <http://spinn3r.com>
> > > >
> > >
> >
>
>
>
> --
>
> Founder/CEO Spinn3r.com
> Location: *San Francisco, CA*
> blog: http://burtonator.wordpress.com
> =E2=80=A6 or check out my Google+ profile
> <https://plus.google.com/102718274791889610666/posts>
> <http://spinn3r.com>
>

--047d7bacbb7069b87805038117c0--

