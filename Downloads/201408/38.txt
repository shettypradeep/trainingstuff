From users-return-137082-apmail-maven-users-archive=maven.apache.org@maven.apache.org  Tue Aug 19 15:31:43 2014
Return-Path: <users-return-137082-apmail-maven-users-archive=maven.apache.org@maven.apache.org>
X-Original-To: apmail-maven-users-archive@www.apache.org
Delivered-To: apmail-maven-users-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 393C911619
	for <apmail-maven-users-archive@www.apache.org>; Tue, 19 Aug 2014 15:31:43 +0000 (UTC)
Received: (qmail 32887 invoked by uid 500); 19 Aug 2014 15:31:39 -0000
Delivered-To: apmail-maven-users-archive@maven.apache.org
Received: (qmail 32807 invoked by uid 500); 19 Aug 2014 15:31:39 -0000
Mailing-List: contact users-help@maven.apache.org; run by ezmlm
Precedence: bulk
List-Unsubscribe: <mailto:users-unsubscribe@maven.apache.org>
List-Help: <mailto:users-help@maven.apache.org>
List-Post: <mailto:users@maven.apache.org>
List-Id: "Maven Users List" <users.maven.apache.org>
Reply-To: "Maven Users List" <users@maven.apache.org>
Delivered-To: mailing list users@maven.apache.org
Received: (qmail 32763 invoked by uid 99); 19 Aug 2014 15:31:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Aug 2014 15:31:39 +0000
X-ASF-Spam-Status: No, hits=2.5 required=5.0
	tests=FREEMAIL_REPLY,HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of waterlx@gmail.com designates 209.85.216.178 as permitted sender)
Received: from [209.85.216.178] (HELO mail-qc0-f178.google.com) (209.85.216.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Aug 2014 15:31:12 +0000
Received: by mail-qc0-f178.google.com with SMTP id x3so6395250qcv.37
        for <multiple recipients>; Tue, 19 Aug 2014 08:31:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=MGhSvzqnLWYcw9SW2VYiZy9WVm5dcwGFpOecYmbnV5c=;
        b=PfRkf8W2SV4WT/0V3yl98an9ad+vT/D8r3qA6Mg9DVtqU2PyQiRFyXPmzzdzMXvpTi
         HyE0MairPY3iIUOWrvgubg3iKFegczfGkwCx98740TNpP+9Jh7ePTUQxS6/z3SsAUYkG
         7Mi454XCGrmXfJgyH3gtd1Lrz5B8nnmbK6ituu6ReOYioqwJgZECUW3iGILlZhxjuaQM
         mFUm7DI06YDs8nOzM9L0PyxeFzP+azJLIdJBdUo5JtOjkxEk01Hyacn1Z38gnHXx+PAq
         t/MTTyC8zI0hwp+AX6AxWw75V0CkgJvJI3AQ0zxcvTnCfbd1qOtc9LbdVCLKRC1yiTAc
         yHbg==
MIME-Version: 1.0
X-Received: by 10.224.4.133 with SMTP id 5mr69289644qar.25.1408462271030; Tue,
 19 Aug 2014 08:31:11 -0700 (PDT)
Received: by 10.96.209.111 with HTTP; Tue, 19 Aug 2014 08:31:10 -0700 (PDT)
Date: Tue, 19 Aug 2014 23:31:10 +0800
Message-ID: <CAPcmo=5=DUYqPeSLG=Ujk_VsnJQcf-dzmVztGNkHaz4_BQjFLw@mail.gmail.com>
Subject: Out-of-memory of HDFS sink
From: =?UTF-8?B?5p2O5ZON?= <waterlx@gmail.com>
To: users@maven.apache.org, dev@maven.apache.org
Content-Type: multipart/alternative; boundary=001a11c2210858a6f90500fd2d09
X-Virus-Checked: Checked by ClamAV on apache.org

--001a11c2210858a6f90500fd2d09
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

I encountered this out of mem issue, does anybody encounter this or a
similar one before ? how can I debug this kind of problem ? Thanks in
advance~~~

>From the flume.log:

30 Jul 2014 23:10:06,984 ERROR
[SinkRunner-PollingRunner-DefaultSinkProcessor]
(org.apache.flume.sink.hdfs.HDFSEventSink.process:460)  - process failed
java.lang.OutOfMemoryError: Java heap space
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:239)
    at java.util.concurrent.FutureTask.get(FutureTask.java:102)
    at
org.apache.flume.sink.hdfs.HDFSEventSink.callWithTimeout(HDFSEventSink.java=
:345)
    at
org.apache.flume.sink.hdfs.HDFSEventSink.append(HDFSEventSink.java:727)
    at
org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:430)
    at
org.apache.flume.sink.DefaultSinkProcessor.process(DefaultSinkProcessor.jav=
a:68)
    at org.apache.flume.SinkRunner$PollingRunner.run(SinkRunner.java:147)
    at java.lang.Thread.run(Thread.java:738)
30 Jul 2014 23:10:06,981 WARN  [pool-13-thread-4]
(org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.exceptionCaught:201=
)
 - Unexpected exception from downstream.
java.lang.OutOfMemoryError: Java heap space
    at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:50)
    at java.nio.ByteBuffer.allocate(ByteBuffer.java:323)
    at
org.apache.avro.ipc.NettyTransportCodec$NettyFrameDecoder.decodePackBody(Ne=
ttyTransportCodec.java:192)
    at
org.apache.avro.ipc.NettyTransportCodec$NettyFrameDecoder.decode(NettyTrans=
portCodec.java:144)
    at
org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.ja=
va:286)
    at
org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecod=
er.java:220)
    at
org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)
    at
org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)
    at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:94)
    at
org.jboss.netty.channel.socket.nio.AbstractNioWorker.processSelectedKeys(Ab=
stractNioWorker.java:364)
    at
org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.=
java:238)
    at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:38)
    at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.j=
ava:897)
    at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:=
919)
    at java.lang.Thread.run(Thread.java:738)


>From javacore:

1CICMDLINE    java -Xmx20m -Xmx8g -Xms2g -Dflume.monitoring.type=3Dhttp
-Dflume.monitoring.port=3D53421 -cp
/opt/projects/mx/Tealeaf/Env:/opt/flume/lib/*:/opt/projects/mx/Tealeaf

Hopefully it's not caused by -Xmx20m setting?

3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/lang/Throwable.fillInStackTrace(Native
Method)
4XESTACKTRACE                at
java/lang/Throwable.<init>(Throwable.java:56(Compiled Code))
4XESTACKTRACE                at
java/lang/Throwable.<init>(Throwable.java:67)
4XESTACKTRACE                at
java/lang/OutOfMemoryError.<init>(OutOfMemoryError.java:46)
4XESTACKTRACE                at
java/util/concurrent/locks/AbstractQueuedSynchronizer$ConditionObject.addCo=
nditionWaiter(AbstractQueuedSynchronizer.java:1812(Compiled
Code))
4XESTACKTRACE                at
java/util/concurrent/locks/AbstractQueuedSynchronizer$ConditionObject.await=
Nanos(AbstractQueuedSynchronizer.java:2027(Compiled
Code))
4XESTACKTRACE                at
java/util/concurrent/DelayQueue.take(DelayQueue.java:175(Compiled Code))
4XESTACKTRACE                at
java/util/concurrent/ScheduledThreadPoolExecutor$DelayedWorkQueue.take(Sche=
duledThreadPoolExecutor.java:620(Compiled
Code))
4XESTACKTRACE                at
java/util/concurrent/ScheduledThreadPoolExecutor$DelayedWorkQueue.take(Sche=
duledThreadPoolExecutor.java:613(Compiled
Code))
4XESTACKTRACE                at
java/util/concurrent/ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:958=
(Compiled
Code))
4XESTACKTRACE                at
java/util/concurrent/ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:=
918)
4XESTACKTRACE                at java/lang/Thread.run(Thread.java:738)

--=20


E-mail             =EF=BC=9Awaterlx@gmail.com
MSN               =EF=BC=9Awaterlx@hotmail.com

--001a11c2210858a6f90500fd2d09--

